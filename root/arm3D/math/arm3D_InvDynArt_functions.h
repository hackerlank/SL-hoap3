
void
arm3D_InvDynArtfunc1(void)
     {
/* rotation matrices */
S00[1][1]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[2],2);
S00[1][2]=2*(baseo[0].q[2]*baseo[0].q[3] + baseo[0].q[1]*baseo[0].q[4]);
S00[1][3]=2*(-(baseo[0].q[1]*baseo[0].q[3]) + baseo[0].q[2]*baseo[0].q[4]);

S00[2][1]=2*(baseo[0].q[2]*baseo[0].q[3] - baseo[0].q[1]*baseo[0].q[4]);
S00[2][2]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[3],2);
S00[2][3]=2*(baseo[0].q[1]*baseo[0].q[2] + baseo[0].q[3]*baseo[0].q[4]);

S00[3][1]=2*(baseo[0].q[1]*baseo[0].q[3] + baseo[0].q[2]*baseo[0].q[4]);
S00[3][2]=2*(-(baseo[0].q[1]*baseo[0].q[2]) + baseo[0].q[3]*baseo[0].q[4]);
S00[3][3]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[4],2);


S10[1][2]=sstate1th;
S10[1][3]=-cstate1th;

S10[2][2]=cstate1th;
S10[2][3]=sstate1th;


S21[1][1]=cstate2th;
S21[1][2]=sstate2th;

S21[2][1]=-sstate2th;
S21[2][2]=cstate2th;


S32[1][1]=cstate3th;
S32[1][2]=sstate3th;

S32[2][1]=-sstate3th;
S32[2][2]=cstate3th;


S43[1][1]=rceff1a2*rceff1a3;
S43[1][2]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
S43[1][3]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;

S43[2][1]=-(rceff1a2*rseff1a3);
S43[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
S43[2][3]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;

S43[3][1]=rseff1a2;
S43[3][2]=-(rceff1a2*rseff1a1);
S43[3][3]=rceff1a1*rceff1a2;




}


void
arm3D_InvDynArtfunc2(void)
     {
/* inverse rotation matrices */
Si00[1][1]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[2],2);
Si00[1][2]=2*(baseo[0].q[2]*baseo[0].q[3] - baseo[0].q[1]*baseo[0].q[4]);
Si00[1][3]=2*(baseo[0].q[1]*baseo[0].q[3] + baseo[0].q[2]*baseo[0].q[4]);

Si00[2][1]=2*(baseo[0].q[2]*baseo[0].q[3] + baseo[0].q[1]*baseo[0].q[4]);
Si00[2][2]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[3],2);
Si00[2][3]=2*(-(baseo[0].q[1]*baseo[0].q[2]) + baseo[0].q[3]*baseo[0].q[4]);

Si00[3][1]=2*(-(baseo[0].q[1]*baseo[0].q[3]) + baseo[0].q[2]*baseo[0].q[4]);
Si00[3][2]=2*(baseo[0].q[1]*baseo[0].q[2] + baseo[0].q[3]*baseo[0].q[4]);
Si00[3][3]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[4],2);


Si01[2][1]=sstate1th;
Si01[2][2]=cstate1th;

Si01[3][1]=-cstate1th;
Si01[3][2]=sstate1th;


Si12[1][1]=cstate2th;
Si12[1][2]=-sstate2th;

Si12[2][1]=sstate2th;
Si12[2][2]=cstate2th;


Si23[1][1]=cstate3th;
Si23[1][2]=-sstate3th;

Si23[2][1]=sstate3th;
Si23[2][2]=cstate3th;


Si34[1][1]=rceff1a2*rceff1a3;
Si34[1][2]=-(rceff1a2*rseff1a3);
Si34[1][3]=rseff1a2;

Si34[2][1]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
Si34[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
Si34[2][3]=-(rceff1a2*rseff1a1);

Si34[3][1]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;
Si34[3][2]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;
Si34[3][3]=rceff1a1*rceff1a2;




}


void
arm3D_InvDynArtfunc3(void)
     {
/* rotation matrices from global to link coordinates */
SG10[1][1]=S00[2][1]*S10[1][2] + S00[3][1]*S10[1][3];
SG10[1][2]=S00[2][2]*S10[1][2] + S00[3][2]*S10[1][3];
SG10[1][3]=S00[2][3]*S10[1][2] + S00[3][3]*S10[1][3];

SG10[2][1]=S00[2][1]*S10[2][2] + S00[3][1]*S10[2][3];
SG10[2][2]=S00[2][2]*S10[2][2] + S00[3][2]*S10[2][3];
SG10[2][3]=S00[2][3]*S10[2][2] + S00[3][3]*S10[2][3];

SG10[3][1]=S00[1][1];
SG10[3][2]=S00[1][2];
SG10[3][3]=S00[1][3];


SG20[1][1]=S21[1][1]*SG10[1][1] + S21[1][2]*SG10[2][1];
SG20[1][2]=S21[1][1]*SG10[1][2] + S21[1][2]*SG10[2][2];
SG20[1][3]=S21[1][1]*SG10[1][3] + S21[1][2]*SG10[2][3];

SG20[2][1]=S21[2][1]*SG10[1][1] + S21[2][2]*SG10[2][1];
SG20[2][2]=S21[2][1]*SG10[1][2] + S21[2][2]*SG10[2][2];
SG20[2][3]=S21[2][1]*SG10[1][3] + S21[2][2]*SG10[2][3];

SG20[3][1]=SG10[3][1];
SG20[3][2]=SG10[3][2];
SG20[3][3]=SG10[3][3];


SG30[1][1]=S32[1][1]*SG20[1][1] + S32[1][2]*SG20[2][1];
SG30[1][2]=S32[1][1]*SG20[1][2] + S32[1][2]*SG20[2][2];
SG30[1][3]=S32[1][1]*SG20[1][3] + S32[1][2]*SG20[2][3];

SG30[2][1]=S32[2][1]*SG20[1][1] + S32[2][2]*SG20[2][1];
SG30[2][2]=S32[2][1]*SG20[1][2] + S32[2][2]*SG20[2][2];
SG30[2][3]=S32[2][1]*SG20[1][3] + S32[2][2]*SG20[2][3];

SG30[3][1]=SG20[3][1];
SG30[3][2]=SG20[3][2];
SG30[3][3]=SG20[3][3];


SG40[1][1]=S43[1][1]*SG30[1][1] + S43[1][2]*SG30[2][1] + S43[1][3]*SG30[3][1];
SG40[1][2]=S43[1][1]*SG30[1][2] + S43[1][2]*SG30[2][2] + S43[1][3]*SG30[3][2];
SG40[1][3]=S43[1][1]*SG30[1][3] + S43[1][2]*SG30[2][3] + S43[1][3]*SG30[3][3];

SG40[2][1]=S43[2][1]*SG30[1][1] + S43[2][2]*SG30[2][1] + S43[2][3]*SG30[3][1];
SG40[2][2]=S43[2][1]*SG30[1][2] + S43[2][2]*SG30[2][2] + S43[2][3]*SG30[3][2];
SG40[2][3]=S43[2][1]*SG30[1][3] + S43[2][2]*SG30[2][3] + S43[2][3]*SG30[3][3];

SG40[3][1]=S43[3][1]*SG30[1][1] + S43[3][2]*SG30[2][1] + S43[3][3]*SG30[3][1];
SG40[3][2]=S43[3][1]*SG30[1][2] + S43[3][2]*SG30[2][2] + S43[3][3]*SG30[3][2];
SG40[3][3]=S43[3][1]*SG30[1][3] + S43[3][2]*SG30[2][3] + S43[3][3]*SG30[3][3];




}


void
arm3D_InvDynArtfunc4(void)
     {
/* velocity vectors */
v0[1]=baseo[0].ad[1]*S00[1][1] + baseo[0].ad[2]*S00[1][2] + baseo[0].ad[3]*S00[1][3];
v0[2]=baseo[0].ad[1]*S00[2][1] + baseo[0].ad[2]*S00[2][2] + baseo[0].ad[3]*S00[2][3];
v0[3]=baseo[0].ad[1]*S00[3][1] + baseo[0].ad[2]*S00[3][2] + baseo[0].ad[3]*S00[3][3];
v0[4]=basec[0].xd[1]*S00[1][1] + basec[0].xd[2]*S00[1][2] + basec[0].xd[3]*S00[1][3];
v0[5]=basec[0].xd[1]*S00[2][1] + basec[0].xd[2]*S00[2][2] + basec[0].xd[3]*S00[2][3];
v0[6]=basec[0].xd[1]*S00[3][1] + basec[0].xd[2]*S00[3][2] + basec[0].xd[3]*S00[3][3];

v1[1]=v0[2]*S10[1][2] + v0[3]*S10[1][3];
v1[2]=v0[2]*S10[2][2] + v0[3]*S10[2][3];
v1[3]=state[1].thd + v0[1];
v1[4]=v0[5]*S10[1][2] + v0[6]*S10[1][3];
v1[5]=v0[5]*S10[2][2] + v0[6]*S10[2][3];
v1[6]=v0[4];

v2[1]=v1[1]*S21[1][1] + v1[2]*S21[1][2];
v2[2]=v1[1]*S21[2][1] + v1[2]*S21[2][2];
v2[3]=state[2].thd + v1[3];
v2[4]=v1[4]*S21[1][1] + l1*v1[3]*S21[1][2] + v1[5]*S21[1][2];
v2[5]=v1[4]*S21[2][1] + l1*v1[3]*S21[2][2] + v1[5]*S21[2][2];
v2[6]=-(l1*v1[2]) + v1[6];

v3[1]=v2[1]*S32[1][1] + v2[2]*S32[1][2];
v3[2]=v2[1]*S32[2][1] + v2[2]*S32[2][2];
v3[3]=state[3].thd + v2[3];
v3[4]=v2[4]*S32[1][1] + l2*v2[3]*S32[1][2] + v2[5]*S32[1][2];
v3[5]=v2[4]*S32[2][1] + l2*v2[3]*S32[2][2] + v2[5]*S32[2][2];
v3[6]=-(l2*v2[2]) + v2[6];

v4[1]=v3[1]*S43[1][1] + v3[2]*S43[1][2] + v3[3]*S43[1][3];
v4[2]=v3[1]*S43[2][1] + v3[2]*S43[2][2] + v3[3]*S43[2][3];
v4[3]=v3[1]*S43[3][1] + v3[2]*S43[3][2] + v3[3]*S43[3][3];
v4[4]=v3[4]*S43[1][1] + v3[5]*S43[1][2] + v3[3]*(-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2]) + v3[6]*S43[1][3] + v3[2]*(eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3]) + v3[1]*(-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3]);
v4[5]=v3[4]*S43[2][1] + v3[5]*S43[2][2] + v3[3]*(-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2]) + v3[6]*S43[2][3] + v3[2]*(eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3]) + v3[1]*(-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3]);
v4[6]=v3[4]*S43[3][1] + v3[5]*S43[3][2] + v3[3]*(-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2]) + v3[6]*S43[3][3] + v3[2]*(eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3]) + v3[1]*(-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3]);



}


void
arm3D_InvDynArtfunc5(void)
     {
/* c-misc vectors */
c1[1]=state[1].thd*v1[2];
c1[2]=-(state[1].thd*v1[1]);
c1[4]=state[1].thd*v1[5];
c1[5]=-(state[1].thd*v1[4]);

c2[1]=state[2].thd*v2[2];
c2[2]=-(state[2].thd*v2[1]);
c2[4]=state[2].thd*v2[5];
c2[5]=-(state[2].thd*v2[4]);

c3[1]=state[3].thd*v3[2];
c3[2]=-(state[3].thd*v3[1]);
c3[4]=state[3].thd*v3[5];
c3[5]=-(state[3].thd*v3[4]);



}


void
arm3D_InvDynArtfunc6(void)
     {
/* pv-misc vectors */
pv0[1]=-uex[0].f[1] - links[0].mcm[1]*Power(v0[2],2) - links[0].mcm[1]*Power(v0[3],2) + v0[1]*(links[0].mcm[2]*v0[2] + links[0].mcm[3]*v0[3]) - links[0].m*v0[3]*v0[5] + links[0].m*v0[2]*v0[6] + gravity*links[0].m*S00[1][3];
pv0[2]=-uex[0].f[2] - links[0].mcm[2]*Power(v0[1],2) - links[0].mcm[2]*Power(v0[3],2) + v0[2]*(links[0].mcm[1]*v0[1] + links[0].mcm[3]*v0[3]) + links[0].m*v0[3]*v0[4] - links[0].m*v0[1]*v0[6] + gravity*links[0].m*S00[2][3];
pv0[3]=-uex[0].f[3] - links[0].mcm[3]*Power(v0[1],2) - links[0].mcm[3]*Power(v0[2],2) + (links[0].mcm[1]*v0[1] + links[0].mcm[2]*v0[2])*v0[3] - links[0].m*v0[2]*v0[4] + links[0].m*v0[1]*v0[5] + gravity*links[0].m*S00[3][3];
pv0[4]=-uex[0].t[1] + (-(links[0].mcm[2]*v0[2]) - links[0].mcm[3]*v0[3])*v0[4] + (links[0].mcm[1]*v0[3] + links[0].m*v0[5])*v0[6] + v0[5]*(links[0].mcm[1]*v0[2] - links[0].m*v0[6]) + v0[1]*(links[0].mcm[2]*v0[5] + links[0].mcm[3]*v0[6] - v0[3]*links[0].inertia[1][2] + v0[2]*links[0].inertia[1][3]) + v0[2]*(-(links[0].mcm[1]*v0[5]) - v0[3]*links[0].inertia[2][2] + v0[2]*links[0].inertia[2][3]) + v0[3]*(-(links[0].mcm[1]*v0[6]) - v0[3]*links[0].inertia[2][3] + v0[2]*links[0].inertia[3][3]) - gravity*links[0].mcm[3]*S00[2][3] + gravity*links[0].mcm[2]*S00[3][3];
pv0[5]=-uex[0].t[2] + (-(links[0].mcm[1]*v0[1]) - links[0].mcm[3]*v0[3])*v0[5] + (links[0].mcm[2]*v0[3] - links[0].m*v0[4])*v0[6] + v0[4]*(links[0].mcm[2]*v0[1] + links[0].m*v0[6]) + v0[1]*(-(links[0].mcm[2]*v0[4]) + v0[3]*links[0].inertia[1][1] - v0[1]*links[0].inertia[1][3]) + v0[2]*(links[0].mcm[1]*v0[4] + links[0].mcm[3]*v0[6] + v0[3]*links[0].inertia[1][2] - v0[1]*links[0].inertia[2][3]) + v0[3]*(-(links[0].mcm[2]*v0[6]) + v0[3]*links[0].inertia[1][3] - v0[1]*links[0].inertia[3][3]) + gravity*links[0].mcm[3]*S00[1][3] - gravity*links[0].mcm[1]*S00[3][3];
pv0[6]=-uex[0].t[3] + (links[0].mcm[3]*v0[2] + links[0].m*v0[4])*v0[5] + v0[4]*(links[0].mcm[3]*v0[1] - links[0].m*v0[5]) + (-(links[0].mcm[1]*v0[1]) - links[0].mcm[2]*v0[2])*v0[6] + v0[1]*(-(links[0].mcm[3]*v0[4]) - v0[2]*links[0].inertia[1][1] + v0[1]*links[0].inertia[1][2]) + v0[2]*(-(links[0].mcm[3]*v0[5]) - v0[2]*links[0].inertia[1][2] + v0[1]*links[0].inertia[2][2]) + v0[3]*(links[0].mcm[1]*v0[4] + links[0].mcm[2]*v0[5] - v0[2]*links[0].inertia[1][3] + v0[1]*links[0].inertia[2][3]) - gravity*links[0].mcm[2]*S00[1][3] + gravity*links[0].mcm[1]*S00[2][3];

pv1[1]=-uex[1].f[1] - links[1].mcm[1]*Power(v1[2],2) - links[1].mcm[1]*Power(v1[3],2) + v1[1]*(links[1].mcm[2]*v1[2] + links[1].mcm[3]*v1[3]) - links[1].m*v1[3]*v1[5] + links[1].m*v1[2]*v1[6] + gravity*links[1].m*SG10[1][3];
pv1[2]=-uex[1].f[2] - links[1].mcm[2]*Power(v1[1],2) - links[1].mcm[2]*Power(v1[3],2) + v1[2]*(links[1].mcm[1]*v1[1] + links[1].mcm[3]*v1[3]) + links[1].m*v1[3]*v1[4] - links[1].m*v1[1]*v1[6] + gravity*links[1].m*SG10[2][3];
pv1[3]=-uex[1].f[3] - links[1].mcm[3]*Power(v1[1],2) - links[1].mcm[3]*Power(v1[2],2) + (links[1].mcm[1]*v1[1] + links[1].mcm[2]*v1[2])*v1[3] - links[1].m*v1[2]*v1[4] + links[1].m*v1[1]*v1[5] + gravity*links[1].m*SG10[3][3];
pv1[4]=-uex[1].t[1] + (-(links[1].mcm[2]*v1[2]) - links[1].mcm[3]*v1[3])*v1[4] + (links[1].mcm[1]*v1[3] + links[1].m*v1[5])*v1[6] + v1[5]*(links[1].mcm[1]*v1[2] - links[1].m*v1[6]) + v1[1]*(links[1].mcm[2]*v1[5] + links[1].mcm[3]*v1[6] - v1[3]*links[1].inertia[1][2] + v1[2]*links[1].inertia[1][3]) + v1[2]*(-(links[1].mcm[1]*v1[5]) - v1[3]*links[1].inertia[2][2] + v1[2]*links[1].inertia[2][3]) + v1[3]*(-(links[1].mcm[1]*v1[6]) - v1[3]*links[1].inertia[2][3] + v1[2]*links[1].inertia[3][3]) - gravity*links[1].mcm[3]*SG10[2][3] + gravity*links[1].mcm[2]*SG10[3][3];
pv1[5]=-uex[1].t[2] + (-(links[1].mcm[1]*v1[1]) - links[1].mcm[3]*v1[3])*v1[5] + (links[1].mcm[2]*v1[3] - links[1].m*v1[4])*v1[6] + v1[4]*(links[1].mcm[2]*v1[1] + links[1].m*v1[6]) + v1[1]*(-(links[1].mcm[2]*v1[4]) + v1[3]*links[1].inertia[1][1] - v1[1]*links[1].inertia[1][3]) + v1[2]*(links[1].mcm[1]*v1[4] + links[1].mcm[3]*v1[6] + v1[3]*links[1].inertia[1][2] - v1[1]*links[1].inertia[2][3]) + v1[3]*(-(links[1].mcm[2]*v1[6]) + v1[3]*links[1].inertia[1][3] - v1[1]*links[1].inertia[3][3]) + gravity*links[1].mcm[3]*SG10[1][3] - gravity*links[1].mcm[1]*SG10[3][3];
pv1[6]=-uex[1].t[3] + (links[1].mcm[3]*v1[2] + links[1].m*v1[4])*v1[5] + v1[4]*(links[1].mcm[3]*v1[1] - links[1].m*v1[5]) + (-(links[1].mcm[1]*v1[1]) - links[1].mcm[2]*v1[2])*v1[6] + v1[1]*(-(links[1].mcm[3]*v1[4]) - v1[2]*links[1].inertia[1][1] + v1[1]*links[1].inertia[1][2]) + v1[2]*(-(links[1].mcm[3]*v1[5]) - v1[2]*links[1].inertia[1][2] + v1[1]*links[1].inertia[2][2]) + v1[3]*(links[1].mcm[1]*v1[4] + links[1].mcm[2]*v1[5] - v1[2]*links[1].inertia[1][3] + v1[1]*links[1].inertia[2][3]) - gravity*links[1].mcm[2]*SG10[1][3] + gravity*links[1].mcm[1]*SG10[2][3];

pv2[1]=-uex[2].f[1] - links[2].mcm[1]*Power(v2[2],2) - links[2].mcm[1]*Power(v2[3],2) + v2[1]*(links[2].mcm[2]*v2[2] + links[2].mcm[3]*v2[3]) - links[2].m*v2[3]*v2[5] + links[2].m*v2[2]*v2[6] + gravity*links[2].m*SG20[1][3];
pv2[2]=-uex[2].f[2] - links[2].mcm[2]*Power(v2[1],2) - links[2].mcm[2]*Power(v2[3],2) + v2[2]*(links[2].mcm[1]*v2[1] + links[2].mcm[3]*v2[3]) + links[2].m*v2[3]*v2[4] - links[2].m*v2[1]*v2[6] + gravity*links[2].m*SG20[2][3];
pv2[3]=-uex[2].f[3] - links[2].mcm[3]*Power(v2[1],2) - links[2].mcm[3]*Power(v2[2],2) + (links[2].mcm[1]*v2[1] + links[2].mcm[2]*v2[2])*v2[3] - links[2].m*v2[2]*v2[4] + links[2].m*v2[1]*v2[5] + gravity*links[2].m*SG20[3][3];
pv2[4]=-uex[2].t[1] + (-(links[2].mcm[2]*v2[2]) - links[2].mcm[3]*v2[3])*v2[4] + (links[2].mcm[1]*v2[3] + links[2].m*v2[5])*v2[6] + v2[5]*(links[2].mcm[1]*v2[2] - links[2].m*v2[6]) + v2[1]*(links[2].mcm[2]*v2[5] + links[2].mcm[3]*v2[6] - v2[3]*links[2].inertia[1][2] + v2[2]*links[2].inertia[1][3]) + v2[2]*(-(links[2].mcm[1]*v2[5]) - v2[3]*links[2].inertia[2][2] + v2[2]*links[2].inertia[2][3]) + v2[3]*(-(links[2].mcm[1]*v2[6]) - v2[3]*links[2].inertia[2][3] + v2[2]*links[2].inertia[3][3]) - gravity*links[2].mcm[3]*SG20[2][3] + gravity*links[2].mcm[2]*SG20[3][3];
pv2[5]=-uex[2].t[2] + (-(links[2].mcm[1]*v2[1]) - links[2].mcm[3]*v2[3])*v2[5] + (links[2].mcm[2]*v2[3] - links[2].m*v2[4])*v2[6] + v2[4]*(links[2].mcm[2]*v2[1] + links[2].m*v2[6]) + v2[1]*(-(links[2].mcm[2]*v2[4]) + v2[3]*links[2].inertia[1][1] - v2[1]*links[2].inertia[1][3]) + v2[2]*(links[2].mcm[1]*v2[4] + links[2].mcm[3]*v2[6] + v2[3]*links[2].inertia[1][2] - v2[1]*links[2].inertia[2][3]) + v2[3]*(-(links[2].mcm[2]*v2[6]) + v2[3]*links[2].inertia[1][3] - v2[1]*links[2].inertia[3][3]) + gravity*links[2].mcm[3]*SG20[1][3] - gravity*links[2].mcm[1]*SG20[3][3];
pv2[6]=-uex[2].t[3] + (links[2].mcm[3]*v2[2] + links[2].m*v2[4])*v2[5] + v2[4]*(links[2].mcm[3]*v2[1] - links[2].m*v2[5]) + (-(links[2].mcm[1]*v2[1]) - links[2].mcm[2]*v2[2])*v2[6] + v2[1]*(-(links[2].mcm[3]*v2[4]) - v2[2]*links[2].inertia[1][1] + v2[1]*links[2].inertia[1][2]) + v2[2]*(-(links[2].mcm[3]*v2[5]) - v2[2]*links[2].inertia[1][2] + v2[1]*links[2].inertia[2][2]) + v2[3]*(links[2].mcm[1]*v2[4] + links[2].mcm[2]*v2[5] - v2[2]*links[2].inertia[1][3] + v2[1]*links[2].inertia[2][3]) - gravity*links[2].mcm[2]*SG20[1][3] + gravity*links[2].mcm[1]*SG20[2][3];

pv3[1]=-uex[3].f[1] - links[3].mcm[1]*Power(v3[2],2) - links[3].mcm[1]*Power(v3[3],2) + v3[1]*(links[3].mcm[2]*v3[2] + links[3].mcm[3]*v3[3]) - links[3].m*v3[3]*v3[5] + links[3].m*v3[2]*v3[6] + gravity*links[3].m*SG30[1][3];
pv3[2]=-uex[3].f[2] - links[3].mcm[2]*Power(v3[1],2) - links[3].mcm[2]*Power(v3[3],2) + v3[2]*(links[3].mcm[1]*v3[1] + links[3].mcm[3]*v3[3]) + links[3].m*v3[3]*v3[4] - links[3].m*v3[1]*v3[6] + gravity*links[3].m*SG30[2][3];
pv3[3]=-uex[3].f[3] - links[3].mcm[3]*Power(v3[1],2) - links[3].mcm[3]*Power(v3[2],2) + (links[3].mcm[1]*v3[1] + links[3].mcm[2]*v3[2])*v3[3] - links[3].m*v3[2]*v3[4] + links[3].m*v3[1]*v3[5] + gravity*links[3].m*SG30[3][3];
pv3[4]=-uex[3].t[1] + (-(links[3].mcm[2]*v3[2]) - links[3].mcm[3]*v3[3])*v3[4] + (links[3].mcm[1]*v3[3] + links[3].m*v3[5])*v3[6] + v3[5]*(links[3].mcm[1]*v3[2] - links[3].m*v3[6]) + v3[1]*(links[3].mcm[2]*v3[5] + links[3].mcm[3]*v3[6] - v3[3]*links[3].inertia[1][2] + v3[2]*links[3].inertia[1][3]) + v3[2]*(-(links[3].mcm[1]*v3[5]) - v3[3]*links[3].inertia[2][2] + v3[2]*links[3].inertia[2][3]) + v3[3]*(-(links[3].mcm[1]*v3[6]) - v3[3]*links[3].inertia[2][3] + v3[2]*links[3].inertia[3][3]) - gravity*links[3].mcm[3]*SG30[2][3] + gravity*links[3].mcm[2]*SG30[3][3];
pv3[5]=-uex[3].t[2] + (-(links[3].mcm[1]*v3[1]) - links[3].mcm[3]*v3[3])*v3[5] + (links[3].mcm[2]*v3[3] - links[3].m*v3[4])*v3[6] + v3[4]*(links[3].mcm[2]*v3[1] + links[3].m*v3[6]) + v3[1]*(-(links[3].mcm[2]*v3[4]) + v3[3]*links[3].inertia[1][1] - v3[1]*links[3].inertia[1][3]) + v3[2]*(links[3].mcm[1]*v3[4] + links[3].mcm[3]*v3[6] + v3[3]*links[3].inertia[1][2] - v3[1]*links[3].inertia[2][3]) + v3[3]*(-(links[3].mcm[2]*v3[6]) + v3[3]*links[3].inertia[1][3] - v3[1]*links[3].inertia[3][3]) + gravity*links[3].mcm[3]*SG30[1][3] - gravity*links[3].mcm[1]*SG30[3][3];
pv3[6]=-uex[3].t[3] + (links[3].mcm[3]*v3[2] + links[3].m*v3[4])*v3[5] + v3[4]*(links[3].mcm[3]*v3[1] - links[3].m*v3[5]) + (-(links[3].mcm[1]*v3[1]) - links[3].mcm[2]*v3[2])*v3[6] + v3[1]*(-(links[3].mcm[3]*v3[4]) - v3[2]*links[3].inertia[1][1] + v3[1]*links[3].inertia[1][2]) + v3[2]*(-(links[3].mcm[3]*v3[5]) - v3[2]*links[3].inertia[1][2] + v3[1]*links[3].inertia[2][2]) + v3[3]*(links[3].mcm[1]*v3[4] + links[3].mcm[2]*v3[5] - v3[2]*links[3].inertia[1][3] + v3[1]*links[3].inertia[2][3]) - gravity*links[3].mcm[2]*SG30[1][3] + gravity*links[3].mcm[1]*SG30[2][3];

pv4[1]=-(eff[1].mcm[1]*Power(v4[2],2)) - eff[1].mcm[1]*Power(v4[3],2) + v4[1]*(eff[1].mcm[2]*v4[2] + eff[1].mcm[3]*v4[3]) - eff[1].m*v4[3]*v4[5] + eff[1].m*v4[2]*v4[6] + eff[1].m*gravity*SG40[1][3];
pv4[2]=-(eff[1].mcm[2]*Power(v4[1],2)) - eff[1].mcm[2]*Power(v4[3],2) + v4[2]*(eff[1].mcm[1]*v4[1] + eff[1].mcm[3]*v4[3]) + eff[1].m*v4[3]*v4[4] - eff[1].m*v4[1]*v4[6] + eff[1].m*gravity*SG40[2][3];
pv4[3]=-(eff[1].mcm[3]*Power(v4[1],2)) - eff[1].mcm[3]*Power(v4[2],2) + (eff[1].mcm[1]*v4[1] + eff[1].mcm[2]*v4[2])*v4[3] - eff[1].m*v4[2]*v4[4] + eff[1].m*v4[1]*v4[5] + eff[1].m*gravity*SG40[3][3];
pv4[4]=(-(eff[1].mcm[2]*v4[2]) - eff[1].mcm[3]*v4[3])*v4[4] - eff[1].mcm[1]*v4[2]*v4[5] - eff[1].mcm[1]*v4[3]*v4[6] + (eff[1].mcm[1]*v4[3] + eff[1].m*v4[5])*v4[6] + v4[5]*(eff[1].mcm[1]*v4[2] - eff[1].m*v4[6]) + v4[1]*(eff[1].mcm[2]*v4[5] + eff[1].mcm[3]*v4[6]) - gravity*eff[1].mcm[3]*SG40[2][3] + gravity*eff[1].mcm[2]*SG40[3][3];
pv4[5]=-(eff[1].mcm[2]*v4[1]*v4[4]) + (-(eff[1].mcm[1]*v4[1]) - eff[1].mcm[3]*v4[3])*v4[5] - eff[1].mcm[2]*v4[3]*v4[6] + (eff[1].mcm[2]*v4[3] - eff[1].m*v4[4])*v4[6] + v4[4]*(eff[1].mcm[2]*v4[1] + eff[1].m*v4[6]) + v4[2]*(eff[1].mcm[1]*v4[4] + eff[1].mcm[3]*v4[6]) + gravity*eff[1].mcm[3]*SG40[1][3] - gravity*eff[1].mcm[1]*SG40[3][3];
pv4[6]=-(eff[1].mcm[3]*v4[1]*v4[4]) - eff[1].mcm[3]*v4[2]*v4[5] + (eff[1].mcm[3]*v4[2] + eff[1].m*v4[4])*v4[5] + v4[4]*(eff[1].mcm[3]*v4[1] - eff[1].m*v4[5]) + v4[3]*(eff[1].mcm[1]*v4[4] + eff[1].mcm[2]*v4[5]) + (-(eff[1].mcm[1]*v4[1]) - eff[1].mcm[2]*v4[2])*v4[6] - gravity*eff[1].mcm[2]*SG40[1][3] + gravity*eff[1].mcm[1]*SG40[2][3];



}

/* articulated body inertias and misc variables */

void
arm3D_InvDynArtfunc7(void)
     {
JA4[1][2]=eff[1].mcm[3];
JA4[1][3]=-eff[1].mcm[2];
JA4[1][4]=eff[1].m;

JA4[2][1]=-eff[1].mcm[3];
JA4[2][3]=eff[1].mcm[1];
JA4[2][5]=eff[1].m;

JA4[3][1]=eff[1].mcm[2];
JA4[3][2]=-eff[1].mcm[1];
JA4[3][6]=eff[1].m;

JA4[4][5]=-eff[1].mcm[3];
JA4[4][6]=eff[1].mcm[2];

JA4[5][4]=eff[1].mcm[3];
JA4[5][6]=-eff[1].mcm[1];

JA4[6][4]=-eff[1].mcm[2];
JA4[6][5]=eff[1].mcm[1];


T134[1][2]=JA4[1][2];
T134[1][3]=JA4[1][3];
T134[1][4]=JA4[1][4];

T134[2][1]=JA4[2][1];
T134[2][3]=JA4[2][3];
T134[2][5]=JA4[2][5];

T134[3][1]=JA4[3][1];
T134[3][2]=JA4[3][2];
T134[3][6]=JA4[3][6];

T134[4][5]=JA4[4][5];
T134[4][6]=JA4[4][6];

T134[5][4]=JA4[5][4];
T134[5][6]=JA4[5][6];

T134[6][4]=JA4[6][4];
T134[6][5]=JA4[6][5];


T34[1][1]=(-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3])*Si34[1][1]*T134[1][4] + S43[3][1]*(Si34[1][1]*T134[1][3] + Si34[1][2]*T134[2][3]) + (-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3])*Si34[1][2]*T134[2][5] + S43[1][1]*(Si34[1][2]*T134[2][1] + Si34[1][3]*T134[3][1]) + S43[2][1]*(Si34[1][1]*T134[1][2] + Si34[1][3]*T134[3][2]) + (-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3])*Si34[1][3]*T134[3][6];
T34[1][2]=(eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3])*Si34[1][1]*T134[1][4] + S43[3][2]*(Si34[1][1]*T134[1][3] + Si34[1][2]*T134[2][3]) + (eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3])*Si34[1][2]*T134[2][5] + S43[1][2]*(Si34[1][2]*T134[2][1] + Si34[1][3]*T134[3][1]) + S43[2][2]*(Si34[1][1]*T134[1][2] + Si34[1][3]*T134[3][2]) + (eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3])*Si34[1][3]*T134[3][6];
T34[1][3]=(-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2])*Si34[1][1]*T134[1][4] + S43[3][3]*(Si34[1][1]*T134[1][3] + Si34[1][2]*T134[2][3]) + (-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2])*Si34[1][2]*T134[2][5] + S43[1][3]*(Si34[1][2]*T134[2][1] + Si34[1][3]*T134[3][1]) + S43[2][3]*(Si34[1][1]*T134[1][2] + Si34[1][3]*T134[3][2]) + (-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2])*Si34[1][3]*T134[3][6];
T34[1][4]=S43[1][1]*Si34[1][1]*T134[1][4] + S43[2][1]*Si34[1][2]*T134[2][5] + S43[3][1]*Si34[1][3]*T134[3][6];
T34[1][5]=S43[1][2]*Si34[1][1]*T134[1][4] + S43[2][2]*Si34[1][2]*T134[2][5] + S43[3][2]*Si34[1][3]*T134[3][6];
T34[1][6]=S43[1][3]*Si34[1][1]*T134[1][4] + S43[2][3]*Si34[1][2]*T134[2][5] + S43[3][3]*Si34[1][3]*T134[3][6];

T34[2][1]=(-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3])*Si34[2][1]*T134[1][4] + S43[3][1]*(Si34[2][1]*T134[1][3] + Si34[2][2]*T134[2][3]) + (-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3])*Si34[2][2]*T134[2][5] + S43[1][1]*(Si34[2][2]*T134[2][1] + Si34[2][3]*T134[3][1]) + S43[2][1]*(Si34[2][1]*T134[1][2] + Si34[2][3]*T134[3][2]) + (-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3])*Si34[2][3]*T134[3][6];
T34[2][2]=(eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3])*Si34[2][1]*T134[1][4] + S43[3][2]*(Si34[2][1]*T134[1][3] + Si34[2][2]*T134[2][3]) + (eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3])*Si34[2][2]*T134[2][5] + S43[1][2]*(Si34[2][2]*T134[2][1] + Si34[2][3]*T134[3][1]) + S43[2][2]*(Si34[2][1]*T134[1][2] + Si34[2][3]*T134[3][2]) + (eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3])*Si34[2][3]*T134[3][6];
T34[2][3]=(-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2])*Si34[2][1]*T134[1][4] + S43[3][3]*(Si34[2][1]*T134[1][3] + Si34[2][2]*T134[2][3]) + (-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2])*Si34[2][2]*T134[2][5] + S43[1][3]*(Si34[2][2]*T134[2][1] + Si34[2][3]*T134[3][1]) + S43[2][3]*(Si34[2][1]*T134[1][2] + Si34[2][3]*T134[3][2]) + (-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2])*Si34[2][3]*T134[3][6];
T34[2][4]=S43[1][1]*Si34[2][1]*T134[1][4] + S43[2][1]*Si34[2][2]*T134[2][5] + S43[3][1]*Si34[2][3]*T134[3][6];
T34[2][5]=S43[1][2]*Si34[2][1]*T134[1][4] + S43[2][2]*Si34[2][2]*T134[2][5] + S43[3][2]*Si34[2][3]*T134[3][6];
T34[2][6]=S43[1][3]*Si34[2][1]*T134[1][4] + S43[2][3]*Si34[2][2]*T134[2][5] + S43[3][3]*Si34[2][3]*T134[3][6];

T34[3][1]=(-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3])*Si34[3][1]*T134[1][4] + S43[3][1]*(Si34[3][1]*T134[1][3] + Si34[3][2]*T134[2][3]) + (-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3])*Si34[3][2]*T134[2][5] + S43[1][1]*(Si34[3][2]*T134[2][1] + Si34[3][3]*T134[3][1]) + S43[2][1]*(Si34[3][1]*T134[1][2] + Si34[3][3]*T134[3][2]) + (-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3])*Si34[3][3]*T134[3][6];
T34[3][2]=(eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3])*Si34[3][1]*T134[1][4] + S43[3][2]*(Si34[3][1]*T134[1][3] + Si34[3][2]*T134[2][3]) + (eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3])*Si34[3][2]*T134[2][5] + S43[1][2]*(Si34[3][2]*T134[2][1] + Si34[3][3]*T134[3][1]) + S43[2][2]*(Si34[3][1]*T134[1][2] + Si34[3][3]*T134[3][2]) + (eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3])*Si34[3][3]*T134[3][6];
T34[3][3]=(-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2])*Si34[3][1]*T134[1][4] + S43[3][3]*(Si34[3][1]*T134[1][3] + Si34[3][2]*T134[2][3]) + (-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2])*Si34[3][2]*T134[2][5] + S43[1][3]*(Si34[3][2]*T134[2][1] + Si34[3][3]*T134[3][1]) + S43[2][3]*(Si34[3][1]*T134[1][2] + Si34[3][3]*T134[3][2]) + (-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2])*Si34[3][3]*T134[3][6];
T34[3][4]=S43[1][1]*Si34[3][1]*T134[1][4] + S43[2][1]*Si34[3][2]*T134[2][5] + S43[3][1]*Si34[3][3]*T134[3][6];
T34[3][5]=S43[1][2]*Si34[3][1]*T134[1][4] + S43[2][2]*Si34[3][2]*T134[2][5] + S43[3][2]*Si34[3][3]*T134[3][6];
T34[3][6]=S43[1][3]*Si34[3][1]*T134[1][4] + S43[2][3]*Si34[3][2]*T134[2][5] + S43[3][3]*Si34[3][3]*T134[3][6];

T34[4][1]=S43[3][1]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][3] + (-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][3]) + S43[1][1]*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][1] + (-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][1]) + S43[2][1]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][2] + (-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][2]) + (-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3])*((-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][6] + Si34[1][1]*T134[4][6] + Si34[1][2]*T134[5][6]) + (-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3])*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][4] + Si34[1][2]*T134[5][4] + Si34[1][3]*T134[6][4]) + (-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3])*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][5] + Si34[1][1]*T134[4][5] + Si34[1][3]*T134[6][5]);
T34[4][2]=S43[3][2]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][3] + (-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][3]) + S43[1][2]*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][1] + (-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][1]) + S43[2][2]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][2] + (-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][2]) + (eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3])*((-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][6] + Si34[1][1]*T134[4][6] + Si34[1][2]*T134[5][6]) + (eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3])*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][4] + Si34[1][2]*T134[5][4] + Si34[1][3]*T134[6][4]) + (eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3])*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][5] + Si34[1][1]*T134[4][5] + Si34[1][3]*T134[6][5]);
T34[4][3]=S43[3][3]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][3] + (-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][3]) + S43[1][3]*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][1] + (-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][1]) + S43[2][3]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][2] + (-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][2]) + (-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2])*((-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][6] + Si34[1][1]*T134[4][6] + Si34[1][2]*T134[5][6]) + (-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2])*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][4] + Si34[1][2]*T134[5][4] + Si34[1][3]*T134[6][4]) + (-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2])*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][5] + Si34[1][1]*T134[4][5] + Si34[1][3]*T134[6][5]);
T34[4][4]=S43[3][1]*((-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][6] + Si34[1][1]*T134[4][6] + Si34[1][2]*T134[5][6]) + S43[1][1]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][4] + Si34[1][2]*T134[5][4] + Si34[1][3]*T134[6][4]) + S43[2][1]*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][5] + Si34[1][1]*T134[4][5] + Si34[1][3]*T134[6][5]);
T34[4][5]=S43[3][2]*((-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][6] + Si34[1][1]*T134[4][6] + Si34[1][2]*T134[5][6]) + S43[1][2]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][4] + Si34[1][2]*T134[5][4] + Si34[1][3]*T134[6][4]) + S43[2][2]*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][5] + Si34[1][1]*T134[4][5] + Si34[1][3]*T134[6][5]);
T34[4][6]=S43[3][3]*((-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3])*T134[3][6] + Si34[1][1]*T134[4][6] + Si34[1][2]*T134[5][6]) + S43[1][3]*((-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1])*T134[1][4] + Si34[1][2]*T134[5][4] + Si34[1][3]*T134[6][4]) + S43[2][3]*((-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2])*T134[2][5] + Si34[1][1]*T134[4][5] + Si34[1][3]*T134[6][5]);

T34[5][1]=S43[3][1]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][3] + (eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][3]) + S43[1][1]*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][1] + (eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][1]) + S43[2][1]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][2] + (eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][2]) + (-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3])*((eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][6] + Si34[2][1]*T134[4][6] + Si34[2][2]*T134[5][6]) + (-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3])*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][4] + Si34[2][2]*T134[5][4] + Si34[2][3]*T134[6][4]) + (-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3])*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][5] + Si34[2][1]*T134[4][5] + Si34[2][3]*T134[6][5]);
T34[5][2]=S43[3][2]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][3] + (eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][3]) + S43[1][2]*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][1] + (eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][1]) + S43[2][2]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][2] + (eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][2]) + (eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3])*((eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][6] + Si34[2][1]*T134[4][6] + Si34[2][2]*T134[5][6]) + (eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3])*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][4] + Si34[2][2]*T134[5][4] + Si34[2][3]*T134[6][4]) + (eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3])*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][5] + Si34[2][1]*T134[4][5] + Si34[2][3]*T134[6][5]);
T34[5][3]=S43[3][3]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][3] + (eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][3]) + S43[1][3]*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][1] + (eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][1]) + S43[2][3]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][2] + (eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][2]) + (-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2])*((eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][6] + Si34[2][1]*T134[4][6] + Si34[2][2]*T134[5][6]) + (-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2])*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][4] + Si34[2][2]*T134[5][4] + Si34[2][3]*T134[6][4]) + (-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2])*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][5] + Si34[2][1]*T134[4][5] + Si34[2][3]*T134[6][5]);
T34[5][4]=S43[3][1]*((eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][6] + Si34[2][1]*T134[4][6] + Si34[2][2]*T134[5][6]) + S43[1][1]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][4] + Si34[2][2]*T134[5][4] + Si34[2][3]*T134[6][4]) + S43[2][1]*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][5] + Si34[2][1]*T134[4][5] + Si34[2][3]*T134[6][5]);
T34[5][5]=S43[3][2]*((eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][6] + Si34[2][1]*T134[4][6] + Si34[2][2]*T134[5][6]) + S43[1][2]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][4] + Si34[2][2]*T134[5][4] + Si34[2][3]*T134[6][4]) + S43[2][2]*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][5] + Si34[2][1]*T134[4][5] + Si34[2][3]*T134[6][5]);
T34[5][6]=S43[3][3]*((eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3])*T134[3][6] + Si34[2][1]*T134[4][6] + Si34[2][2]*T134[5][6]) + S43[1][3]*((eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1])*T134[1][4] + Si34[2][2]*T134[5][4] + Si34[2][3]*T134[6][4]) + S43[2][3]*((eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2])*T134[2][5] + Si34[2][1]*T134[4][5] + Si34[2][3]*T134[6][5]);

T34[6][1]=S43[3][1]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][3] + (-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][3]) + S43[1][1]*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][1] + (-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][1]) + S43[2][1]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][2] + (-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][2]) + (-(eff[1].x[3]*S43[3][2]) + eff[1].x[2]*S43[3][3])*((-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][6] + Si34[3][1]*T134[4][6] + Si34[3][2]*T134[5][6]) + (-(eff[1].x[3]*S43[1][2]) + eff[1].x[2]*S43[1][3])*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][4] + Si34[3][2]*T134[5][4] + Si34[3][3]*T134[6][4]) + (-(eff[1].x[3]*S43[2][2]) + eff[1].x[2]*S43[2][3])*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][5] + Si34[3][1]*T134[4][5] + Si34[3][3]*T134[6][5]);
T34[6][2]=S43[3][2]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][3] + (-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][3]) + S43[1][2]*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][1] + (-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][1]) + S43[2][2]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][2] + (-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][2]) + (eff[1].x[3]*S43[3][1] - eff[1].x[1]*S43[3][3])*((-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][6] + Si34[3][1]*T134[4][6] + Si34[3][2]*T134[5][6]) + (eff[1].x[3]*S43[1][1] - eff[1].x[1]*S43[1][3])*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][4] + Si34[3][2]*T134[5][4] + Si34[3][3]*T134[6][4]) + (eff[1].x[3]*S43[2][1] - eff[1].x[1]*S43[2][3])*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][5] + Si34[3][1]*T134[4][5] + Si34[3][3]*T134[6][5]);
T34[6][3]=S43[3][3]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][3] + (-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][3]) + S43[1][3]*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][1] + (-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][1]) + S43[2][3]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][2] + (-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][2]) + (-(eff[1].x[2]*S43[3][1]) + eff[1].x[1]*S43[3][2])*((-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][6] + Si34[3][1]*T134[4][6] + Si34[3][2]*T134[5][6]) + (-(eff[1].x[2]*S43[1][1]) + eff[1].x[1]*S43[1][2])*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][4] + Si34[3][2]*T134[5][4] + Si34[3][3]*T134[6][4]) + (-(eff[1].x[2]*S43[2][1]) + eff[1].x[1]*S43[2][2])*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][5] + Si34[3][1]*T134[4][5] + Si34[3][3]*T134[6][5]);
T34[6][4]=S43[3][1]*((-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][6] + Si34[3][1]*T134[4][6] + Si34[3][2]*T134[5][6]) + S43[1][1]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][4] + Si34[3][2]*T134[5][4] + Si34[3][3]*T134[6][4]) + S43[2][1]*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][5] + Si34[3][1]*T134[4][5] + Si34[3][3]*T134[6][5]);
T34[6][5]=S43[3][2]*((-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][6] + Si34[3][1]*T134[4][6] + Si34[3][2]*T134[5][6]) + S43[1][2]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][4] + Si34[3][2]*T134[5][4] + Si34[3][3]*T134[6][4]) + S43[2][2]*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][5] + Si34[3][1]*T134[4][5] + Si34[3][3]*T134[6][5]);
T34[6][6]=S43[3][3]*((-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3])*T134[3][6] + Si34[3][1]*T134[4][6] + Si34[3][2]*T134[5][6]) + S43[1][3]*((-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1])*T134[1][4] + Si34[3][2]*T134[5][4] + Si34[3][3]*T134[6][4]) + S43[2][3]*((-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2])*T134[2][5] + Si34[3][1]*T134[4][5] + Si34[3][3]*T134[6][5]);



}


void
arm3D_InvDynArtfunc8(void)
     {
JA3[1][1]=T34[1][1];
JA3[1][2]=links[3].mcm[3] + T34[1][2];
JA3[1][3]=-links[3].mcm[2] + T34[1][3];
JA3[1][4]=links[3].m + T34[1][4];
JA3[1][5]=T34[1][5];
JA3[1][6]=T34[1][6];

JA3[2][1]=-links[3].mcm[3] + T34[2][1];
JA3[2][2]=T34[2][2];
JA3[2][3]=links[3].mcm[1] + T34[2][3];
JA3[2][4]=T34[2][4];
JA3[2][5]=links[3].m + T34[2][5];
JA3[2][6]=T34[2][6];

JA3[3][1]=links[3].mcm[2] + T34[3][1];
JA3[3][2]=-links[3].mcm[1] + T34[3][2];
JA3[3][3]=T34[3][3];
JA3[3][4]=T34[3][4];
JA3[3][5]=T34[3][5];
JA3[3][6]=links[3].m + T34[3][6];

JA3[4][1]=links[3].inertia[1][1] + T34[4][1];
JA3[4][2]=links[3].inertia[1][2] + T34[4][2];
JA3[4][3]=links[3].inertia[1][3] + T34[4][3];
JA3[4][4]=T34[4][4];
JA3[4][5]=-links[3].mcm[3] + T34[4][5];
JA3[4][6]=links[3].mcm[2] + T34[4][6];

JA3[5][1]=links[3].inertia[1][2] + T34[5][1];
JA3[5][2]=links[3].inertia[2][2] + T34[5][2];
JA3[5][3]=links[3].inertia[2][3] + T34[5][3];
JA3[5][4]=links[3].mcm[3] + T34[5][4];
JA3[5][5]=T34[5][5];
JA3[5][6]=-links[3].mcm[1] + T34[5][6];

JA3[6][1]=links[3].inertia[1][3] + T34[6][1];
JA3[6][2]=links[3].inertia[2][3] + T34[6][2];
JA3[6][3]=links[3].inertia[3][3] + T34[6][3];
JA3[6][4]=-links[3].mcm[2] + T34[6][4];
JA3[6][5]=links[3].mcm[1] + T34[6][5];
JA3[6][6]=T34[6][6];


h3[1]=JA3[1][3];
h3[2]=JA3[2][3];
h3[3]=JA3[3][3];
h3[4]=JA3[4][3];
h3[5]=JA3[5][3];
h3[6]=JA3[6][3];

T123[1][1]=JA3[1][1];
T123[1][2]=JA3[1][2];
T123[1][3]=JA3[1][3];
T123[1][4]=JA3[1][4];
T123[1][5]=JA3[1][5];
T123[1][6]=JA3[1][6];

T123[2][1]=JA3[2][1];
T123[2][2]=JA3[2][2];
T123[2][3]=JA3[2][3];
T123[2][4]=JA3[2][4];
T123[2][5]=JA3[2][5];
T123[2][6]=JA3[2][6];

T123[3][1]=JA3[3][1];
T123[3][2]=JA3[3][2];
T123[3][3]=JA3[3][3];
T123[3][4]=JA3[3][4];
T123[3][5]=JA3[3][5];
T123[3][6]=JA3[3][6];

T123[4][1]=JA3[4][1];
T123[4][2]=JA3[4][2];
T123[4][3]=JA3[4][3];
T123[4][4]=JA3[4][4];
T123[4][5]=JA3[4][5];
T123[4][6]=JA3[4][6];

T123[5][1]=JA3[5][1];
T123[5][2]=JA3[5][2];
T123[5][3]=JA3[5][3];
T123[5][4]=JA3[5][4];
T123[5][5]=JA3[5][5];
T123[5][6]=JA3[5][6];

T123[6][1]=JA3[6][1];
T123[6][2]=JA3[6][2];
T123[6][3]=JA3[6][3];
T123[6][4]=JA3[6][4];
T123[6][5]=JA3[6][5];
T123[6][6]=JA3[6][6];


T23[1][1]=S32[1][1]*(Si23[1][1]*T123[1][1] + Si23[1][2]*T123[2][1]) + S32[2][1]*(Si23[1][1]*T123[1][2] + Si23[1][2]*T123[2][2]);
T23[1][2]=S32[1][2]*(Si23[1][1]*T123[1][1] + Si23[1][2]*T123[2][1]) + S32[2][2]*(Si23[1][1]*T123[1][2] + Si23[1][2]*T123[2][2]) - l2*(Si23[1][1]*T123[1][6] + Si23[1][2]*T123[2][6]);
T23[1][3]=Si23[1][1]*T123[1][3] + Si23[1][2]*T123[2][3] + l2*S32[1][2]*(Si23[1][1]*T123[1][4] + Si23[1][2]*T123[2][4]) + l2*S32[2][2]*(Si23[1][1]*T123[1][5] + Si23[1][2]*T123[2][5]);
T23[1][4]=S32[1][1]*(Si23[1][1]*T123[1][4] + Si23[1][2]*T123[2][4]) + S32[2][1]*(Si23[1][1]*T123[1][5] + Si23[1][2]*T123[2][5]);
T23[1][5]=S32[1][2]*(Si23[1][1]*T123[1][4] + Si23[1][2]*T123[2][4]) + S32[2][2]*(Si23[1][1]*T123[1][5] + Si23[1][2]*T123[2][5]);
T23[1][6]=Si23[1][1]*T123[1][6] + Si23[1][2]*T123[2][6];

T23[2][1]=S32[1][1]*(Si23[2][1]*T123[1][1] + Si23[2][2]*T123[2][1]) + S32[2][1]*(Si23[2][1]*T123[1][2] + Si23[2][2]*T123[2][2]);
T23[2][2]=S32[1][2]*(Si23[2][1]*T123[1][1] + Si23[2][2]*T123[2][1]) + S32[2][2]*(Si23[2][1]*T123[1][2] + Si23[2][2]*T123[2][2]) - l2*(Si23[2][1]*T123[1][6] + Si23[2][2]*T123[2][6]);
T23[2][3]=Si23[2][1]*T123[1][3] + Si23[2][2]*T123[2][3] + l2*S32[1][2]*(Si23[2][1]*T123[1][4] + Si23[2][2]*T123[2][4]) + l2*S32[2][2]*(Si23[2][1]*T123[1][5] + Si23[2][2]*T123[2][5]);
T23[2][4]=S32[1][1]*(Si23[2][1]*T123[1][4] + Si23[2][2]*T123[2][4]) + S32[2][1]*(Si23[2][1]*T123[1][5] + Si23[2][2]*T123[2][5]);
T23[2][5]=S32[1][2]*(Si23[2][1]*T123[1][4] + Si23[2][2]*T123[2][4]) + S32[2][2]*(Si23[2][1]*T123[1][5] + Si23[2][2]*T123[2][5]);
T23[2][6]=Si23[2][1]*T123[1][6] + Si23[2][2]*T123[2][6];

T23[3][1]=S32[1][1]*T123[3][1] + S32[2][1]*T123[3][2];
T23[3][2]=S32[1][2]*T123[3][1] + S32[2][2]*T123[3][2] - l2*T123[3][6];
T23[3][3]=T123[3][3] + l2*S32[1][2]*T123[3][4] + l2*S32[2][2]*T123[3][5];
T23[3][4]=S32[1][1]*T123[3][4] + S32[2][1]*T123[3][5];
T23[3][5]=S32[1][2]*T123[3][4] + S32[2][2]*T123[3][5];
T23[3][6]=T123[3][6];

T23[4][1]=S32[1][1]*(Si23[1][1]*T123[4][1] + Si23[1][2]*T123[5][1]) + S32[2][1]*(Si23[1][1]*T123[4][2] + Si23[1][2]*T123[5][2]);
T23[4][2]=S32[1][2]*(Si23[1][1]*T123[4][1] + Si23[1][2]*T123[5][1]) + S32[2][2]*(Si23[1][1]*T123[4][2] + Si23[1][2]*T123[5][2]) - l2*(Si23[1][1]*T123[4][6] + Si23[1][2]*T123[5][6]);
T23[4][3]=Si23[1][1]*T123[4][3] + Si23[1][2]*T123[5][3] + l2*S32[1][2]*(Si23[1][1]*T123[4][4] + Si23[1][2]*T123[5][4]) + l2*S32[2][2]*(Si23[1][1]*T123[4][5] + Si23[1][2]*T123[5][5]);
T23[4][4]=S32[1][1]*(Si23[1][1]*T123[4][4] + Si23[1][2]*T123[5][4]) + S32[2][1]*(Si23[1][1]*T123[4][5] + Si23[1][2]*T123[5][5]);
T23[4][5]=S32[1][2]*(Si23[1][1]*T123[4][4] + Si23[1][2]*T123[5][4]) + S32[2][2]*(Si23[1][1]*T123[4][5] + Si23[1][2]*T123[5][5]);
T23[4][6]=Si23[1][1]*T123[4][6] + Si23[1][2]*T123[5][6];

T23[5][1]=S32[1][1]*(-(l2*T123[3][1]) + Si23[2][1]*T123[4][1] + Si23[2][2]*T123[5][1]) + S32[2][1]*(-(l2*T123[3][2]) + Si23[2][1]*T123[4][2] + Si23[2][2]*T123[5][2]);
T23[5][2]=S32[1][2]*(-(l2*T123[3][1]) + Si23[2][1]*T123[4][1] + Si23[2][2]*T123[5][1]) + S32[2][2]*(-(l2*T123[3][2]) + Si23[2][1]*T123[4][2] + Si23[2][2]*T123[5][2]) - l2*(-(l2*T123[3][6]) + Si23[2][1]*T123[4][6] + Si23[2][2]*T123[5][6]);
T23[5][3]=-(l2*T123[3][3]) + Si23[2][1]*T123[4][3] + Si23[2][2]*T123[5][3] + l2*S32[1][2]*(-(l2*T123[3][4]) + Si23[2][1]*T123[4][4] + Si23[2][2]*T123[5][4]) + l2*S32[2][2]*(-(l2*T123[3][5]) + Si23[2][1]*T123[4][5] + Si23[2][2]*T123[5][5]);
T23[5][4]=S32[1][1]*(-(l2*T123[3][4]) + Si23[2][1]*T123[4][4] + Si23[2][2]*T123[5][4]) + S32[2][1]*(-(l2*T123[3][5]) + Si23[2][1]*T123[4][5] + Si23[2][2]*T123[5][5]);
T23[5][5]=S32[1][2]*(-(l2*T123[3][4]) + Si23[2][1]*T123[4][4] + Si23[2][2]*T123[5][4]) + S32[2][2]*(-(l2*T123[3][5]) + Si23[2][1]*T123[4][5] + Si23[2][2]*T123[5][5]);
T23[5][6]=-(l2*T123[3][6]) + Si23[2][1]*T123[4][6] + Si23[2][2]*T123[5][6];

T23[6][1]=S32[1][1]*(l2*Si23[2][1]*T123[1][1] + l2*Si23[2][2]*T123[2][1] + T123[6][1]) + S32[2][1]*(l2*Si23[2][1]*T123[1][2] + l2*Si23[2][2]*T123[2][2] + T123[6][2]);
T23[6][2]=S32[1][2]*(l2*Si23[2][1]*T123[1][1] + l2*Si23[2][2]*T123[2][1] + T123[6][1]) + S32[2][2]*(l2*Si23[2][1]*T123[1][2] + l2*Si23[2][2]*T123[2][2] + T123[6][2]) - l2*(l2*Si23[2][1]*T123[1][6] + l2*Si23[2][2]*T123[2][6] + T123[6][6]);
T23[6][3]=l2*Si23[2][1]*T123[1][3] + l2*Si23[2][2]*T123[2][3] + T123[6][3] + l2*S32[1][2]*(l2*Si23[2][1]*T123[1][4] + l2*Si23[2][2]*T123[2][4] + T123[6][4]) + l2*S32[2][2]*(l2*Si23[2][1]*T123[1][5] + l2*Si23[2][2]*T123[2][5] + T123[6][5]);
T23[6][4]=S32[1][1]*(l2*Si23[2][1]*T123[1][4] + l2*Si23[2][2]*T123[2][4] + T123[6][4]) + S32[2][1]*(l2*Si23[2][1]*T123[1][5] + l2*Si23[2][2]*T123[2][5] + T123[6][5]);
T23[6][5]=S32[1][2]*(l2*Si23[2][1]*T123[1][4] + l2*Si23[2][2]*T123[2][4] + T123[6][4]) + S32[2][2]*(l2*Si23[2][1]*T123[1][5] + l2*Si23[2][2]*T123[2][5] + T123[6][5]);
T23[6][6]=l2*Si23[2][1]*T123[1][6] + l2*Si23[2][2]*T123[2][6] + T123[6][6];



}


void
arm3D_InvDynArtfunc9(void)
     {
JA2[1][1]=T23[1][1];
JA2[1][2]=links[2].mcm[3] + T23[1][2];
JA2[1][3]=-links[2].mcm[2] + T23[1][3];
JA2[1][4]=links[2].m + T23[1][4];
JA2[1][5]=T23[1][5];
JA2[1][6]=T23[1][6];

JA2[2][1]=-links[2].mcm[3] + T23[2][1];
JA2[2][2]=T23[2][2];
JA2[2][3]=links[2].mcm[1] + T23[2][3];
JA2[2][4]=T23[2][4];
JA2[2][5]=links[2].m + T23[2][5];
JA2[2][6]=T23[2][6];

JA2[3][1]=links[2].mcm[2] + T23[3][1];
JA2[3][2]=-links[2].mcm[1] + T23[3][2];
JA2[3][3]=T23[3][3];
JA2[3][4]=T23[3][4];
JA2[3][5]=T23[3][5];
JA2[3][6]=links[2].m + T23[3][6];

JA2[4][1]=links[2].inertia[1][1] + T23[4][1];
JA2[4][2]=links[2].inertia[1][2] + T23[4][2];
JA2[4][3]=links[2].inertia[1][3] + T23[4][3];
JA2[4][4]=T23[4][4];
JA2[4][5]=-links[2].mcm[3] + T23[4][5];
JA2[4][6]=links[2].mcm[2] + T23[4][6];

JA2[5][1]=links[2].inertia[1][2] + T23[5][1];
JA2[5][2]=links[2].inertia[2][2] + T23[5][2];
JA2[5][3]=links[2].inertia[2][3] + T23[5][3];
JA2[5][4]=links[2].mcm[3] + T23[5][4];
JA2[5][5]=T23[5][5];
JA2[5][6]=-links[2].mcm[1] + T23[5][6];

JA2[6][1]=links[2].inertia[1][3] + T23[6][1];
JA2[6][2]=links[2].inertia[2][3] + T23[6][2];
JA2[6][3]=links[2].inertia[3][3] + T23[6][3];
JA2[6][4]=-links[2].mcm[2] + T23[6][4];
JA2[6][5]=links[2].mcm[1] + T23[6][5];
JA2[6][6]=T23[6][6];


h2[1]=JA2[1][3];
h2[2]=JA2[2][3];
h2[3]=JA2[3][3];
h2[4]=JA2[4][3];
h2[5]=JA2[5][3];
h2[6]=JA2[6][3];

T112[1][1]=JA2[1][1];
T112[1][2]=JA2[1][2];
T112[1][3]=JA2[1][3];
T112[1][4]=JA2[1][4];
T112[1][5]=JA2[1][5];
T112[1][6]=JA2[1][6];

T112[2][1]=JA2[2][1];
T112[2][2]=JA2[2][2];
T112[2][3]=JA2[2][3];
T112[2][4]=JA2[2][4];
T112[2][5]=JA2[2][5];
T112[2][6]=JA2[2][6];

T112[3][1]=JA2[3][1];
T112[3][2]=JA2[3][2];
T112[3][3]=JA2[3][3];
T112[3][4]=JA2[3][4];
T112[3][5]=JA2[3][5];
T112[3][6]=JA2[3][6];

T112[4][1]=JA2[4][1];
T112[4][2]=JA2[4][2];
T112[4][3]=JA2[4][3];
T112[4][4]=JA2[4][4];
T112[4][5]=JA2[4][5];
T112[4][6]=JA2[4][6];

T112[5][1]=JA2[5][1];
T112[5][2]=JA2[5][2];
T112[5][3]=JA2[5][3];
T112[5][4]=JA2[5][4];
T112[5][5]=JA2[5][5];
T112[5][6]=JA2[5][6];

T112[6][1]=JA2[6][1];
T112[6][2]=JA2[6][2];
T112[6][3]=JA2[6][3];
T112[6][4]=JA2[6][4];
T112[6][5]=JA2[6][5];
T112[6][6]=JA2[6][6];


T12[1][1]=S21[1][1]*(Si12[1][1]*T112[1][1] + Si12[1][2]*T112[2][1]) + S21[2][1]*(Si12[1][1]*T112[1][2] + Si12[1][2]*T112[2][2]);
T12[1][2]=S21[1][2]*(Si12[1][1]*T112[1][1] + Si12[1][2]*T112[2][1]) + S21[2][2]*(Si12[1][1]*T112[1][2] + Si12[1][2]*T112[2][2]) - l1*(Si12[1][1]*T112[1][6] + Si12[1][2]*T112[2][6]);
T12[1][3]=Si12[1][1]*T112[1][3] + Si12[1][2]*T112[2][3] + l1*S21[1][2]*(Si12[1][1]*T112[1][4] + Si12[1][2]*T112[2][4]) + l1*S21[2][2]*(Si12[1][1]*T112[1][5] + Si12[1][2]*T112[2][5]);
T12[1][4]=S21[1][1]*(Si12[1][1]*T112[1][4] + Si12[1][2]*T112[2][4]) + S21[2][1]*(Si12[1][1]*T112[1][5] + Si12[1][2]*T112[2][5]);
T12[1][5]=S21[1][2]*(Si12[1][1]*T112[1][4] + Si12[1][2]*T112[2][4]) + S21[2][2]*(Si12[1][1]*T112[1][5] + Si12[1][2]*T112[2][5]);
T12[1][6]=Si12[1][1]*T112[1][6] + Si12[1][2]*T112[2][6];

T12[2][1]=S21[1][1]*(Si12[2][1]*T112[1][1] + Si12[2][2]*T112[2][1]) + S21[2][1]*(Si12[2][1]*T112[1][2] + Si12[2][2]*T112[2][2]);
T12[2][2]=S21[1][2]*(Si12[2][1]*T112[1][1] + Si12[2][2]*T112[2][1]) + S21[2][2]*(Si12[2][1]*T112[1][2] + Si12[2][2]*T112[2][2]) - l1*(Si12[2][1]*T112[1][6] + Si12[2][2]*T112[2][6]);
T12[2][3]=Si12[2][1]*T112[1][3] + Si12[2][2]*T112[2][3] + l1*S21[1][2]*(Si12[2][1]*T112[1][4] + Si12[2][2]*T112[2][4]) + l1*S21[2][2]*(Si12[2][1]*T112[1][5] + Si12[2][2]*T112[2][5]);
T12[2][4]=S21[1][1]*(Si12[2][1]*T112[1][4] + Si12[2][2]*T112[2][4]) + S21[2][1]*(Si12[2][1]*T112[1][5] + Si12[2][2]*T112[2][5]);
T12[2][5]=S21[1][2]*(Si12[2][1]*T112[1][4] + Si12[2][2]*T112[2][4]) + S21[2][2]*(Si12[2][1]*T112[1][5] + Si12[2][2]*T112[2][5]);
T12[2][6]=Si12[2][1]*T112[1][6] + Si12[2][2]*T112[2][6];

T12[3][1]=S21[1][1]*T112[3][1] + S21[2][1]*T112[3][2];
T12[3][2]=S21[1][2]*T112[3][1] + S21[2][2]*T112[3][2] - l1*T112[3][6];
T12[3][3]=T112[3][3] + l1*S21[1][2]*T112[3][4] + l1*S21[2][2]*T112[3][5];
T12[3][4]=S21[1][1]*T112[3][4] + S21[2][1]*T112[3][5];
T12[3][5]=S21[1][2]*T112[3][4] + S21[2][2]*T112[3][5];
T12[3][6]=T112[3][6];

T12[4][1]=S21[1][1]*(Si12[1][1]*T112[4][1] + Si12[1][2]*T112[5][1]) + S21[2][1]*(Si12[1][1]*T112[4][2] + Si12[1][2]*T112[5][2]);
T12[4][2]=S21[1][2]*(Si12[1][1]*T112[4][1] + Si12[1][2]*T112[5][1]) + S21[2][2]*(Si12[1][1]*T112[4][2] + Si12[1][2]*T112[5][2]) - l1*(Si12[1][1]*T112[4][6] + Si12[1][2]*T112[5][6]);
T12[4][3]=Si12[1][1]*T112[4][3] + Si12[1][2]*T112[5][3] + l1*S21[1][2]*(Si12[1][1]*T112[4][4] + Si12[1][2]*T112[5][4]) + l1*S21[2][2]*(Si12[1][1]*T112[4][5] + Si12[1][2]*T112[5][5]);
T12[4][4]=S21[1][1]*(Si12[1][1]*T112[4][4] + Si12[1][2]*T112[5][4]) + S21[2][1]*(Si12[1][1]*T112[4][5] + Si12[1][2]*T112[5][5]);
T12[4][5]=S21[1][2]*(Si12[1][1]*T112[4][4] + Si12[1][2]*T112[5][4]) + S21[2][2]*(Si12[1][1]*T112[4][5] + Si12[1][2]*T112[5][5]);
T12[4][6]=Si12[1][1]*T112[4][6] + Si12[1][2]*T112[5][6];

T12[5][1]=S21[1][1]*(-(l1*T112[3][1]) + Si12[2][1]*T112[4][1] + Si12[2][2]*T112[5][1]) + S21[2][1]*(-(l1*T112[3][2]) + Si12[2][1]*T112[4][2] + Si12[2][2]*T112[5][2]);
T12[5][2]=S21[1][2]*(-(l1*T112[3][1]) + Si12[2][1]*T112[4][1] + Si12[2][2]*T112[5][1]) + S21[2][2]*(-(l1*T112[3][2]) + Si12[2][1]*T112[4][2] + Si12[2][2]*T112[5][2]) - l1*(-(l1*T112[3][6]) + Si12[2][1]*T112[4][6] + Si12[2][2]*T112[5][6]);
T12[5][3]=-(l1*T112[3][3]) + Si12[2][1]*T112[4][3] + Si12[2][2]*T112[5][3] + l1*S21[1][2]*(-(l1*T112[3][4]) + Si12[2][1]*T112[4][4] + Si12[2][2]*T112[5][4]) + l1*S21[2][2]*(-(l1*T112[3][5]) + Si12[2][1]*T112[4][5] + Si12[2][2]*T112[5][5]);
T12[5][4]=S21[1][1]*(-(l1*T112[3][4]) + Si12[2][1]*T112[4][4] + Si12[2][2]*T112[5][4]) + S21[2][1]*(-(l1*T112[3][5]) + Si12[2][1]*T112[4][5] + Si12[2][2]*T112[5][5]);
T12[5][5]=S21[1][2]*(-(l1*T112[3][4]) + Si12[2][1]*T112[4][4] + Si12[2][2]*T112[5][4]) + S21[2][2]*(-(l1*T112[3][5]) + Si12[2][1]*T112[4][5] + Si12[2][2]*T112[5][5]);
T12[5][6]=-(l1*T112[3][6]) + Si12[2][1]*T112[4][6] + Si12[2][2]*T112[5][6];

T12[6][1]=S21[1][1]*(l1*Si12[2][1]*T112[1][1] + l1*Si12[2][2]*T112[2][1] + T112[6][1]) + S21[2][1]*(l1*Si12[2][1]*T112[1][2] + l1*Si12[2][2]*T112[2][2] + T112[6][2]);
T12[6][2]=S21[1][2]*(l1*Si12[2][1]*T112[1][1] + l1*Si12[2][2]*T112[2][1] + T112[6][1]) + S21[2][2]*(l1*Si12[2][1]*T112[1][2] + l1*Si12[2][2]*T112[2][2] + T112[6][2]) - l1*(l1*Si12[2][1]*T112[1][6] + l1*Si12[2][2]*T112[2][6] + T112[6][6]);
T12[6][3]=l1*Si12[2][1]*T112[1][3] + l1*Si12[2][2]*T112[2][3] + T112[6][3] + l1*S21[1][2]*(l1*Si12[2][1]*T112[1][4] + l1*Si12[2][2]*T112[2][4] + T112[6][4]) + l1*S21[2][2]*(l1*Si12[2][1]*T112[1][5] + l1*Si12[2][2]*T112[2][5] + T112[6][5]);
T12[6][4]=S21[1][1]*(l1*Si12[2][1]*T112[1][4] + l1*Si12[2][2]*T112[2][4] + T112[6][4]) + S21[2][1]*(l1*Si12[2][1]*T112[1][5] + l1*Si12[2][2]*T112[2][5] + T112[6][5]);
T12[6][5]=S21[1][2]*(l1*Si12[2][1]*T112[1][4] + l1*Si12[2][2]*T112[2][4] + T112[6][4]) + S21[2][2]*(l1*Si12[2][1]*T112[1][5] + l1*Si12[2][2]*T112[2][5] + T112[6][5]);
T12[6][6]=l1*Si12[2][1]*T112[1][6] + l1*Si12[2][2]*T112[2][6] + T112[6][6];



}


void
arm3D_InvDynArtfunc10(void)
      {
JA1[1][1]=T12[1][1];
JA1[1][2]=links[1].mcm[3] + T12[1][2];
JA1[1][3]=-links[1].mcm[2] + T12[1][3];
JA1[1][4]=links[1].m + T12[1][4];
JA1[1][5]=T12[1][5];
JA1[1][6]=T12[1][6];

JA1[2][1]=-links[1].mcm[3] + T12[2][1];
JA1[2][2]=T12[2][2];
JA1[2][3]=links[1].mcm[1] + T12[2][3];
JA1[2][4]=T12[2][4];
JA1[2][5]=links[1].m + T12[2][5];
JA1[2][6]=T12[2][6];

JA1[3][1]=links[1].mcm[2] + T12[3][1];
JA1[3][2]=-links[1].mcm[1] + T12[3][2];
JA1[3][3]=T12[3][3];
JA1[3][4]=T12[3][4];
JA1[3][5]=T12[3][5];
JA1[3][6]=links[1].m + T12[3][6];

JA1[4][1]=links[1].inertia[1][1] + T12[4][1];
JA1[4][2]=links[1].inertia[1][2] + T12[4][2];
JA1[4][3]=links[1].inertia[1][3] + T12[4][3];
JA1[4][4]=T12[4][4];
JA1[4][5]=-links[1].mcm[3] + T12[4][5];
JA1[4][6]=links[1].mcm[2] + T12[4][6];

JA1[5][1]=links[1].inertia[1][2] + T12[5][1];
JA1[5][2]=links[1].inertia[2][2] + T12[5][2];
JA1[5][3]=links[1].inertia[2][3] + T12[5][3];
JA1[5][4]=links[1].mcm[3] + T12[5][4];
JA1[5][5]=T12[5][5];
JA1[5][6]=-links[1].mcm[1] + T12[5][6];

JA1[6][1]=links[1].inertia[1][3] + T12[6][1];
JA1[6][2]=links[1].inertia[2][3] + T12[6][2];
JA1[6][3]=links[1].inertia[3][3] + T12[6][3];
JA1[6][4]=-links[1].mcm[2] + T12[6][4];
JA1[6][5]=links[1].mcm[1] + T12[6][5];
JA1[6][6]=T12[6][6];


h1[1]=JA1[1][3];
h1[2]=JA1[2][3];
h1[3]=JA1[3][3];
h1[4]=JA1[4][3];
h1[5]=JA1[5][3];
h1[6]=JA1[6][3];

T101[1][1]=JA1[1][1];
T101[1][2]=JA1[1][2];
T101[1][3]=JA1[1][3];
T101[1][4]=JA1[1][4];
T101[1][5]=JA1[1][5];
T101[1][6]=JA1[1][6];

T101[2][1]=JA1[2][1];
T101[2][2]=JA1[2][2];
T101[2][3]=JA1[2][3];
T101[2][4]=JA1[2][4];
T101[2][5]=JA1[2][5];
T101[2][6]=JA1[2][6];

T101[3][1]=JA1[3][1];
T101[3][2]=JA1[3][2];
T101[3][3]=JA1[3][3];
T101[3][4]=JA1[3][4];
T101[3][5]=JA1[3][5];
T101[3][6]=JA1[3][6];

T101[4][1]=JA1[4][1];
T101[4][2]=JA1[4][2];
T101[4][3]=JA1[4][3];
T101[4][4]=JA1[4][4];
T101[4][5]=JA1[4][5];
T101[4][6]=JA1[4][6];

T101[5][1]=JA1[5][1];
T101[5][2]=JA1[5][2];
T101[5][3]=JA1[5][3];
T101[5][4]=JA1[5][4];
T101[5][5]=JA1[5][5];
T101[5][6]=JA1[5][6];

T101[6][1]=JA1[6][1];
T101[6][2]=JA1[6][2];
T101[6][3]=JA1[6][3];
T101[6][4]=JA1[6][4];
T101[6][5]=JA1[6][5];
T101[6][6]=JA1[6][6];


T01[1][1]=T101[3][3];
T01[1][2]=S10[1][2]*T101[3][1] + S10[2][2]*T101[3][2];
T01[1][3]=S10[1][3]*T101[3][1] + S10[2][3]*T101[3][2];
T01[1][4]=T101[3][6];
T01[1][5]=S10[1][2]*T101[3][4] + S10[2][2]*T101[3][5];
T01[1][6]=S10[1][3]*T101[3][4] + S10[2][3]*T101[3][5];

T01[2][1]=Si01[2][1]*T101[1][3] + Si01[2][2]*T101[2][3];
T01[2][2]=S10[1][2]*(Si01[2][1]*T101[1][1] + Si01[2][2]*T101[2][1]) + S10[2][2]*(Si01[2][1]*T101[1][2] + Si01[2][2]*T101[2][2]);
T01[2][3]=S10[1][3]*(Si01[2][1]*T101[1][1] + Si01[2][2]*T101[2][1]) + S10[2][3]*(Si01[2][1]*T101[1][2] + Si01[2][2]*T101[2][2]);
T01[2][4]=Si01[2][1]*T101[1][6] + Si01[2][2]*T101[2][6];
T01[2][5]=S10[1][2]*(Si01[2][1]*T101[1][4] + Si01[2][2]*T101[2][4]) + S10[2][2]*(Si01[2][1]*T101[1][5] + Si01[2][2]*T101[2][5]);
T01[2][6]=S10[1][3]*(Si01[2][1]*T101[1][4] + Si01[2][2]*T101[2][4]) + S10[2][3]*(Si01[2][1]*T101[1][5] + Si01[2][2]*T101[2][5]);

T01[3][1]=Si01[3][1]*T101[1][3] + Si01[3][2]*T101[2][3];
T01[3][2]=S10[1][2]*(Si01[3][1]*T101[1][1] + Si01[3][2]*T101[2][1]) + S10[2][2]*(Si01[3][1]*T101[1][2] + Si01[3][2]*T101[2][2]);
T01[3][3]=S10[1][3]*(Si01[3][1]*T101[1][1] + Si01[3][2]*T101[2][1]) + S10[2][3]*(Si01[3][1]*T101[1][2] + Si01[3][2]*T101[2][2]);
T01[3][4]=Si01[3][1]*T101[1][6] + Si01[3][2]*T101[2][6];
T01[3][5]=S10[1][2]*(Si01[3][1]*T101[1][4] + Si01[3][2]*T101[2][4]) + S10[2][2]*(Si01[3][1]*T101[1][5] + Si01[3][2]*T101[2][5]);
T01[3][6]=S10[1][3]*(Si01[3][1]*T101[1][4] + Si01[3][2]*T101[2][4]) + S10[2][3]*(Si01[3][1]*T101[1][5] + Si01[3][2]*T101[2][5]);

T01[4][1]=T101[6][3];
T01[4][2]=S10[1][2]*T101[6][1] + S10[2][2]*T101[6][2];
T01[4][3]=S10[1][3]*T101[6][1] + S10[2][3]*T101[6][2];
T01[4][4]=T101[6][6];
T01[4][5]=S10[1][2]*T101[6][4] + S10[2][2]*T101[6][5];
T01[4][6]=S10[1][3]*T101[6][4] + S10[2][3]*T101[6][5];

T01[5][1]=Si01[2][1]*T101[4][3] + Si01[2][2]*T101[5][3];
T01[5][2]=S10[1][2]*(Si01[2][1]*T101[4][1] + Si01[2][2]*T101[5][1]) + S10[2][2]*(Si01[2][1]*T101[4][2] + Si01[2][2]*T101[5][2]);
T01[5][3]=S10[1][3]*(Si01[2][1]*T101[4][1] + Si01[2][2]*T101[5][1]) + S10[2][3]*(Si01[2][1]*T101[4][2] + Si01[2][2]*T101[5][2]);
T01[5][4]=Si01[2][1]*T101[4][6] + Si01[2][2]*T101[5][6];
T01[5][5]=S10[1][2]*(Si01[2][1]*T101[4][4] + Si01[2][2]*T101[5][4]) + S10[2][2]*(Si01[2][1]*T101[4][5] + Si01[2][2]*T101[5][5]);
T01[5][6]=S10[1][3]*(Si01[2][1]*T101[4][4] + Si01[2][2]*T101[5][4]) + S10[2][3]*(Si01[2][1]*T101[4][5] + Si01[2][2]*T101[5][5]);

T01[6][1]=Si01[3][1]*T101[4][3] + Si01[3][2]*T101[5][3];
T01[6][2]=S10[1][2]*(Si01[3][1]*T101[4][1] + Si01[3][2]*T101[5][1]) + S10[2][2]*(Si01[3][1]*T101[4][2] + Si01[3][2]*T101[5][2]);
T01[6][3]=S10[1][3]*(Si01[3][1]*T101[4][1] + Si01[3][2]*T101[5][1]) + S10[2][3]*(Si01[3][1]*T101[4][2] + Si01[3][2]*T101[5][2]);
T01[6][4]=Si01[3][1]*T101[4][6] + Si01[3][2]*T101[5][6];
T01[6][5]=S10[1][2]*(Si01[3][1]*T101[4][4] + Si01[3][2]*T101[5][4]) + S10[2][2]*(Si01[3][1]*T101[4][5] + Si01[3][2]*T101[5][5]);
T01[6][6]=S10[1][3]*(Si01[3][1]*T101[4][4] + Si01[3][2]*T101[5][4]) + S10[2][3]*(Si01[3][1]*T101[4][5] + Si01[3][2]*T101[5][5]);



}


void
arm3D_InvDynArtfunc11(void)
      {
JA0[1][1]=T01[1][1];
JA0[1][2]=links[0].mcm[3] + T01[1][2];
JA0[1][3]=-links[0].mcm[2] + T01[1][3];
JA0[1][4]=links[0].m + T01[1][4];
JA0[1][5]=T01[1][5];
JA0[1][6]=T01[1][6];

JA0[2][1]=-links[0].mcm[3] + T01[2][1];
JA0[2][2]=T01[2][2];
JA0[2][3]=links[0].mcm[1] + T01[2][3];
JA0[2][4]=T01[2][4];
JA0[2][5]=links[0].m + T01[2][5];
JA0[2][6]=T01[2][6];

JA0[3][1]=links[0].mcm[2] + T01[3][1];
JA0[3][2]=-links[0].mcm[1] + T01[3][2];
JA0[3][3]=T01[3][3];
JA0[3][4]=T01[3][4];
JA0[3][5]=T01[3][5];
JA0[3][6]=links[0].m + T01[3][6];

JA0[4][1]=links[0].inertia[1][1] + T01[4][1];
JA0[4][2]=links[0].inertia[1][2] + T01[4][2];
JA0[4][3]=links[0].inertia[1][3] + T01[4][3];
JA0[4][4]=T01[4][4];
JA0[4][5]=-links[0].mcm[3] + T01[4][5];
JA0[4][6]=links[0].mcm[2] + T01[4][6];

JA0[5][1]=links[0].inertia[1][2] + T01[5][1];
JA0[5][2]=links[0].inertia[2][2] + T01[5][2];
JA0[5][3]=links[0].inertia[2][3] + T01[5][3];
JA0[5][4]=links[0].mcm[3] + T01[5][4];
JA0[5][5]=T01[5][5];
JA0[5][6]=-links[0].mcm[1] + T01[5][6];

JA0[6][1]=links[0].inertia[1][3] + T01[6][1];
JA0[6][2]=links[0].inertia[2][3] + T01[6][2];
JA0[6][3]=links[0].inertia[3][3] + T01[6][3];
JA0[6][4]=-links[0].mcm[2] + T01[6][4];
JA0[6][5]=links[0].mcm[1] + T01[6][5];
JA0[6][6]=T01[6][6];



}


void
arm3D_InvDynArtfunc12(void)
      {
/* bias forces */
p4[1]=pv4[1];
p4[2]=pv4[2];
p4[3]=pv4[3];
p4[4]=pv4[4];
p4[5]=pv4[5];
p4[6]=pv4[6];

pmm4[1]=p4[1];
pmm4[2]=p4[2];
pmm4[3]=p4[3];
pmm4[4]=p4[4];
pmm4[5]=p4[5];
pmm4[6]=p4[6];

pm4[1]=pmm4[1]*Si34[1][1] + pmm4[2]*Si34[1][2] + pmm4[3]*Si34[1][3];
pm4[2]=pmm4[1]*Si34[2][1] + pmm4[2]*Si34[2][2] + pmm4[3]*Si34[2][3];
pm4[3]=pmm4[1]*Si34[3][1] + pmm4[2]*Si34[3][2] + pmm4[3]*Si34[3][3];
pm4[4]=pmm4[4]*Si34[1][1] + pmm4[5]*Si34[1][2] + pmm4[6]*Si34[1][3] + pmm4[1]*(-(eff[1].x[3]*Si34[2][1]) + eff[1].x[2]*Si34[3][1]) + pmm4[2]*(-(eff[1].x[3]*Si34[2][2]) + eff[1].x[2]*Si34[3][2]) + pmm4[3]*(-(eff[1].x[3]*Si34[2][3]) + eff[1].x[2]*Si34[3][3]);
pm4[5]=pmm4[4]*Si34[2][1] + pmm4[5]*Si34[2][2] + pmm4[6]*Si34[2][3] + pmm4[1]*(eff[1].x[3]*Si34[1][1] - eff[1].x[1]*Si34[3][1]) + pmm4[2]*(eff[1].x[3]*Si34[1][2] - eff[1].x[1]*Si34[3][2]) + pmm4[3]*(eff[1].x[3]*Si34[1][3] - eff[1].x[1]*Si34[3][3]);
pm4[6]=pmm4[1]*(-(eff[1].x[2]*Si34[1][1]) + eff[1].x[1]*Si34[2][1]) + pmm4[2]*(-(eff[1].x[2]*Si34[1][2]) + eff[1].x[1]*Si34[2][2]) + pmm4[3]*(-(eff[1].x[2]*Si34[1][3]) + eff[1].x[1]*Si34[2][3]) + pmm4[4]*Si34[3][1] + pmm4[5]*Si34[3][2] + pmm4[6]*Si34[3][3];

p3[1]=pm4[1] + pv3[1];
p3[2]=pm4[2] + pv3[2];
p3[3]=pm4[3] + pv3[3];
p3[4]=pm4[4] + pv3[4];
p3[5]=pm4[5] + pv3[5];
p3[6]=pm4[6] + pv3[6];

pmm3[1]=state[3].thdd*h3[1] + p3[1] + c3[1]*JA3[1][1] + c3[2]*JA3[1][2] + c3[4]*JA3[1][4] + c3[5]*JA3[1][5];
pmm3[2]=state[3].thdd*h3[2] + p3[2] + c3[1]*JA3[2][1] + c3[2]*JA3[2][2] + c3[4]*JA3[2][4] + c3[5]*JA3[2][5];
pmm3[3]=state[3].thdd*h3[3] + p3[3] + c3[1]*JA3[3][1] + c3[2]*JA3[3][2] + c3[4]*JA3[3][4] + c3[5]*JA3[3][5];
pmm3[4]=state[3].thdd*h3[4] + p3[4] + c3[1]*JA3[4][1] + c3[2]*JA3[4][2] + c3[4]*JA3[4][4] + c3[5]*JA3[4][5];
pmm3[5]=state[3].thdd*h3[5] + p3[5] + c3[1]*JA3[5][1] + c3[2]*JA3[5][2] + c3[4]*JA3[5][4] + c3[5]*JA3[5][5];
pmm3[6]=state[3].thdd*h3[6] + p3[6] + c3[1]*JA3[6][1] + c3[2]*JA3[6][2] + c3[4]*JA3[6][4] + c3[5]*JA3[6][5];

pm3[1]=pmm3[1]*Si23[1][1] + pmm3[2]*Si23[1][2];
pm3[2]=pmm3[1]*Si23[2][1] + pmm3[2]*Si23[2][2];
pm3[3]=pmm3[3];
pm3[4]=pmm3[4]*Si23[1][1] + pmm3[5]*Si23[1][2];
pm3[5]=-(l2*pmm3[3]) + pmm3[4]*Si23[2][1] + pmm3[5]*Si23[2][2];
pm3[6]=pmm3[6] + l2*pmm3[1]*Si23[2][1] + l2*pmm3[2]*Si23[2][2];

p2[1]=pm3[1] + pv2[1];
p2[2]=pm3[2] + pv2[2];
p2[3]=pm3[3] + pv2[3];
p2[4]=pm3[4] + pv2[4];
p2[5]=pm3[5] + pv2[5];
p2[6]=pm3[6] + pv2[6];

pmm2[1]=state[2].thdd*h2[1] + p2[1] + c2[1]*JA2[1][1] + c2[2]*JA2[1][2] + c2[4]*JA2[1][4] + c2[5]*JA2[1][5];
pmm2[2]=state[2].thdd*h2[2] + p2[2] + c2[1]*JA2[2][1] + c2[2]*JA2[2][2] + c2[4]*JA2[2][4] + c2[5]*JA2[2][5];
pmm2[3]=state[2].thdd*h2[3] + p2[3] + c2[1]*JA2[3][1] + c2[2]*JA2[3][2] + c2[4]*JA2[3][4] + c2[5]*JA2[3][5];
pmm2[4]=state[2].thdd*h2[4] + p2[4] + c2[1]*JA2[4][1] + c2[2]*JA2[4][2] + c2[4]*JA2[4][4] + c2[5]*JA2[4][5];
pmm2[5]=state[2].thdd*h2[5] + p2[5] + c2[1]*JA2[5][1] + c2[2]*JA2[5][2] + c2[4]*JA2[5][4] + c2[5]*JA2[5][5];
pmm2[6]=state[2].thdd*h2[6] + p2[6] + c2[1]*JA2[6][1] + c2[2]*JA2[6][2] + c2[4]*JA2[6][4] + c2[5]*JA2[6][5];

pm2[1]=pmm2[1]*Si12[1][1] + pmm2[2]*Si12[1][2];
pm2[2]=pmm2[1]*Si12[2][1] + pmm2[2]*Si12[2][2];
pm2[3]=pmm2[3];
pm2[4]=pmm2[4]*Si12[1][1] + pmm2[5]*Si12[1][2];
pm2[5]=-(l1*pmm2[3]) + pmm2[4]*Si12[2][1] + pmm2[5]*Si12[2][2];
pm2[6]=pmm2[6] + l1*pmm2[1]*Si12[2][1] + l1*pmm2[2]*Si12[2][2];

p1[1]=pm2[1] + pv1[1];
p1[2]=pm2[2] + pv1[2];
p1[3]=pm2[3] + pv1[3];
p1[4]=pm2[4] + pv1[4];
p1[5]=pm2[5] + pv1[5];
p1[6]=pm2[6] + pv1[6];

pmm1[1]=state[1].thdd*h1[1] + p1[1] + c1[1]*JA1[1][1] + c1[2]*JA1[1][2] + c1[4]*JA1[1][4] + c1[5]*JA1[1][5];
pmm1[2]=state[1].thdd*h1[2] + p1[2] + c1[1]*JA1[2][1] + c1[2]*JA1[2][2] + c1[4]*JA1[2][4] + c1[5]*JA1[2][5];
pmm1[3]=state[1].thdd*h1[3] + p1[3] + c1[1]*JA1[3][1] + c1[2]*JA1[3][2] + c1[4]*JA1[3][4] + c1[5]*JA1[3][5];
pmm1[4]=state[1].thdd*h1[4] + p1[4] + c1[1]*JA1[4][1] + c1[2]*JA1[4][2] + c1[4]*JA1[4][4] + c1[5]*JA1[4][5];
pmm1[5]=state[1].thdd*h1[5] + p1[5] + c1[1]*JA1[5][1] + c1[2]*JA1[5][2] + c1[4]*JA1[5][4] + c1[5]*JA1[5][5];
pmm1[6]=state[1].thdd*h1[6] + p1[6] + c1[1]*JA1[6][1] + c1[2]*JA1[6][2] + c1[4]*JA1[6][4] + c1[5]*JA1[6][5];

pm1[1]=pmm1[3];
pm1[2]=pmm1[1]*Si01[2][1] + pmm1[2]*Si01[2][2];
pm1[3]=pmm1[1]*Si01[3][1] + pmm1[2]*Si01[3][2];
pm1[4]=pmm1[6];
pm1[5]=pmm1[4]*Si01[2][1] + pmm1[5]*Si01[2][2];
pm1[6]=pmm1[4]*Si01[3][1] + pmm1[5]*Si01[3][2];

p0[1]=pm1[1] + pv0[1];
p0[2]=pm1[2] + pv0[2];
p0[3]=pm1[3] + pv0[3];
p0[4]=pm1[4] + pv0[4];
p0[5]=pm1[5] + pv0[5];
p0[6]=pm1[6] + pv0[6];


}

