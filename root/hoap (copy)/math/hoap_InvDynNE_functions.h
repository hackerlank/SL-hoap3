
void
hoap_InvDynNEfunc1(void)
     {
/* rotation matrices */
S00[1][1]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[2],2);
S00[1][2]=2*(baseo[0].q[2]*baseo[0].q[3] + baseo[0].q[1]*baseo[0].q[4]);
S00[1][3]=2*(-(baseo[0].q[1]*baseo[0].q[3]) + baseo[0].q[2]*baseo[0].q[4]);

S00[2][1]=2*(baseo[0].q[2]*baseo[0].q[3] - baseo[0].q[1]*baseo[0].q[4]);
S00[2][2]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[3],2);
S00[2][3]=2*(baseo[0].q[1]*baseo[0].q[2] + baseo[0].q[3]*baseo[0].q[4]);

S00[3][1]=2*(baseo[0].q[1]*baseo[0].q[3] + baseo[0].q[2]*baseo[0].q[4]);
S00[3][2]=2*(-(baseo[0].q[1]*baseo[0].q[2]) + baseo[0].q[3]*baseo[0].q[4]);
S00[3][3]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[4],2);



S21[1][1]=cstate7th;
S21[1][3]=-sstate7th;

S21[2][1]=-sstate7th;
S21[2][3]=-cstate7th;


S32[1][1]=-sstate8th;
S32[1][3]=cstate8th;

S32[2][1]=-cstate8th;
S32[2][3]=-sstate8th;


S43[1][1]=-sstate9th;
S43[1][3]=cstate9th;

S43[2][1]=-cstate9th;
S43[2][3]=-sstate9th;


S54[1][1]=cstate10th;
S54[1][3]=sstate10th;

S54[2][1]=-sstate10th;
S54[2][3]=cstate10th;





S91[1][1]=cstate17th;
S91[1][3]=-sstate17th;

S91[2][1]=-sstate17th;
S91[2][3]=-cstate17th;


S109[1][1]=-sstate18th;
S109[1][3]=cstate18th;

S109[2][1]=-cstate18th;
S109[2][3]=-sstate18th;


S1110[1][1]=-sstate19th;
S1110[1][3]=cstate19th;

S1110[2][1]=-cstate19th;
S1110[2][3]=-sstate19th;


S1211[1][1]=cstate20th;
S1211[1][3]=sstate20th;

S1211[2][1]=-sstate20th;
S1211[2][3]=cstate20th;


S1312[1][1]=sstate27th;
S1312[1][3]=cstate27th;

S1312[2][1]=cstate27th;
S1312[2][3]=-sstate27th;


S1413[1][2]=cstate28th;
S1413[1][3]=sstate28th;

S1413[2][2]=-sstate28th;
S1413[2][3]=cstate28th;




S1716[1][1]=rceff4a2*rceff4a3;
S1716[1][2]=rceff4a3*rseff4a1*rseff4a2 + rceff4a1*rseff4a3;
S1716[1][3]=-(rceff4a1*rceff4a3*rseff4a2) + rseff4a1*rseff4a3;

S1716[2][1]=-(rceff4a2*rseff4a3);
S1716[2][2]=rceff4a1*rceff4a3 - rseff4a1*rseff4a2*rseff4a3;
S1716[2][3]=rceff4a3*rseff4a1 + rceff4a1*rseff4a2*rseff4a3;

S1716[3][1]=rseff4a2;
S1716[3][2]=-(rceff4a2*rseff4a1);
S1716[3][3]=rceff4a1*rceff4a2;


S181[1][1]=cstate22th;
S181[1][2]=sstate22th;

S181[2][1]=-sstate22th;
S181[2][2]=cstate22th;



S2019[1][1]=cstate24th;
S2019[1][3]=sstate24th;

S2019[2][1]=-sstate24th;
S2019[2][3]=cstate24th;


S210[1][1]=cstate21th;
S210[1][3]=sstate21th;

S210[2][1]=-sstate21th;
S210[2][3]=cstate21th;


S2221[1][1]=-sstate1th;
S2221[1][3]=-cstate1th;

S2221[2][1]=-cstate1th;
S2221[2][3]=sstate1th;


S2322[1][1]=-sstate2th;
S2322[1][3]=cstate2th;

S2322[2][1]=-cstate2th;
S2322[2][3]=-sstate2th;


S2423[1][1]=cstate3th;
S2423[1][3]=sstate3th;

S2423[2][1]=-sstate3th;
S2423[2][3]=cstate3th;


S2524[1][1]=cstate4th;
S2524[1][2]=sstate4th;

S2524[2][1]=-sstate4th;
S2524[2][2]=cstate4th;


S2625[1][1]=cstate5th;
S2625[1][2]=sstate5th;

S2625[2][1]=-sstate5th;
S2625[2][2]=cstate5th;


S2726[1][1]=cstate6th;
S2726[1][3]=-sstate6th;

S2726[2][1]=-sstate6th;
S2726[2][3]=-cstate6th;






S3227[1][1]=rceff1a2*rceff1a3;
S3227[1][2]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
S3227[1][3]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;

S3227[2][1]=-(rceff1a2*rseff1a3);
S3227[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
S3227[2][3]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;

S3227[3][1]=rseff1a2;
S3227[3][2]=-(rceff1a2*rseff1a1);
S3227[3][3]=rceff1a1*rceff1a2;


S3321[1][1]=-sstate11th;
S3321[1][3]=-cstate11th;

S3321[2][1]=-cstate11th;
S3321[2][3]=sstate11th;


S3433[1][1]=-sstate12th;
S3433[1][3]=cstate12th;

S3433[2][1]=-cstate12th;
S3433[2][3]=-sstate12th;


S3534[1][1]=cstate13th;
S3534[1][3]=sstate13th;

S3534[2][1]=-sstate13th;
S3534[2][3]=cstate13th;


S3635[1][1]=cstate14th;
S3635[1][2]=sstate14th;

S3635[2][1]=-sstate14th;
S3635[2][2]=cstate14th;


S3736[1][1]=cstate15th;
S3736[1][2]=sstate15th;

S3736[2][1]=-sstate15th;
S3736[2][2]=cstate15th;


S3837[1][1]=cstate16th;
S3837[1][3]=-sstate16th;

S3837[2][1]=-sstate16th;
S3837[2][3]=-cstate16th;



S4039[1][1]=rceff3a2*rceff3a3;
S4039[1][2]=rceff3a3*rseff3a1*rseff3a2 + rceff3a1*rseff3a3;
S4039[1][3]=-(rceff3a1*rceff3a3*rseff3a2) + rseff3a1*rseff3a3;

S4039[2][1]=-(rceff3a2*rseff3a3);
S4039[2][2]=rceff3a1*rceff3a3 - rseff3a1*rseff3a2*rseff3a3;
S4039[2][3]=rceff3a3*rseff3a1 + rceff3a1*rseff3a2*rseff3a3;

S4039[3][1]=rseff3a2;
S4039[3][2]=-(rceff3a2*rseff3a1);
S4039[3][3]=rceff3a1*rceff3a2;







S4645[1][1]=rceff2a2*rceff2a3;
S4645[1][2]=rceff2a3*rseff2a1*rseff2a2 + rceff2a1*rseff2a3;
S4645[1][3]=-(rceff2a1*rceff2a3*rseff2a2) + rseff2a1*rseff2a3;

S4645[2][1]=-(rceff2a2*rseff2a3);
S4645[2][2]=rceff2a1*rceff2a3 - rseff2a1*rseff2a2*rseff2a3;
S4645[2][3]=rceff2a3*rseff2a1 + rceff2a1*rseff2a2*rseff2a3;

S4645[3][1]=rseff2a2;
S4645[3][2]=-(rceff2a2*rseff2a1);
S4645[3][3]=rceff2a1*rceff2a2;




}


void
hoap_InvDynNEfunc2(void)
     {
/* inverse rotation matrices */
Si00[1][1]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[2],2);
Si00[1][2]=2*(baseo[0].q[2]*baseo[0].q[3] - baseo[0].q[1]*baseo[0].q[4]);
Si00[1][3]=2*(baseo[0].q[1]*baseo[0].q[3] + baseo[0].q[2]*baseo[0].q[4]);

Si00[2][1]=2*(baseo[0].q[2]*baseo[0].q[3] + baseo[0].q[1]*baseo[0].q[4]);
Si00[2][2]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[3],2);
Si00[2][3]=2*(-(baseo[0].q[1]*baseo[0].q[2]) + baseo[0].q[3]*baseo[0].q[4]);

Si00[3][1]=2*(-(baseo[0].q[1]*baseo[0].q[3]) + baseo[0].q[2]*baseo[0].q[4]);
Si00[3][2]=2*(baseo[0].q[1]*baseo[0].q[2] + baseo[0].q[3]*baseo[0].q[4]);
Si00[3][3]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[4],2);



Si12[1][1]=cstate7th;
Si12[1][2]=-sstate7th;

Si12[3][1]=-sstate7th;
Si12[3][2]=-cstate7th;


Si23[1][1]=-sstate8th;
Si23[1][2]=-cstate8th;

Si23[3][1]=cstate8th;
Si23[3][2]=-sstate8th;


Si34[1][1]=-sstate9th;
Si34[1][2]=-cstate9th;

Si34[3][1]=cstate9th;
Si34[3][2]=-sstate9th;


Si45[1][1]=cstate10th;
Si45[1][2]=-sstate10th;

Si45[3][1]=sstate10th;
Si45[3][2]=cstate10th;





Si19[1][1]=cstate17th;
Si19[1][2]=-sstate17th;

Si19[3][1]=-sstate17th;
Si19[3][2]=-cstate17th;


Si910[1][1]=-sstate18th;
Si910[1][2]=-cstate18th;

Si910[3][1]=cstate18th;
Si910[3][2]=-sstate18th;


Si1011[1][1]=-sstate19th;
Si1011[1][2]=-cstate19th;

Si1011[3][1]=cstate19th;
Si1011[3][2]=-sstate19th;


Si1112[1][1]=cstate20th;
Si1112[1][2]=-sstate20th;

Si1112[3][1]=sstate20th;
Si1112[3][2]=cstate20th;


Si1213[1][1]=sstate27th;
Si1213[1][2]=cstate27th;

Si1213[3][1]=cstate27th;
Si1213[3][2]=-sstate27th;


Si1314[2][1]=cstate28th;
Si1314[2][2]=-sstate28th;

Si1314[3][1]=sstate28th;
Si1314[3][2]=cstate28th;




Si1617[1][1]=rceff4a2*rceff4a3;
Si1617[1][2]=-(rceff4a2*rseff4a3);
Si1617[1][3]=rseff4a2;

Si1617[2][1]=rceff4a3*rseff4a1*rseff4a2 + rceff4a1*rseff4a3;
Si1617[2][2]=rceff4a1*rceff4a3 - rseff4a1*rseff4a2*rseff4a3;
Si1617[2][3]=-(rceff4a2*rseff4a1);

Si1617[3][1]=-(rceff4a1*rceff4a3*rseff4a2) + rseff4a1*rseff4a3;
Si1617[3][2]=rceff4a3*rseff4a1 + rceff4a1*rseff4a2*rseff4a3;
Si1617[3][3]=rceff4a1*rceff4a2;


Si118[1][1]=cstate22th;
Si118[1][2]=-sstate22th;

Si118[2][1]=sstate22th;
Si118[2][2]=cstate22th;



Si1920[1][1]=cstate24th;
Si1920[1][2]=-sstate24th;

Si1920[3][1]=sstate24th;
Si1920[3][2]=cstate24th;


Si021[1][1]=cstate21th;
Si021[1][2]=-sstate21th;

Si021[3][1]=sstate21th;
Si021[3][2]=cstate21th;


Si2122[1][1]=-sstate1th;
Si2122[1][2]=-cstate1th;

Si2122[3][1]=-cstate1th;
Si2122[3][2]=sstate1th;


Si2223[1][1]=-sstate2th;
Si2223[1][2]=-cstate2th;

Si2223[3][1]=cstate2th;
Si2223[3][2]=-sstate2th;


Si2324[1][1]=cstate3th;
Si2324[1][2]=-sstate3th;

Si2324[3][1]=sstate3th;
Si2324[3][2]=cstate3th;


Si2425[1][1]=cstate4th;
Si2425[1][2]=-sstate4th;

Si2425[2][1]=sstate4th;
Si2425[2][2]=cstate4th;


Si2526[1][1]=cstate5th;
Si2526[1][2]=-sstate5th;

Si2526[2][1]=sstate5th;
Si2526[2][2]=cstate5th;


Si2627[1][1]=cstate6th;
Si2627[1][2]=-sstate6th;

Si2627[3][1]=-sstate6th;
Si2627[3][2]=-cstate6th;






Si2732[1][1]=rceff1a2*rceff1a3;
Si2732[1][2]=-(rceff1a2*rseff1a3);
Si2732[1][3]=rseff1a2;

Si2732[2][1]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
Si2732[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
Si2732[2][3]=-(rceff1a2*rseff1a1);

Si2732[3][1]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;
Si2732[3][2]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;
Si2732[3][3]=rceff1a1*rceff1a2;


Si2133[1][1]=-sstate11th;
Si2133[1][2]=-cstate11th;

Si2133[3][1]=-cstate11th;
Si2133[3][2]=sstate11th;


Si3334[1][1]=-sstate12th;
Si3334[1][2]=-cstate12th;

Si3334[3][1]=cstate12th;
Si3334[3][2]=-sstate12th;


Si3435[1][1]=cstate13th;
Si3435[1][2]=-sstate13th;

Si3435[3][1]=sstate13th;
Si3435[3][2]=cstate13th;


Si3536[1][1]=cstate14th;
Si3536[1][2]=-sstate14th;

Si3536[2][1]=sstate14th;
Si3536[2][2]=cstate14th;


Si3637[1][1]=cstate15th;
Si3637[1][2]=-sstate15th;

Si3637[2][1]=sstate15th;
Si3637[2][2]=cstate15th;


Si3738[1][1]=cstate16th;
Si3738[1][2]=-sstate16th;

Si3738[3][1]=-sstate16th;
Si3738[3][2]=-cstate16th;



Si3940[1][1]=rceff3a2*rceff3a3;
Si3940[1][2]=-(rceff3a2*rseff3a3);
Si3940[1][3]=rseff3a2;

Si3940[2][1]=rceff3a3*rseff3a1*rseff3a2 + rceff3a1*rseff3a3;
Si3940[2][2]=rceff3a1*rceff3a3 - rseff3a1*rseff3a2*rseff3a3;
Si3940[2][3]=-(rceff3a2*rseff3a1);

Si3940[3][1]=-(rceff3a1*rceff3a3*rseff3a2) + rseff3a1*rseff3a3;
Si3940[3][2]=rceff3a3*rseff3a1 + rceff3a1*rseff3a2*rseff3a3;
Si3940[3][3]=rceff3a1*rceff3a2;







Si4546[1][1]=rceff2a2*rceff2a3;
Si4546[1][2]=-(rceff2a2*rseff2a3);
Si4546[1][3]=rseff2a2;

Si4546[2][1]=rceff2a3*rseff2a1*rseff2a2 + rceff2a1*rseff2a3;
Si4546[2][2]=rceff2a1*rceff2a3 - rseff2a1*rseff2a2*rseff2a3;
Si4546[2][3]=-(rceff2a2*rseff2a1);

Si4546[3][1]=-(rceff2a1*rceff2a3*rseff2a2) + rseff2a1*rseff2a3;
Si4546[3][2]=rceff2a3*rseff2a1 + rceff2a1*rseff2a2*rseff2a3;
Si4546[3][3]=rceff2a1*rceff2a2;




}


void
hoap_InvDynNEfunc3(void)
     {
/* rotation matrices from global to link coordinates */
SG10[1][1]=S00[1][1];
SG10[1][2]=S00[1][2];
SG10[1][3]=S00[1][3];

SG10[2][1]=S00[2][1];
SG10[2][2]=S00[2][2];
SG10[2][3]=S00[2][3];

SG10[3][1]=S00[3][1];
SG10[3][2]=S00[3][2];
SG10[3][3]=S00[3][3];


SG20[1][1]=S21[1][1]*SG10[1][1] + S21[1][3]*SG10[3][1];
SG20[1][2]=S21[1][1]*SG10[1][2] + S21[1][3]*SG10[3][2];
SG20[1][3]=S21[1][1]*SG10[1][3] + S21[1][3]*SG10[3][3];

SG20[2][1]=S21[2][1]*SG10[1][1] + S21[2][3]*SG10[3][1];
SG20[2][2]=S21[2][1]*SG10[1][2] + S21[2][3]*SG10[3][2];
SG20[2][3]=S21[2][1]*SG10[1][3] + S21[2][3]*SG10[3][3];

SG20[3][1]=SG10[2][1];
SG20[3][2]=SG10[2][2];
SG20[3][3]=SG10[2][3];


SG30[1][1]=S32[1][1]*SG20[1][1] + S32[1][3]*SG20[3][1];
SG30[1][2]=S32[1][1]*SG20[1][2] + S32[1][3]*SG20[3][2];
SG30[1][3]=S32[1][1]*SG20[1][3] + S32[1][3]*SG20[3][3];

SG30[2][1]=S32[2][1]*SG20[1][1] + S32[2][3]*SG20[3][1];
SG30[2][2]=S32[2][1]*SG20[1][2] + S32[2][3]*SG20[3][2];
SG30[2][3]=S32[2][1]*SG20[1][3] + S32[2][3]*SG20[3][3];

SG30[3][1]=-SG20[2][1];
SG30[3][2]=-SG20[2][2];
SG30[3][3]=-SG20[2][3];


SG40[1][1]=S43[1][1]*SG30[1][1] + S43[1][3]*SG30[3][1];
SG40[1][2]=S43[1][1]*SG30[1][2] + S43[1][3]*SG30[3][2];
SG40[1][3]=S43[1][1]*SG30[1][3] + S43[1][3]*SG30[3][3];

SG40[2][1]=S43[2][1]*SG30[1][1] + S43[2][3]*SG30[3][1];
SG40[2][2]=S43[2][1]*SG30[1][2] + S43[2][3]*SG30[3][2];
SG40[2][3]=S43[2][1]*SG30[1][3] + S43[2][3]*SG30[3][3];

SG40[3][1]=-SG30[2][1];
SG40[3][2]=-SG30[2][2];
SG40[3][3]=-SG30[2][3];


SG50[1][1]=S54[1][1]*SG40[1][1] + S54[1][3]*SG40[3][1];
SG50[1][2]=S54[1][1]*SG40[1][2] + S54[1][3]*SG40[3][2];
SG50[1][3]=S54[1][1]*SG40[1][3] + S54[1][3]*SG40[3][3];

SG50[2][1]=S54[2][1]*SG40[1][1] + S54[2][3]*SG40[3][1];
SG50[2][2]=S54[2][1]*SG40[1][2] + S54[2][3]*SG40[3][2];
SG50[2][3]=S54[2][1]*SG40[1][3] + S54[2][3]*SG40[3][3];

SG50[3][1]=-SG40[2][1];
SG50[3][2]=-SG40[2][2];
SG50[3][3]=-SG40[2][3];


SG60[1][1]=SG50[3][1];
SG60[1][2]=SG50[3][2];
SG60[1][3]=SG50[3][3];

SG60[2][1]=SG50[1][1];
SG60[2][2]=SG50[1][2];
SG60[2][3]=SG50[1][3];

SG60[3][1]=SG50[2][1];
SG60[3][2]=SG50[2][2];
SG60[3][3]=SG50[2][3];


SG70[1][1]=SG60[2][1];
SG70[1][2]=SG60[2][2];
SG70[1][3]=SG60[2][3];

SG70[2][1]=SG60[3][1];
SG70[2][2]=SG60[3][2];
SG70[2][3]=SG60[3][3];

SG70[3][1]=SG60[1][1];
SG70[3][2]=SG60[1][2];
SG70[3][3]=SG60[1][3];


SG80[1][1]=SG70[1][1];
SG80[1][2]=SG70[1][2];
SG80[1][3]=SG70[1][3];

SG80[2][1]=SG70[2][1];
SG80[2][2]=SG70[2][2];
SG80[2][3]=SG70[2][3];

SG80[3][1]=SG70[3][1];
SG80[3][2]=SG70[3][2];
SG80[3][3]=SG70[3][3];


SG90[1][1]=S91[1][1]*SG10[1][1] + S91[1][3]*SG10[3][1];
SG90[1][2]=S91[1][1]*SG10[1][2] + S91[1][3]*SG10[3][2];
SG90[1][3]=S91[1][1]*SG10[1][3] + S91[1][3]*SG10[3][3];

SG90[2][1]=S91[2][1]*SG10[1][1] + S91[2][3]*SG10[3][1];
SG90[2][2]=S91[2][1]*SG10[1][2] + S91[2][3]*SG10[3][2];
SG90[2][3]=S91[2][1]*SG10[1][3] + S91[2][3]*SG10[3][3];

SG90[3][1]=SG10[2][1];
SG90[3][2]=SG10[2][2];
SG90[3][3]=SG10[2][3];


SG100[1][1]=S109[1][1]*SG90[1][1] + S109[1][3]*SG90[3][1];
SG100[1][2]=S109[1][1]*SG90[1][2] + S109[1][3]*SG90[3][2];
SG100[1][3]=S109[1][1]*SG90[1][3] + S109[1][3]*SG90[3][3];

SG100[2][1]=S109[2][1]*SG90[1][1] + S109[2][3]*SG90[3][1];
SG100[2][2]=S109[2][1]*SG90[1][2] + S109[2][3]*SG90[3][2];
SG100[2][3]=S109[2][1]*SG90[1][3] + S109[2][3]*SG90[3][3];

SG100[3][1]=-SG90[2][1];
SG100[3][2]=-SG90[2][2];
SG100[3][3]=-SG90[2][3];


SG110[1][1]=S1110[1][1]*SG100[1][1] + S1110[1][3]*SG100[3][1];
SG110[1][2]=S1110[1][1]*SG100[1][2] + S1110[1][3]*SG100[3][2];
SG110[1][3]=S1110[1][1]*SG100[1][3] + S1110[1][3]*SG100[3][3];

SG110[2][1]=S1110[2][1]*SG100[1][1] + S1110[2][3]*SG100[3][1];
SG110[2][2]=S1110[2][1]*SG100[1][2] + S1110[2][3]*SG100[3][2];
SG110[2][3]=S1110[2][1]*SG100[1][3] + S1110[2][3]*SG100[3][3];

SG110[3][1]=-SG100[2][1];
SG110[3][2]=-SG100[2][2];
SG110[3][3]=-SG100[2][3];


SG120[1][1]=S1211[1][1]*SG110[1][1] + S1211[1][3]*SG110[3][1];
SG120[1][2]=S1211[1][1]*SG110[1][2] + S1211[1][3]*SG110[3][2];
SG120[1][3]=S1211[1][1]*SG110[1][3] + S1211[1][3]*SG110[3][3];

SG120[2][1]=S1211[2][1]*SG110[1][1] + S1211[2][3]*SG110[3][1];
SG120[2][2]=S1211[2][1]*SG110[1][2] + S1211[2][3]*SG110[3][2];
SG120[2][3]=S1211[2][1]*SG110[1][3] + S1211[2][3]*SG110[3][3];

SG120[3][1]=-SG110[2][1];
SG120[3][2]=-SG110[2][2];
SG120[3][3]=-SG110[2][3];


SG130[1][1]=S1312[1][1]*SG120[1][1] + S1312[1][3]*SG120[3][1];
SG130[1][2]=S1312[1][1]*SG120[1][2] + S1312[1][3]*SG120[3][2];
SG130[1][3]=S1312[1][1]*SG120[1][3] + S1312[1][3]*SG120[3][3];

SG130[2][1]=S1312[2][1]*SG120[1][1] + S1312[2][3]*SG120[3][1];
SG130[2][2]=S1312[2][1]*SG120[1][2] + S1312[2][3]*SG120[3][2];
SG130[2][3]=S1312[2][1]*SG120[1][3] + S1312[2][3]*SG120[3][3];

SG130[3][1]=SG120[2][1];
SG130[3][2]=SG120[2][2];
SG130[3][3]=SG120[2][3];


SG140[1][1]=S1413[1][2]*SG130[2][1] + S1413[1][3]*SG130[3][1];
SG140[1][2]=S1413[1][2]*SG130[2][2] + S1413[1][3]*SG130[3][2];
SG140[1][3]=S1413[1][2]*SG130[2][3] + S1413[1][3]*SG130[3][3];

SG140[2][1]=S1413[2][2]*SG130[2][1] + S1413[2][3]*SG130[3][1];
SG140[2][2]=S1413[2][2]*SG130[2][2] + S1413[2][3]*SG130[3][2];
SG140[2][3]=S1413[2][2]*SG130[2][3] + S1413[2][3]*SG130[3][3];

SG140[3][1]=SG130[1][1];
SG140[3][2]=SG130[1][2];
SG140[3][3]=SG130[1][3];


SG150[1][1]=SG140[1][1];
SG150[1][2]=SG140[1][2];
SG150[1][3]=SG140[1][3];

SG150[2][1]=SG140[2][1];
SG150[2][2]=SG140[2][2];
SG150[2][3]=SG140[2][3];

SG150[3][1]=SG140[3][1];
SG150[3][2]=SG140[3][2];
SG150[3][3]=SG140[3][3];


SG160[1][1]=SG130[1][1];
SG160[1][2]=SG130[1][2];
SG160[1][3]=SG130[1][3];

SG160[2][1]=SG130[2][1];
SG160[2][2]=SG130[2][2];
SG160[2][3]=SG130[2][3];

SG160[3][1]=SG130[3][1];
SG160[3][2]=SG130[3][2];
SG160[3][3]=SG130[3][3];


SG170[1][1]=S1716[1][1]*SG160[1][1] + S1716[1][2]*SG160[2][1] + S1716[1][3]*SG160[3][1];
SG170[1][2]=S1716[1][1]*SG160[1][2] + S1716[1][2]*SG160[2][2] + S1716[1][3]*SG160[3][2];
SG170[1][3]=S1716[1][1]*SG160[1][3] + S1716[1][2]*SG160[2][3] + S1716[1][3]*SG160[3][3];

SG170[2][1]=S1716[2][1]*SG160[1][1] + S1716[2][2]*SG160[2][1] + S1716[2][3]*SG160[3][1];
SG170[2][2]=S1716[2][1]*SG160[1][2] + S1716[2][2]*SG160[2][2] + S1716[2][3]*SG160[3][2];
SG170[2][3]=S1716[2][1]*SG160[1][3] + S1716[2][2]*SG160[2][3] + S1716[2][3]*SG160[3][3];

SG170[3][1]=S1716[3][1]*SG160[1][1] + S1716[3][2]*SG160[2][1] + S1716[3][3]*SG160[3][1];
SG170[3][2]=S1716[3][1]*SG160[1][2] + S1716[3][2]*SG160[2][2] + S1716[3][3]*SG160[3][2];
SG170[3][3]=S1716[3][1]*SG160[1][3] + S1716[3][2]*SG160[2][3] + S1716[3][3]*SG160[3][3];


SG180[1][1]=S181[1][1]*SG10[1][1] + S181[1][2]*SG10[2][1];
SG180[1][2]=S181[1][1]*SG10[1][2] + S181[1][2]*SG10[2][2];
SG180[1][3]=S181[1][1]*SG10[1][3] + S181[1][2]*SG10[2][3];

SG180[2][1]=S181[2][1]*SG10[1][1] + S181[2][2]*SG10[2][1];
SG180[2][2]=S181[2][1]*SG10[1][2] + S181[2][2]*SG10[2][2];
SG180[2][3]=S181[2][1]*SG10[1][3] + S181[2][2]*SG10[2][3];

SG180[3][1]=SG10[3][1];
SG180[3][2]=SG10[3][2];
SG180[3][3]=SG10[3][3];


SG190[1][1]=SG180[1][1];
SG190[1][2]=SG180[1][2];
SG190[1][3]=SG180[1][3];

SG190[2][1]=-SG180[3][1];
SG190[2][2]=-SG180[3][2];
SG190[2][3]=-SG180[3][3];

SG190[3][1]=SG180[2][1];
SG190[3][2]=SG180[2][2];
SG190[3][3]=SG180[2][3];


SG200[1][1]=S2019[1][1]*SG190[1][1] + S2019[1][3]*SG190[3][1];
SG200[1][2]=S2019[1][1]*SG190[1][2] + S2019[1][3]*SG190[3][2];
SG200[1][3]=S2019[1][1]*SG190[1][3] + S2019[1][3]*SG190[3][3];

SG200[2][1]=S2019[2][1]*SG190[1][1] + S2019[2][3]*SG190[3][1];
SG200[2][2]=S2019[2][1]*SG190[1][2] + S2019[2][3]*SG190[3][2];
SG200[2][3]=S2019[2][1]*SG190[1][3] + S2019[2][3]*SG190[3][3];

SG200[3][1]=-SG190[2][1];
SG200[3][2]=-SG190[2][2];
SG200[3][3]=-SG190[2][3];


SG210[1][1]=S00[1][1]*S210[1][1] + S00[3][1]*S210[1][3];
SG210[1][2]=S00[1][2]*S210[1][1] + S00[3][2]*S210[1][3];
SG210[1][3]=S00[1][3]*S210[1][1] + S00[3][3]*S210[1][3];

SG210[2][1]=S00[1][1]*S210[2][1] + S00[3][1]*S210[2][3];
SG210[2][2]=S00[1][2]*S210[2][1] + S00[3][2]*S210[2][3];
SG210[2][3]=S00[1][3]*S210[2][1] + S00[3][3]*S210[2][3];

SG210[3][1]=-S00[2][1];
SG210[3][2]=-S00[2][2];
SG210[3][3]=-S00[2][3];


SG220[1][1]=S2221[1][1]*SG210[1][1] + S2221[1][3]*SG210[3][1];
SG220[1][2]=S2221[1][1]*SG210[1][2] + S2221[1][3]*SG210[3][2];
SG220[1][3]=S2221[1][1]*SG210[1][3] + S2221[1][3]*SG210[3][3];

SG220[2][1]=S2221[2][1]*SG210[1][1] + S2221[2][3]*SG210[3][1];
SG220[2][2]=S2221[2][1]*SG210[1][2] + S2221[2][3]*SG210[3][2];
SG220[2][3]=S2221[2][1]*SG210[1][3] + S2221[2][3]*SG210[3][3];

SG220[3][1]=SG210[2][1];
SG220[3][2]=SG210[2][2];
SG220[3][3]=SG210[2][3];


SG230[1][1]=S2322[1][1]*SG220[1][1] + S2322[1][3]*SG220[3][1];
SG230[1][2]=S2322[1][1]*SG220[1][2] + S2322[1][3]*SG220[3][2];
SG230[1][3]=S2322[1][1]*SG220[1][3] + S2322[1][3]*SG220[3][3];

SG230[2][1]=S2322[2][1]*SG220[1][1] + S2322[2][3]*SG220[3][1];
SG230[2][2]=S2322[2][1]*SG220[1][2] + S2322[2][3]*SG220[3][2];
SG230[2][3]=S2322[2][1]*SG220[1][3] + S2322[2][3]*SG220[3][3];

SG230[3][1]=-SG220[2][1];
SG230[3][2]=-SG220[2][2];
SG230[3][3]=-SG220[2][3];


SG240[1][1]=S2423[1][1]*SG230[1][1] + S2423[1][3]*SG230[3][1];
SG240[1][2]=S2423[1][1]*SG230[1][2] + S2423[1][3]*SG230[3][2];
SG240[1][3]=S2423[1][1]*SG230[1][3] + S2423[1][3]*SG230[3][3];

SG240[2][1]=S2423[2][1]*SG230[1][1] + S2423[2][3]*SG230[3][1];
SG240[2][2]=S2423[2][1]*SG230[1][2] + S2423[2][3]*SG230[3][2];
SG240[2][3]=S2423[2][1]*SG230[1][3] + S2423[2][3]*SG230[3][3];

SG240[3][1]=-SG230[2][1];
SG240[3][2]=-SG230[2][2];
SG240[3][3]=-SG230[2][3];


SG250[1][1]=S2524[1][1]*SG240[1][1] + S2524[1][2]*SG240[2][1];
SG250[1][2]=S2524[1][1]*SG240[1][2] + S2524[1][2]*SG240[2][2];
SG250[1][3]=S2524[1][1]*SG240[1][3] + S2524[1][2]*SG240[2][3];

SG250[2][1]=S2524[2][1]*SG240[1][1] + S2524[2][2]*SG240[2][1];
SG250[2][2]=S2524[2][1]*SG240[1][2] + S2524[2][2]*SG240[2][2];
SG250[2][3]=S2524[2][1]*SG240[1][3] + S2524[2][2]*SG240[2][3];

SG250[3][1]=SG240[3][1];
SG250[3][2]=SG240[3][2];
SG250[3][3]=SG240[3][3];


SG260[1][1]=S2625[1][1]*SG250[1][1] + S2625[1][2]*SG250[2][1];
SG260[1][2]=S2625[1][1]*SG250[1][2] + S2625[1][2]*SG250[2][2];
SG260[1][3]=S2625[1][1]*SG250[1][3] + S2625[1][2]*SG250[2][3];

SG260[2][1]=S2625[2][1]*SG250[1][1] + S2625[2][2]*SG250[2][1];
SG260[2][2]=S2625[2][1]*SG250[1][2] + S2625[2][2]*SG250[2][2];
SG260[2][3]=S2625[2][1]*SG250[1][3] + S2625[2][2]*SG250[2][3];

SG260[3][1]=SG250[3][1];
SG260[3][2]=SG250[3][2];
SG260[3][3]=SG250[3][3];


SG270[1][1]=S2726[1][1]*SG260[1][1] + S2726[1][3]*SG260[3][1];
SG270[1][2]=S2726[1][1]*SG260[1][2] + S2726[1][3]*SG260[3][2];
SG270[1][3]=S2726[1][1]*SG260[1][3] + S2726[1][3]*SG260[3][3];

SG270[2][1]=S2726[2][1]*SG260[1][1] + S2726[2][3]*SG260[3][1];
SG270[2][2]=S2726[2][1]*SG260[1][2] + S2726[2][3]*SG260[3][2];
SG270[2][3]=S2726[2][1]*SG260[1][3] + S2726[2][3]*SG260[3][3];

SG270[3][1]=SG260[2][1];
SG270[3][2]=SG260[2][2];
SG270[3][3]=SG260[2][3];


SG280[1][1]=SG270[1][1];
SG280[1][2]=SG270[1][2];
SG280[1][3]=SG270[1][3];

SG280[2][1]=SG270[2][1];
SG280[2][2]=SG270[2][2];
SG280[2][3]=SG270[2][3];

SG280[3][1]=SG270[3][1];
SG280[3][2]=SG270[3][2];
SG280[3][3]=SG270[3][3];


SG290[1][1]=SG270[1][1];
SG290[1][2]=SG270[1][2];
SG290[1][3]=SG270[1][3];

SG290[2][1]=SG270[2][1];
SG290[2][2]=SG270[2][2];
SG290[2][3]=SG270[2][3];

SG290[3][1]=SG270[3][1];
SG290[3][2]=SG270[3][2];
SG290[3][3]=SG270[3][3];


SG300[1][1]=SG270[1][1];
SG300[1][2]=SG270[1][2];
SG300[1][3]=SG270[1][3];

SG300[2][1]=SG270[2][1];
SG300[2][2]=SG270[2][2];
SG300[2][3]=SG270[2][3];

SG300[3][1]=SG270[3][1];
SG300[3][2]=SG270[3][2];
SG300[3][3]=SG270[3][3];


SG310[1][1]=SG270[1][1];
SG310[1][2]=SG270[1][2];
SG310[1][3]=SG270[1][3];

SG310[2][1]=SG270[2][1];
SG310[2][2]=SG270[2][2];
SG310[2][3]=SG270[2][3];

SG310[3][1]=SG270[3][1];
SG310[3][2]=SG270[3][2];
SG310[3][3]=SG270[3][3];


SG320[1][1]=S3227[1][1]*SG270[1][1] + S3227[1][2]*SG270[2][1] + S3227[1][3]*SG270[3][1];
SG320[1][2]=S3227[1][1]*SG270[1][2] + S3227[1][2]*SG270[2][2] + S3227[1][3]*SG270[3][2];
SG320[1][3]=S3227[1][1]*SG270[1][3] + S3227[1][2]*SG270[2][3] + S3227[1][3]*SG270[3][3];

SG320[2][1]=S3227[2][1]*SG270[1][1] + S3227[2][2]*SG270[2][1] + S3227[2][3]*SG270[3][1];
SG320[2][2]=S3227[2][1]*SG270[1][2] + S3227[2][2]*SG270[2][2] + S3227[2][3]*SG270[3][2];
SG320[2][3]=S3227[2][1]*SG270[1][3] + S3227[2][2]*SG270[2][3] + S3227[2][3]*SG270[3][3];

SG320[3][1]=S3227[3][1]*SG270[1][1] + S3227[3][2]*SG270[2][1] + S3227[3][3]*SG270[3][1];
SG320[3][2]=S3227[3][1]*SG270[1][2] + S3227[3][2]*SG270[2][2] + S3227[3][3]*SG270[3][2];
SG320[3][3]=S3227[3][1]*SG270[1][3] + S3227[3][2]*SG270[2][3] + S3227[3][3]*SG270[3][3];


SG330[1][1]=S3321[1][1]*SG210[1][1] + S3321[1][3]*SG210[3][1];
SG330[1][2]=S3321[1][1]*SG210[1][2] + S3321[1][3]*SG210[3][2];
SG330[1][3]=S3321[1][1]*SG210[1][3] + S3321[1][3]*SG210[3][3];

SG330[2][1]=S3321[2][1]*SG210[1][1] + S3321[2][3]*SG210[3][1];
SG330[2][2]=S3321[2][1]*SG210[1][2] + S3321[2][3]*SG210[3][2];
SG330[2][3]=S3321[2][1]*SG210[1][3] + S3321[2][3]*SG210[3][3];

SG330[3][1]=SG210[2][1];
SG330[3][2]=SG210[2][2];
SG330[3][3]=SG210[2][3];


SG340[1][1]=S3433[1][1]*SG330[1][1] + S3433[1][3]*SG330[3][1];
SG340[1][2]=S3433[1][1]*SG330[1][2] + S3433[1][3]*SG330[3][2];
SG340[1][3]=S3433[1][1]*SG330[1][3] + S3433[1][3]*SG330[3][3];

SG340[2][1]=S3433[2][1]*SG330[1][1] + S3433[2][3]*SG330[3][1];
SG340[2][2]=S3433[2][1]*SG330[1][2] + S3433[2][3]*SG330[3][2];
SG340[2][3]=S3433[2][1]*SG330[1][3] + S3433[2][3]*SG330[3][3];

SG340[3][1]=-SG330[2][1];
SG340[3][2]=-SG330[2][2];
SG340[3][3]=-SG330[2][3];


SG350[1][1]=S3534[1][1]*SG340[1][1] + S3534[1][3]*SG340[3][1];
SG350[1][2]=S3534[1][1]*SG340[1][2] + S3534[1][3]*SG340[3][2];
SG350[1][3]=S3534[1][1]*SG340[1][3] + S3534[1][3]*SG340[3][3];

SG350[2][1]=S3534[2][1]*SG340[1][1] + S3534[2][3]*SG340[3][1];
SG350[2][2]=S3534[2][1]*SG340[1][2] + S3534[2][3]*SG340[3][2];
SG350[2][3]=S3534[2][1]*SG340[1][3] + S3534[2][3]*SG340[3][3];

SG350[3][1]=-SG340[2][1];
SG350[3][2]=-SG340[2][2];
SG350[3][3]=-SG340[2][3];


SG360[1][1]=S3635[1][1]*SG350[1][1] + S3635[1][2]*SG350[2][1];
SG360[1][2]=S3635[1][1]*SG350[1][2] + S3635[1][2]*SG350[2][2];
SG360[1][3]=S3635[1][1]*SG350[1][3] + S3635[1][2]*SG350[2][3];

SG360[2][1]=S3635[2][1]*SG350[1][1] + S3635[2][2]*SG350[2][1];
SG360[2][2]=S3635[2][1]*SG350[1][2] + S3635[2][2]*SG350[2][2];
SG360[2][3]=S3635[2][1]*SG350[1][3] + S3635[2][2]*SG350[2][3];

SG360[3][1]=SG350[3][1];
SG360[3][2]=SG350[3][2];
SG360[3][3]=SG350[3][3];


SG370[1][1]=S3736[1][1]*SG360[1][1] + S3736[1][2]*SG360[2][1];
SG370[1][2]=S3736[1][1]*SG360[1][2] + S3736[1][2]*SG360[2][2];
SG370[1][3]=S3736[1][1]*SG360[1][3] + S3736[1][2]*SG360[2][3];

SG370[2][1]=S3736[2][1]*SG360[1][1] + S3736[2][2]*SG360[2][1];
SG370[2][2]=S3736[2][1]*SG360[1][2] + S3736[2][2]*SG360[2][2];
SG370[2][3]=S3736[2][1]*SG360[1][3] + S3736[2][2]*SG360[2][3];

SG370[3][1]=SG360[3][1];
SG370[3][2]=SG360[3][2];
SG370[3][3]=SG360[3][3];


SG380[1][1]=S3837[1][1]*SG370[1][1] + S3837[1][3]*SG370[3][1];
SG380[1][2]=S3837[1][1]*SG370[1][2] + S3837[1][3]*SG370[3][2];
SG380[1][3]=S3837[1][1]*SG370[1][3] + S3837[1][3]*SG370[3][3];

SG380[2][1]=S3837[2][1]*SG370[1][1] + S3837[2][3]*SG370[3][1];
SG380[2][2]=S3837[2][1]*SG370[1][2] + S3837[2][3]*SG370[3][2];
SG380[2][3]=S3837[2][1]*SG370[1][3] + S3837[2][3]*SG370[3][3];

SG380[3][1]=SG370[2][1];
SG380[3][2]=SG370[2][2];
SG380[3][3]=SG370[2][3];


SG390[1][1]=SG380[3][1];
SG390[1][2]=SG380[3][2];
SG390[1][3]=SG380[3][3];

SG390[2][1]=-SG380[2][1];
SG390[2][2]=-SG380[2][2];
SG390[2][3]=-SG380[2][3];

SG390[3][1]=SG380[1][1];
SG390[3][2]=SG380[1][2];
SG390[3][3]=SG380[1][3];


SG400[1][1]=S4039[1][1]*SG390[1][1] + S4039[1][2]*SG390[2][1] + S4039[1][3]*SG390[3][1];
SG400[1][2]=S4039[1][1]*SG390[1][2] + S4039[1][2]*SG390[2][2] + S4039[1][3]*SG390[3][2];
SG400[1][3]=S4039[1][1]*SG390[1][3] + S4039[1][2]*SG390[2][3] + S4039[1][3]*SG390[3][3];

SG400[2][1]=S4039[2][1]*SG390[1][1] + S4039[2][2]*SG390[2][1] + S4039[2][3]*SG390[3][1];
SG400[2][2]=S4039[2][1]*SG390[1][2] + S4039[2][2]*SG390[2][2] + S4039[2][3]*SG390[3][2];
SG400[2][3]=S4039[2][1]*SG390[1][3] + S4039[2][2]*SG390[2][3] + S4039[2][3]*SG390[3][3];

SG400[3][1]=S4039[3][1]*SG390[1][1] + S4039[3][2]*SG390[2][1] + S4039[3][3]*SG390[3][1];
SG400[3][2]=S4039[3][1]*SG390[1][2] + S4039[3][2]*SG390[2][2] + S4039[3][3]*SG390[3][2];
SG400[3][3]=S4039[3][1]*SG390[1][3] + S4039[3][2]*SG390[2][3] + S4039[3][3]*SG390[3][3];


SG410[1][1]=SG380[1][1];
SG410[1][2]=SG380[1][2];
SG410[1][3]=SG380[1][3];

SG410[2][1]=SG380[2][1];
SG410[2][2]=SG380[2][2];
SG410[2][3]=SG380[2][3];

SG410[3][1]=SG380[3][1];
SG410[3][2]=SG380[3][2];
SG410[3][3]=SG380[3][3];


SG420[1][1]=SG380[1][1];
SG420[1][2]=SG380[1][2];
SG420[1][3]=SG380[1][3];

SG420[2][1]=SG380[2][1];
SG420[2][2]=SG380[2][2];
SG420[2][3]=SG380[2][3];

SG420[3][1]=SG380[3][1];
SG420[3][2]=SG380[3][2];
SG420[3][3]=SG380[3][3];


SG430[1][1]=SG380[1][1];
SG430[1][2]=SG380[1][2];
SG430[1][3]=SG380[1][3];

SG430[2][1]=SG380[2][1];
SG430[2][2]=SG380[2][2];
SG430[2][3]=SG380[2][3];

SG430[3][1]=SG380[3][1];
SG430[3][2]=SG380[3][2];
SG430[3][3]=SG380[3][3];


SG440[1][1]=SG380[1][1];
SG440[1][2]=SG380[1][2];
SG440[1][3]=SG380[1][3];

SG440[2][1]=SG380[2][1];
SG440[2][2]=SG380[2][2];
SG440[2][3]=SG380[2][3];

SG440[3][1]=SG380[3][1];
SG440[3][2]=SG380[3][2];
SG440[3][3]=SG380[3][3];


SG450[1][1]=S00[1][1];
SG450[1][2]=S00[1][2];
SG450[1][3]=S00[1][3];

SG450[2][1]=S00[2][1];
SG450[2][2]=S00[2][2];
SG450[2][3]=S00[2][3];

SG450[3][1]=S00[3][1];
SG450[3][2]=S00[3][2];
SG450[3][3]=S00[3][3];


SG460[1][1]=S4645[1][1]*SG450[1][1] + S4645[1][2]*SG450[2][1] + S4645[1][3]*SG450[3][1];
SG460[1][2]=S4645[1][1]*SG450[1][2] + S4645[1][2]*SG450[2][2] + S4645[1][3]*SG450[3][2];
SG460[1][3]=S4645[1][1]*SG450[1][3] + S4645[1][2]*SG450[2][3] + S4645[1][3]*SG450[3][3];

SG460[2][1]=S4645[2][1]*SG450[1][1] + S4645[2][2]*SG450[2][1] + S4645[2][3]*SG450[3][1];
SG460[2][2]=S4645[2][1]*SG450[1][2] + S4645[2][2]*SG450[2][2] + S4645[2][3]*SG450[3][2];
SG460[2][3]=S4645[2][1]*SG450[1][3] + S4645[2][2]*SG450[2][3] + S4645[2][3]*SG450[3][3];

SG460[3][1]=S4645[3][1]*SG450[1][1] + S4645[3][2]*SG450[2][1] + S4645[3][3]*SG450[3][1];
SG460[3][2]=S4645[3][1]*SG450[1][2] + S4645[3][2]*SG450[2][2] + S4645[3][3]*SG450[3][2];
SG460[3][3]=S4645[3][1]*SG450[1][3] + S4645[3][2]*SG450[2][3] + S4645[3][3]*SG450[3][3];




}


void
hoap_InvDynNEfunc4(void)
     {
/* velocity vectors */
v0[1]=baseo[0].ad[1]*S00[1][1] + baseo[0].ad[2]*S00[1][2] + baseo[0].ad[3]*S00[1][3];
v0[2]=baseo[0].ad[1]*S00[2][1] + baseo[0].ad[2]*S00[2][2] + baseo[0].ad[3]*S00[2][3];
v0[3]=baseo[0].ad[1]*S00[3][1] + baseo[0].ad[2]*S00[3][2] + baseo[0].ad[3]*S00[3][3];
v0[4]=basec[0].xd[1]*S00[1][1] + basec[0].xd[2]*S00[1][2] + basec[0].xd[3]*S00[1][3];
v0[5]=basec[0].xd[1]*S00[2][1] + basec[0].xd[2]*S00[2][2] + basec[0].xd[3]*S00[2][3];
v0[6]=basec[0].xd[1]*S00[3][1] + basec[0].xd[2]*S00[3][2] + basec[0].xd[3]*S00[3][3];

v1[1]=v0[1];
v1[2]=v0[2];
v1[3]=v0[3];
v1[4]=BODYLINK1*v0[2] + v0[4];
v1[5]=-(BODYLINK1*v0[1]) + v0[5];
v1[6]=v0[6];

v2[1]=v1[1]*S21[1][1] + v1[3]*S21[1][3];
v2[2]=v1[1]*S21[2][1] + v1[3]*S21[2][3];
v2[3]=state[7].thd + v1[2];
v2[4]=ARMLINK1*v1[3]*S21[1][1] + v1[4]*S21[1][1] - ARMLINK1*v1[1]*S21[1][3] + v1[6]*S21[1][3];
v2[5]=ARMLINK1*v1[3]*S21[2][1] + v1[4]*S21[2][1] - ARMLINK1*v1[1]*S21[2][3] + v1[6]*S21[2][3];
v2[6]=v1[5];

v3[1]=v2[1]*S32[1][1] + v2[3]*S32[1][3];
v3[2]=v2[1]*S32[2][1] + v2[3]*S32[2][3];
v3[3]=state[8].thd - v2[2];
v3[4]=v2[4]*S32[1][1] + v2[6]*S32[1][3];
v3[5]=v2[4]*S32[2][1] + v2[6]*S32[2][3];
v3[6]=-v2[5];

v4[1]=v3[1]*S43[1][1] + v3[3]*S43[1][3];
v4[2]=v3[1]*S43[2][1] + v3[3]*S43[2][3];
v4[3]=state[9].thd - v3[2];
v4[4]=ARMLINK2*v3[3]*S43[1][1] + v3[4]*S43[1][1] - ARMLINK2*v3[1]*S43[1][3] + v3[6]*S43[1][3];
v4[5]=ARMLINK2*v3[3]*S43[2][1] + v3[4]*S43[2][1] - ARMLINK2*v3[1]*S43[2][3] + v3[6]*S43[2][3];
v4[6]=-v3[5];

v5[1]=v4[1]*S54[1][1] + v4[3]*S54[1][3];
v5[2]=v4[1]*S54[2][1] + v4[3]*S54[2][3];
v5[3]=state[10].thd - v4[2];
v5[4]=v4[4]*S54[1][1] + v4[6]*S54[1][3];
v5[5]=v4[4]*S54[2][1] + v4[6]*S54[2][3];
v5[6]=-v4[5];

v6[1]=v5[3];
v6[2]=v5[1];
v6[3]=v5[2];
v6[4]=ARMLINK3*v5[1] + v5[6];
v6[5]=-(ARMLINK3*v5[3]) + v5[4];
v6[6]=v5[5];

v7[1]=v6[2];
v7[2]=v6[3];
v7[3]=v6[1];
v7[4]=-(GRIPJOFFZ*v6[1]) + GRIPJOFFX*v6[3] + v6[5];
v7[5]=-(GRIPJOFFX*v6[2]) + v6[6];
v7[6]=GRIPJOFFZ*v6[2] + v6[4];

v8[1]=v7[1];
v8[2]=v7[2];
v8[3]=v7[3];
v8[4]=v7[4];
v8[5]=FINGER*v7[3] + v7[5];
v8[6]=-(FINGER*v7[2]) + v7[6];

v9[1]=v1[1]*S91[1][1] + v1[3]*S91[1][3];
v9[2]=v1[1]*S91[2][1] + v1[3]*S91[2][3];
v9[3]=state[17].thd + v1[2];
v9[4]=-(ARMLINK1*v1[3]*S91[1][1]) + v1[4]*S91[1][1] + ARMLINK1*v1[1]*S91[1][3] + v1[6]*S91[1][3];
v9[5]=-(ARMLINK1*v1[3]*S91[2][1]) + v1[4]*S91[2][1] + ARMLINK1*v1[1]*S91[2][3] + v1[6]*S91[2][3];
v9[6]=v1[5];

v10[1]=v9[1]*S109[1][1] + v9[3]*S109[1][3];
v10[2]=v9[1]*S109[2][1] + v9[3]*S109[2][3];
v10[3]=state[18].thd - v9[2];
v10[4]=v9[4]*S109[1][1] + v9[6]*S109[1][3];
v10[5]=v9[4]*S109[2][1] + v9[6]*S109[2][3];
v10[6]=-v9[5];

v11[1]=v10[1]*S1110[1][1] + v10[3]*S1110[1][3];
v11[2]=v10[1]*S1110[2][1] + v10[3]*S1110[2][3];
v11[3]=state[19].thd - v10[2];
v11[4]=ARMLINK2*v10[3]*S1110[1][1] + v10[4]*S1110[1][1] - ARMLINK2*v10[1]*S1110[1][3] + v10[6]*S1110[1][3];
v11[5]=ARMLINK2*v10[3]*S1110[2][1] + v10[4]*S1110[2][1] - ARMLINK2*v10[1]*S1110[2][3] + v10[6]*S1110[2][3];
v11[6]=-v10[5];

v12[1]=v11[1]*S1211[1][1] + v11[3]*S1211[1][3];
v12[2]=v11[1]*S1211[2][1] + v11[3]*S1211[2][3];
v12[3]=state[20].thd - v11[2];
v12[4]=v11[4]*S1211[1][1] + v11[6]*S1211[1][3];
v12[5]=v11[4]*S1211[2][1] + v11[6]*S1211[2][3];
v12[6]=-v11[5];

v13[1]=v12[1]*S1312[1][1] + v12[3]*S1312[1][3];
v13[2]=v12[1]*S1312[2][1] + v12[3]*S1312[2][3];
v13[3]=state[27].thd + v12[2];
v13[4]=-(ARMLINK3*v12[3]*S1312[1][1]) + v12[4]*S1312[1][1] + ARMLINK3*v12[1]*S1312[1][3] + v12[6]*S1312[1][3];
v13[5]=-(ARMLINK3*v12[3]*S1312[2][1]) + v12[4]*S1312[2][1] + ARMLINK3*v12[1]*S1312[2][3] + v12[6]*S1312[2][3];
v13[6]=v12[5];

v14[1]=v13[2]*S1413[1][2] + v13[3]*S1413[1][3];
v14[2]=v13[2]*S1413[2][2] + v13[3]*S1413[2][3];
v14[3]=state[28].thd + v13[1];
v14[4]=-(GRIPJOFFZ*v13[1]*S1413[1][2]) - GRIPJOFFX*v13[3]*S1413[1][2] + v13[5]*S1413[1][2] + GRIPJOFFX*v13[2]*S1413[1][3] + v13[6]*S1413[1][3];
v14[5]=-(GRIPJOFFZ*v13[1]*S1413[2][2]) - GRIPJOFFX*v13[3]*S1413[2][2] + v13[5]*S1413[2][2] + GRIPJOFFX*v13[2]*S1413[2][3] + v13[6]*S1413[2][3];
v14[6]=GRIPJOFFZ*v13[2] + v13[4];

v15[1]=v14[1];
v15[2]=v14[2];
v15[3]=v14[3];
v15[4]=v14[4];
v15[5]=FINGER*v14[3] + v14[5];
v15[6]=-(FINGER*v14[2]) + v14[6];

v16[1]=v13[1];
v16[2]=v13[2];
v16[3]=v13[3];
v16[4]=PALM*v13[2] + v13[4];
v16[5]=-(PALM*v13[1]) - PALMOFFSETX*v13[3] + v13[5];
v16[6]=PALMOFFSETX*v13[2] + v13[6];

v17[1]=v16[1]*S1716[1][1] + v16[2]*S1716[1][2] + v16[3]*S1716[1][3];
v17[2]=v16[1]*S1716[2][1] + v16[2]*S1716[2][2] + v16[3]*S1716[2][3];
v17[3]=v16[1]*S1716[3][1] + v16[2]*S1716[3][2] + v16[3]*S1716[3][3];
v17[4]=v16[4]*S1716[1][1] + v16[5]*S1716[1][2] + v16[3]*(-(eff[4].x[2]*S1716[1][1]) + eff[4].x[1]*S1716[1][2]) + v16[6]*S1716[1][3] + v16[2]*(eff[4].x[3]*S1716[1][1] - eff[4].x[1]*S1716[1][3]) + v16[1]*(-(eff[4].x[3]*S1716[1][2]) + eff[4].x[2]*S1716[1][3]);
v17[5]=v16[4]*S1716[2][1] + v16[5]*S1716[2][2] + v16[3]*(-(eff[4].x[2]*S1716[2][1]) + eff[4].x[1]*S1716[2][2]) + v16[6]*S1716[2][3] + v16[2]*(eff[4].x[3]*S1716[2][1] - eff[4].x[1]*S1716[2][3]) + v16[1]*(-(eff[4].x[3]*S1716[2][2]) + eff[4].x[2]*S1716[2][3]);
v17[6]=v16[4]*S1716[3][1] + v16[5]*S1716[3][2] + v16[3]*(-(eff[4].x[2]*S1716[3][1]) + eff[4].x[1]*S1716[3][2]) + v16[6]*S1716[3][3] + v16[2]*(eff[4].x[3]*S1716[3][1] - eff[4].x[1]*S1716[3][3]) + v16[1]*(-(eff[4].x[3]*S1716[3][2]) + eff[4].x[2]*S1716[3][3]);

v18[1]=v1[1]*S181[1][1] + v1[2]*S181[1][2];
v18[2]=v1[1]*S181[2][1] + v1[2]*S181[2][2];
v18[3]=state[22].thd + v1[3];
v18[4]=v1[4]*S181[1][1] + v1[5]*S181[1][2];
v18[5]=v1[4]*S181[2][1] + v1[5]*S181[2][2];
v18[6]=v1[6];

v19[1]=v18[1];
v19[2]=-v18[3];
v19[3]=v18[2];
v19[4]=HEADLINK1*v18[2] + v18[4];
v19[5]=HEADLINK2*v18[2] - v18[6];
v19[6]=-(HEADLINK1*v18[1]) + HEADLINK2*v18[3] + v18[5];

v20[1]=v19[1]*S2019[1][1] + v19[3]*S2019[1][3];
v20[2]=v19[1]*S2019[2][1] + v19[3]*S2019[2][3];
v20[3]=state[24].thd - v19[2];
v20[4]=v19[4]*S2019[1][1] + v19[6]*S2019[1][3];
v20[5]=v19[4]*S2019[2][1] + v19[6]*S2019[2][3];
v20[6]=-v19[5];

v21[1]=v0[1]*S210[1][1] + v0[3]*S210[1][3];
v21[2]=v0[1]*S210[2][1] + v0[3]*S210[2][3];
v21[3]=state[21].thd - v0[2];
v21[4]=v0[4]*S210[1][1] - BODYLINK2*v0[2]*S210[1][3] + v0[6]*S210[1][3];
v21[5]=v0[4]*S210[2][1] - BODYLINK2*v0[2]*S210[2][3] + v0[6]*S210[2][3];
v21[6]=-(BODYLINK2*v0[3]) - v0[5];

v22[1]=v21[1]*S2221[1][1] + v21[3]*S2221[1][3];
v22[2]=v21[1]*S2221[2][1] + v21[3]*S2221[2][3];
v22[3]=state[1].thd + v21[2];
v22[4]=WAISTLINK1*v21[3]*S2221[1][1] + v21[4]*S2221[1][1] - WAISTLINK1*v21[1]*S2221[1][3] + v21[6]*S2221[1][3] + v21[2]*(LEGLINK1*S2221[1][1] + WAISTLINK2*S2221[1][3]);
v22[5]=WAISTLINK1*v21[3]*S2221[2][1] + v21[4]*S2221[2][1] - WAISTLINK1*v21[1]*S2221[2][3] + v21[6]*S2221[2][3] + v21[2]*(LEGLINK1*S2221[2][1] + WAISTLINK2*S2221[2][3]);
v22[6]=-(LEGLINK1*v21[1]) - WAISTLINK2*v21[3] + v21[5];

v23[1]=v22[1]*S2322[1][1] + v22[3]*S2322[1][3];
v23[2]=v22[1]*S2322[2][1] + v22[3]*S2322[2][3];
v23[3]=state[2].thd - v22[2];
v23[4]=v22[4]*S2322[1][1] + v22[6]*S2322[1][3];
v23[5]=v22[4]*S2322[2][1] + v22[6]*S2322[2][3];
v23[6]=-v22[5];

v24[1]=v23[1]*S2423[1][1] + v23[3]*S2423[1][3];
v24[2]=v23[1]*S2423[2][1] + v23[3]*S2423[2][3];
v24[3]=state[3].thd - v23[2];
v24[4]=v23[4]*S2423[1][1] + v23[6]*S2423[1][3];
v24[5]=v23[4]*S2423[2][1] + v23[6]*S2423[2][3];
v24[6]=-v23[5];

v25[1]=v24[1]*S2524[1][1] + v24[2]*S2524[1][2];
v25[2]=v24[1]*S2524[2][1] + v24[2]*S2524[2][2];
v25[3]=state[4].thd + v24[3];
v25[4]=v24[4]*S2524[1][1] - LEGLINK2*v24[3]*S2524[1][2] + v24[5]*S2524[1][2];
v25[5]=v24[4]*S2524[2][1] - LEGLINK2*v24[3]*S2524[2][2] + v24[5]*S2524[2][2];
v25[6]=LEGLINK2*v24[2] + v24[6];

v26[1]=v25[1]*S2625[1][1] + v25[2]*S2625[1][2];
v26[2]=v25[1]*S2625[2][1] + v25[2]*S2625[2][2];
v26[3]=state[5].thd + v25[3];
v26[4]=v25[4]*S2625[1][1] - LEGLINK3*v25[3]*S2625[1][2] + v25[5]*S2625[1][2];
v26[5]=v25[4]*S2625[2][1] - LEGLINK3*v25[3]*S2625[2][2] + v25[5]*S2625[2][2];
v26[6]=LEGLINK3*v25[2] + v25[6];

v27[1]=v26[1]*S2726[1][1] + v26[3]*S2726[1][3];
v27[2]=v26[1]*S2726[2][1] + v26[3]*S2726[2][3];
v27[3]=state[6].thd + v26[2];
v27[4]=v26[4]*S2726[1][1] + v26[6]*S2726[1][3];
v27[5]=v26[4]*S2726[2][1] + v26[6]*S2726[2][3];
v27[6]=v26[5];

v28[1]=v27[1];
v28[2]=v27[2];
v28[3]=v27[3];
v28[4]=FOOTWIDLONG*v27[2] - FOOTLLENGLONG*v27[3] + v27[4];
v28[5]=-(FOOTWIDLONG*v27[1]) - LEGLINK4*v27[3] + v27[5];
v28[6]=FOOTLLENGLONG*v27[1] + LEGLINK4*v27[2] + v27[6];

v29[1]=v27[1];
v29[2]=v27[2];
v29[3]=v27[3];
v29[4]=-(FOOTWIDSHORT*v27[2]) - FOOTLLENGLONG*v27[3] + v27[4];
v29[5]=FOOTWIDSHORT*v27[1] - LEGLINK4*v27[3] + v27[5];
v29[6]=FOOTLLENGLONG*v27[1] + LEGLINK4*v27[2] + v27[6];

v30[1]=v27[1];
v30[2]=v27[2];
v30[3]=v27[3];
v30[4]=-(FOOTWIDSHORT*v27[2]) + FOOTLENGSHORT*v27[3] + v27[4];
v30[5]=FOOTWIDSHORT*v27[1] - LEGLINK4*v27[3] + v27[5];
v30[6]=-(FOOTLENGSHORT*v27[1]) + LEGLINK4*v27[2] + v27[6];

v31[1]=v27[1];
v31[2]=v27[2];
v31[3]=v27[3];
v31[4]=FOOTWIDLONG*v27[2] + FOOTLENGSHORT*v27[3] + v27[4];
v31[5]=-(FOOTWIDLONG*v27[1]) - LEGLINK4*v27[3] + v27[5];
v31[6]=-(FOOTLENGSHORT*v27[1]) + LEGLINK4*v27[2] + v27[6];

v32[1]=v27[1]*S3227[1][1] + v27[2]*S3227[1][2] + v27[3]*S3227[1][3];
v32[2]=v27[1]*S3227[2][1] + v27[2]*S3227[2][2] + v27[3]*S3227[2][3];
v32[3]=v27[1]*S3227[3][1] + v27[2]*S3227[3][2] + v27[3]*S3227[3][3];
v32[4]=v27[4]*S3227[1][1] + v27[5]*S3227[1][2] + v27[3]*(-(eff[1].x[2]*S3227[1][1]) + eff[1].x[1]*S3227[1][2]) + v27[6]*S3227[1][3] + v27[2]*(eff[1].x[3]*S3227[1][1] - eff[1].x[1]*S3227[1][3]) + v27[1]*(-(eff[1].x[3]*S3227[1][2]) + eff[1].x[2]*S3227[1][3]);
v32[5]=v27[4]*S3227[2][1] + v27[5]*S3227[2][2] + v27[3]*(-(eff[1].x[2]*S3227[2][1]) + eff[1].x[1]*S3227[2][2]) + v27[6]*S3227[2][3] + v27[2]*(eff[1].x[3]*S3227[2][1] - eff[1].x[1]*S3227[2][3]) + v27[1]*(-(eff[1].x[3]*S3227[2][2]) + eff[1].x[2]*S3227[2][3]);
v32[6]=v27[4]*S3227[3][1] + v27[5]*S3227[3][2] + v27[3]*(-(eff[1].x[2]*S3227[3][1]) + eff[1].x[1]*S3227[3][2]) + v27[6]*S3227[3][3] + v27[2]*(eff[1].x[3]*S3227[3][1] - eff[1].x[1]*S3227[3][3]) + v27[1]*(-(eff[1].x[3]*S3227[3][2]) + eff[1].x[2]*S3227[3][3]);

v33[1]=v21[1]*S3321[1][1] + v21[3]*S3321[1][3];
v33[2]=v21[1]*S3321[2][1] + v21[3]*S3321[2][3];
v33[3]=state[11].thd + v21[2];
v33[4]=WAISTLINK1*v21[3]*S3321[1][1] + v21[4]*S3321[1][1] - WAISTLINK1*v21[1]*S3321[1][3] + v21[6]*S3321[1][3] + v21[2]*(-(LEGLINK1*S3321[1][1]) + WAISTLINK2*S3321[1][3]);
v33[5]=WAISTLINK1*v21[3]*S3321[2][1] + v21[4]*S3321[2][1] - WAISTLINK1*v21[1]*S3321[2][3] + v21[6]*S3321[2][3] + v21[2]*(-(LEGLINK1*S3321[2][1]) + WAISTLINK2*S3321[2][3]);
v33[6]=LEGLINK1*v21[1] - WAISTLINK2*v21[3] + v21[5];

v34[1]=v33[1]*S3433[1][1] + v33[3]*S3433[1][3];
v34[2]=v33[1]*S3433[2][1] + v33[3]*S3433[2][3];
v34[3]=state[12].thd - v33[2];
v34[4]=v33[4]*S3433[1][1] + v33[6]*S3433[1][3];
v34[5]=v33[4]*S3433[2][1] + v33[6]*S3433[2][3];
v34[6]=-v33[5];

v35[1]=v34[1]*S3534[1][1] + v34[3]*S3534[1][3];
v35[2]=v34[1]*S3534[2][1] + v34[3]*S3534[2][3];
v35[3]=state[13].thd - v34[2];
v35[4]=v34[4]*S3534[1][1] + v34[6]*S3534[1][3];
v35[5]=v34[4]*S3534[2][1] + v34[6]*S3534[2][3];
v35[6]=-v34[5];

v36[1]=v35[1]*S3635[1][1] + v35[2]*S3635[1][2];
v36[2]=v35[1]*S3635[2][1] + v35[2]*S3635[2][2];
v36[3]=state[14].thd + v35[3];
v36[4]=v35[4]*S3635[1][1] - LEGLINK2*v35[3]*S3635[1][2] + v35[5]*S3635[1][2];
v36[5]=v35[4]*S3635[2][1] - LEGLINK2*v35[3]*S3635[2][2] + v35[5]*S3635[2][2];
v36[6]=LEGLINK2*v35[2] + v35[6];

v37[1]=v36[1]*S3736[1][1] + v36[2]*S3736[1][2];
v37[2]=v36[1]*S3736[2][1] + v36[2]*S3736[2][2];
v37[3]=state[15].thd + v36[3];
v37[4]=v36[4]*S3736[1][1] - LEGLINK3*v36[3]*S3736[1][2] + v36[5]*S3736[1][2];
v37[5]=v36[4]*S3736[2][1] - LEGLINK3*v36[3]*S3736[2][2] + v36[5]*S3736[2][2];
v37[6]=LEGLINK3*v36[2] + v36[6];

v38[1]=v37[1]*S3837[1][1] + v37[3]*S3837[1][3];
v38[2]=v37[1]*S3837[2][1] + v37[3]*S3837[2][3];
v38[3]=state[16].thd + v37[2];
v38[4]=v37[4]*S3837[1][1] + v37[6]*S3837[1][3];
v38[5]=v37[4]*S3837[2][1] + v37[6]*S3837[2][3];
v38[6]=v37[5];

v39[1]=v38[3];
v39[2]=-v38[2];
v39[3]=v38[1];
v39[4]=LEGLINK4*v38[2] + v38[6];
v39[5]=LEGLINK4*v38[3] - v38[5];
v39[6]=v38[4];

v40[1]=v39[1]*S4039[1][1] + v39[2]*S4039[1][2] + v39[3]*S4039[1][3];
v40[2]=v39[1]*S4039[2][1] + v39[2]*S4039[2][2] + v39[3]*S4039[2][3];
v40[3]=v39[1]*S4039[3][1] + v39[2]*S4039[3][2] + v39[3]*S4039[3][3];
v40[4]=v39[4]*S4039[1][1] + v39[5]*S4039[1][2] + v39[3]*(-(eff[3].x[2]*S4039[1][1]) + eff[3].x[1]*S4039[1][2]) + v39[6]*S4039[1][3] + v39[2]*(eff[3].x[3]*S4039[1][1] - eff[3].x[1]*S4039[1][3]) + v39[1]*(-(eff[3].x[3]*S4039[1][2]) + eff[3].x[2]*S4039[1][3]);
v40[5]=v39[4]*S4039[2][1] + v39[5]*S4039[2][2] + v39[3]*(-(eff[3].x[2]*S4039[2][1]) + eff[3].x[1]*S4039[2][2]) + v39[6]*S4039[2][3] + v39[2]*(eff[3].x[3]*S4039[2][1] - eff[3].x[1]*S4039[2][3]) + v39[1]*(-(eff[3].x[3]*S4039[2][2]) + eff[3].x[2]*S4039[2][3]);
v40[6]=v39[4]*S4039[3][1] + v39[5]*S4039[3][2] + v39[3]*(-(eff[3].x[2]*S4039[3][1]) + eff[3].x[1]*S4039[3][2]) + v39[6]*S4039[3][3] + v39[2]*(eff[3].x[3]*S4039[3][1] - eff[3].x[1]*S4039[3][3]) + v39[1]*(-(eff[3].x[3]*S4039[3][2]) + eff[3].x[2]*S4039[3][3]);

v41[1]=v38[1];
v41[2]=v38[2];
v41[3]=v38[3];
v41[4]=-(LEGLINK4*v38[2]) - FOOTWIDLONG*v38[3] + v38[4];
v41[5]=LEGLINK4*v38[1] + FOOTLLENGLONG*v38[3] + v38[5];
v41[6]=FOOTWIDLONG*v38[1] - FOOTLLENGLONG*v38[2] + v38[6];

v42[1]=v38[1];
v42[2]=v38[2];
v42[3]=v38[3];
v42[4]=-(LEGLINK4*v38[2]) + FOOTWIDSHORT*v38[3] + v38[4];
v42[5]=LEGLINK4*v38[1] + FOOTLLENGLONG*v38[3] + v38[5];
v42[6]=-(FOOTWIDSHORT*v38[1]) - FOOTLLENGLONG*v38[2] + v38[6];

v43[1]=v38[1];
v43[2]=v38[2];
v43[3]=v38[3];
v43[4]=-(LEGLINK4*v38[2]) + FOOTWIDSHORT*v38[3] + v38[4];
v43[5]=LEGLINK4*v38[1] - FOOTLENGSHORT*v38[3] + v38[5];
v43[6]=-(FOOTWIDSHORT*v38[1]) + FOOTLENGSHORT*v38[2] + v38[6];

v44[1]=v38[1];
v44[2]=v38[2];
v44[3]=v38[3];
v44[4]=-(LEGLINK4*v38[2]) - FOOTWIDLONG*v38[3] + v38[4];
v44[5]=LEGLINK4*v38[1] - FOOTLENGSHORT*v38[3] + v38[5];
v44[6]=FOOTWIDLONG*v38[1] + FOOTLENGSHORT*v38[2] + v38[6];

v45[1]=v0[1];
v45[2]=v0[2];
v45[3]=v0[3];
v45[4]=PALM*v0[2] + v0[4];
v45[5]=-(PALM*v0[1]) - PALMOFFSETX*v0[3] + v0[5];
v45[6]=PALMOFFSETX*v0[2] + v0[6];

v46[1]=v45[1]*S4645[1][1] + v45[2]*S4645[1][2] + v45[3]*S4645[1][3];
v46[2]=v45[1]*S4645[2][1] + v45[2]*S4645[2][2] + v45[3]*S4645[2][3];
v46[3]=v45[1]*S4645[3][1] + v45[2]*S4645[3][2] + v45[3]*S4645[3][3];
v46[4]=v45[4]*S4645[1][1] + v45[5]*S4645[1][2] + v45[3]*(-(eff[2].x[2]*S4645[1][1]) + eff[2].x[1]*S4645[1][2]) + v45[6]*S4645[1][3] + v45[2]*(eff[2].x[3]*S4645[1][1] - eff[2].x[1]*S4645[1][3]) + v45[1]*(-(eff[2].x[3]*S4645[1][2]) + eff[2].x[2]*S4645[1][3]);
v46[5]=v45[4]*S4645[2][1] + v45[5]*S4645[2][2] + v45[3]*(-(eff[2].x[2]*S4645[2][1]) + eff[2].x[1]*S4645[2][2]) + v45[6]*S4645[2][3] + v45[2]*(eff[2].x[3]*S4645[2][1] - eff[2].x[1]*S4645[2][3]) + v45[1]*(-(eff[2].x[3]*S4645[2][2]) + eff[2].x[2]*S4645[2][3]);
v46[6]=v45[4]*S4645[3][1] + v45[5]*S4645[3][2] + v45[3]*(-(eff[2].x[2]*S4645[3][1]) + eff[2].x[1]*S4645[3][2]) + v45[6]*S4645[3][3] + v45[2]*(eff[2].x[3]*S4645[3][1] - eff[2].x[1]*S4645[3][3]) + v45[1]*(-(eff[2].x[3]*S4645[3][2]) + eff[2].x[2]*S4645[3][3]);



}


void
hoap_InvDynNEfunc5(void)
     {
/* acceleration vectors */
a0[1]=baseo[0].add[1]*S00[1][1] + baseo[0].add[2]*S00[1][2] + baseo[0].add[3]*S00[1][3];
a0[2]=baseo[0].add[1]*S00[2][1] + baseo[0].add[2]*S00[2][2] + baseo[0].add[3]*S00[2][3];
a0[3]=baseo[0].add[1]*S00[3][1] + baseo[0].add[2]*S00[3][2] + baseo[0].add[3]*S00[3][3];
a0[4]=basec[0].xdd[1]*S00[1][1] + basec[0].xdd[2]*S00[1][2] + (gravity + basec[0].xdd[3])*S00[1][3];
a0[5]=basec[0].xdd[1]*S00[2][1] + basec[0].xdd[2]*S00[2][2] + (gravity + basec[0].xdd[3])*S00[2][3];
a0[6]=basec[0].xdd[1]*S00[3][1] + basec[0].xdd[2]*S00[3][2] + (gravity + basec[0].xdd[3])*S00[3][3];

a1[1]=a0[1];
a1[2]=a0[2];
a1[3]=a0[3];
a1[4]=BODYLINK1*a0[2] + a0[4];
a1[5]=-(BODYLINK1*a0[1]) + a0[5];
a1[6]=a0[6];

a2[1]=state[7].thd*v2[2] + a1[1]*S21[1][1] + a1[3]*S21[1][3];
a2[2]=-(state[7].thd*v2[1]) + a1[1]*S21[2][1] + a1[3]*S21[2][3];
a2[3]=state[7].thdd + a1[2];
a2[4]=state[7].thd*v2[5] + ARMLINK1*a1[3]*S21[1][1] + a1[4]*S21[1][1] - ARMLINK1*a1[1]*S21[1][3] + a1[6]*S21[1][3];
a2[5]=-(state[7].thd*v2[4]) + ARMLINK1*a1[3]*S21[2][1] + a1[4]*S21[2][1] - ARMLINK1*a1[1]*S21[2][3] + a1[6]*S21[2][3];
a2[6]=a1[5];

a3[1]=state[8].thd*v3[2] + a2[1]*S32[1][1] + a2[3]*S32[1][3];
a3[2]=-(state[8].thd*v3[1]) + a2[1]*S32[2][1] + a2[3]*S32[2][3];
a3[3]=state[8].thdd - a2[2];
a3[4]=state[8].thd*v3[5] + a2[4]*S32[1][1] + a2[6]*S32[1][3];
a3[5]=-(state[8].thd*v3[4]) + a2[4]*S32[2][1] + a2[6]*S32[2][3];
a3[6]=-a2[5];

a4[1]=state[9].thd*v4[2] + a3[1]*S43[1][1] + a3[3]*S43[1][3];
a4[2]=-(state[9].thd*v4[1]) + a3[1]*S43[2][1] + a3[3]*S43[2][3];
a4[3]=state[9].thdd - a3[2];
a4[4]=state[9].thd*v4[5] + ARMLINK2*a3[3]*S43[1][1] + a3[4]*S43[1][1] - ARMLINK2*a3[1]*S43[1][3] + a3[6]*S43[1][3];
a4[5]=-(state[9].thd*v4[4]) + ARMLINK2*a3[3]*S43[2][1] + a3[4]*S43[2][1] - ARMLINK2*a3[1]*S43[2][3] + a3[6]*S43[2][3];
a4[6]=-a3[5];

a5[1]=state[10].thd*v5[2] + a4[1]*S54[1][1] + a4[3]*S54[1][3];
a5[2]=-(state[10].thd*v5[1]) + a4[1]*S54[2][1] + a4[3]*S54[2][3];
a5[3]=state[10].thdd - a4[2];
a5[4]=state[10].thd*v5[5] + a4[4]*S54[1][1] + a4[6]*S54[1][3];
a5[5]=-(state[10].thd*v5[4]) + a4[4]*S54[2][1] + a4[6]*S54[2][3];
a5[6]=-a4[5];

a6[1]=a5[3];
a6[2]=a5[1];
a6[3]=a5[2];
a6[4]=ARMLINK3*a5[1] + a5[6];
a6[5]=-(ARMLINK3*a5[3]) + a5[4];
a6[6]=a5[5];

a7[1]=a6[2];
a7[2]=a6[3];
a7[3]=a6[1];
a7[4]=-(GRIPJOFFZ*a6[1]) + GRIPJOFFX*a6[3] + a6[5];
a7[5]=-(GRIPJOFFX*a6[2]) + a6[6];
a7[6]=GRIPJOFFZ*a6[2] + a6[4];

a8[1]=a7[1];
a8[2]=a7[2];
a8[3]=a7[3];
a8[4]=a7[4];
a8[5]=FINGER*a7[3] + a7[5];
a8[6]=-(FINGER*a7[2]) + a7[6];

a9[1]=state[17].thd*v9[2] + a1[1]*S91[1][1] + a1[3]*S91[1][3];
a9[2]=-(state[17].thd*v9[1]) + a1[1]*S91[2][1] + a1[3]*S91[2][3];
a9[3]=state[17].thdd + a1[2];
a9[4]=state[17].thd*v9[5] - ARMLINK1*a1[3]*S91[1][1] + a1[4]*S91[1][1] + ARMLINK1*a1[1]*S91[1][3] + a1[6]*S91[1][3];
a9[5]=-(state[17].thd*v9[4]) - ARMLINK1*a1[3]*S91[2][1] + a1[4]*S91[2][1] + ARMLINK1*a1[1]*S91[2][3] + a1[6]*S91[2][3];
a9[6]=a1[5];

a10[1]=state[18].thd*v10[2] + a9[1]*S109[1][1] + a9[3]*S109[1][3];
a10[2]=-(state[18].thd*v10[1]) + a9[1]*S109[2][1] + a9[3]*S109[2][3];
a10[3]=state[18].thdd - a9[2];
a10[4]=state[18].thd*v10[5] + a9[4]*S109[1][1] + a9[6]*S109[1][3];
a10[5]=-(state[18].thd*v10[4]) + a9[4]*S109[2][1] + a9[6]*S109[2][3];
a10[6]=-a9[5];

a11[1]=state[19].thd*v11[2] + a10[1]*S1110[1][1] + a10[3]*S1110[1][3];
a11[2]=-(state[19].thd*v11[1]) + a10[1]*S1110[2][1] + a10[3]*S1110[2][3];
a11[3]=state[19].thdd - a10[2];
a11[4]=state[19].thd*v11[5] + ARMLINK2*a10[3]*S1110[1][1] + a10[4]*S1110[1][1] - ARMLINK2*a10[1]*S1110[1][3] + a10[6]*S1110[1][3];
a11[5]=-(state[19].thd*v11[4]) + ARMLINK2*a10[3]*S1110[2][1] + a10[4]*S1110[2][1] - ARMLINK2*a10[1]*S1110[2][3] + a10[6]*S1110[2][3];
a11[6]=-a10[5];

a12[1]=state[20].thd*v12[2] + a11[1]*S1211[1][1] + a11[3]*S1211[1][3];
a12[2]=-(state[20].thd*v12[1]) + a11[1]*S1211[2][1] + a11[3]*S1211[2][3];
a12[3]=state[20].thdd - a11[2];
a12[4]=state[20].thd*v12[5] + a11[4]*S1211[1][1] + a11[6]*S1211[1][3];
a12[5]=-(state[20].thd*v12[4]) + a11[4]*S1211[2][1] + a11[6]*S1211[2][3];
a12[6]=-a11[5];

a13[1]=state[27].thd*v13[2] + a12[1]*S1312[1][1] + a12[3]*S1312[1][3];
a13[2]=-(state[27].thd*v13[1]) + a12[1]*S1312[2][1] + a12[3]*S1312[2][3];
a13[3]=state[27].thdd + a12[2];
a13[4]=state[27].thd*v13[5] - ARMLINK3*a12[3]*S1312[1][1] + a12[4]*S1312[1][1] + ARMLINK3*a12[1]*S1312[1][3] + a12[6]*S1312[1][3];
a13[5]=-(state[27].thd*v13[4]) - ARMLINK3*a12[3]*S1312[2][1] + a12[4]*S1312[2][1] + ARMLINK3*a12[1]*S1312[2][3] + a12[6]*S1312[2][3];
a13[6]=a12[5];

a14[1]=state[28].thd*v14[2] + a13[2]*S1413[1][2] + a13[3]*S1413[1][3];
a14[2]=-(state[28].thd*v14[1]) + a13[2]*S1413[2][2] + a13[3]*S1413[2][3];
a14[3]=state[28].thdd + a13[1];
a14[4]=state[28].thd*v14[5] - GRIPJOFFZ*a13[1]*S1413[1][2] - GRIPJOFFX*a13[3]*S1413[1][2] + a13[5]*S1413[1][2] + GRIPJOFFX*a13[2]*S1413[1][3] + a13[6]*S1413[1][3];
a14[5]=-(state[28].thd*v14[4]) - GRIPJOFFZ*a13[1]*S1413[2][2] - GRIPJOFFX*a13[3]*S1413[2][2] + a13[5]*S1413[2][2] + GRIPJOFFX*a13[2]*S1413[2][3] + a13[6]*S1413[2][3];
a14[6]=GRIPJOFFZ*a13[2] + a13[4];

a15[1]=a14[1];
a15[2]=a14[2];
a15[3]=a14[3];
a15[4]=a14[4];
a15[5]=FINGER*a14[3] + a14[5];
a15[6]=-(FINGER*a14[2]) + a14[6];

a16[1]=a13[1];
a16[2]=a13[2];
a16[3]=a13[3];
a16[4]=PALM*a13[2] + a13[4];
a16[5]=-(PALM*a13[1]) - PALMOFFSETX*a13[3] + a13[5];
a16[6]=PALMOFFSETX*a13[2] + a13[6];

a17[1]=a16[1]*S1716[1][1] + a16[2]*S1716[1][2] + a16[3]*S1716[1][3];
a17[2]=a16[1]*S1716[2][1] + a16[2]*S1716[2][2] + a16[3]*S1716[2][3];
a17[3]=a16[1]*S1716[3][1] + a16[2]*S1716[3][2] + a16[3]*S1716[3][3];
a17[4]=a16[4]*S1716[1][1] + a16[5]*S1716[1][2] + a16[3]*(-(eff[4].x[2]*S1716[1][1]) + eff[4].x[1]*S1716[1][2]) + a16[6]*S1716[1][3] + a16[2]*(eff[4].x[3]*S1716[1][1] - eff[4].x[1]*S1716[1][3]) + a16[1]*(-(eff[4].x[3]*S1716[1][2]) + eff[4].x[2]*S1716[1][3]);
a17[5]=a16[4]*S1716[2][1] + a16[5]*S1716[2][2] + a16[3]*(-(eff[4].x[2]*S1716[2][1]) + eff[4].x[1]*S1716[2][2]) + a16[6]*S1716[2][3] + a16[2]*(eff[4].x[3]*S1716[2][1] - eff[4].x[1]*S1716[2][3]) + a16[1]*(-(eff[4].x[3]*S1716[2][2]) + eff[4].x[2]*S1716[2][3]);
a17[6]=a16[4]*S1716[3][1] + a16[5]*S1716[3][2] + a16[3]*(-(eff[4].x[2]*S1716[3][1]) + eff[4].x[1]*S1716[3][2]) + a16[6]*S1716[3][3] + a16[2]*(eff[4].x[3]*S1716[3][1] - eff[4].x[1]*S1716[3][3]) + a16[1]*(-(eff[4].x[3]*S1716[3][2]) + eff[4].x[2]*S1716[3][3]);

a18[1]=state[22].thd*v18[2] + a1[1]*S181[1][1] + a1[2]*S181[1][2];
a18[2]=-(state[22].thd*v18[1]) + a1[1]*S181[2][1] + a1[2]*S181[2][2];
a18[3]=state[22].thdd + a1[3];
a18[4]=state[22].thd*v18[5] + a1[4]*S181[1][1] + a1[5]*S181[1][2];
a18[5]=-(state[22].thd*v18[4]) + a1[4]*S181[2][1] + a1[5]*S181[2][2];
a18[6]=a1[6];

a19[1]=a18[1];
a19[2]=-a18[3];
a19[3]=a18[2];
a19[4]=HEADLINK1*a18[2] + a18[4];
a19[5]=HEADLINK2*a18[2] - a18[6];
a19[6]=-(HEADLINK1*a18[1]) + HEADLINK2*a18[3] + a18[5];

a20[1]=state[24].thd*v20[2] + a19[1]*S2019[1][1] + a19[3]*S2019[1][3];
a20[2]=-(state[24].thd*v20[1]) + a19[1]*S2019[2][1] + a19[3]*S2019[2][3];
a20[3]=state[24].thdd - a19[2];
a20[4]=state[24].thd*v20[5] + a19[4]*S2019[1][1] + a19[6]*S2019[1][3];
a20[5]=-(state[24].thd*v20[4]) + a19[4]*S2019[2][1] + a19[6]*S2019[2][3];
a20[6]=-a19[5];

a21[1]=state[21].thd*v21[2] + a0[1]*S210[1][1] + a0[3]*S210[1][3];
a21[2]=-(state[21].thd*v21[1]) + a0[1]*S210[2][1] + a0[3]*S210[2][3];
a21[3]=state[21].thdd - a0[2];
a21[4]=state[21].thd*v21[5] + a0[4]*S210[1][1] - BODYLINK2*a0[2]*S210[1][3] + a0[6]*S210[1][3];
a21[5]=-(state[21].thd*v21[4]) + a0[4]*S210[2][1] - BODYLINK2*a0[2]*S210[2][3] + a0[6]*S210[2][3];
a21[6]=-(BODYLINK2*a0[3]) - a0[5];

a22[1]=state[1].thd*v22[2] + a21[1]*S2221[1][1] + a21[3]*S2221[1][3];
a22[2]=-(state[1].thd*v22[1]) + a21[1]*S2221[2][1] + a21[3]*S2221[2][3];
a22[3]=state[1].thdd + a21[2];
a22[4]=state[1].thd*v22[5] + WAISTLINK1*a21[3]*S2221[1][1] + a21[4]*S2221[1][1] - WAISTLINK1*a21[1]*S2221[1][3] + a21[6]*S2221[1][3] + a21[2]*(LEGLINK1*S2221[1][1] + WAISTLINK2*S2221[1][3]);
a22[5]=-(state[1].thd*v22[4]) + WAISTLINK1*a21[3]*S2221[2][1] + a21[4]*S2221[2][1] - WAISTLINK1*a21[1]*S2221[2][3] + a21[6]*S2221[2][3] + a21[2]*(LEGLINK1*S2221[2][1] + WAISTLINK2*S2221[2][3]);
a22[6]=-(LEGLINK1*a21[1]) - WAISTLINK2*a21[3] + a21[5];

a23[1]=state[2].thd*v23[2] + a22[1]*S2322[1][1] + a22[3]*S2322[1][3];
a23[2]=-(state[2].thd*v23[1]) + a22[1]*S2322[2][1] + a22[3]*S2322[2][3];
a23[3]=state[2].thdd - a22[2];
a23[4]=state[2].thd*v23[5] + a22[4]*S2322[1][1] + a22[6]*S2322[1][3];
a23[5]=-(state[2].thd*v23[4]) + a22[4]*S2322[2][1] + a22[6]*S2322[2][3];
a23[6]=-a22[5];

a24[1]=state[3].thd*v24[2] + a23[1]*S2423[1][1] + a23[3]*S2423[1][3];
a24[2]=-(state[3].thd*v24[1]) + a23[1]*S2423[2][1] + a23[3]*S2423[2][3];
a24[3]=state[3].thdd - a23[2];
a24[4]=state[3].thd*v24[5] + a23[4]*S2423[1][1] + a23[6]*S2423[1][3];
a24[5]=-(state[3].thd*v24[4]) + a23[4]*S2423[2][1] + a23[6]*S2423[2][3];
a24[6]=-a23[5];

a25[1]=state[4].thd*v25[2] + a24[1]*S2524[1][1] + a24[2]*S2524[1][2];
a25[2]=-(state[4].thd*v25[1]) + a24[1]*S2524[2][1] + a24[2]*S2524[2][2];
a25[3]=state[4].thdd + a24[3];
a25[4]=state[4].thd*v25[5] + a24[4]*S2524[1][1] - LEGLINK2*a24[3]*S2524[1][2] + a24[5]*S2524[1][2];
a25[5]=-(state[4].thd*v25[4]) + a24[4]*S2524[2][1] - LEGLINK2*a24[3]*S2524[2][2] + a24[5]*S2524[2][2];
a25[6]=LEGLINK2*a24[2] + a24[6];

a26[1]=state[5].thd*v26[2] + a25[1]*S2625[1][1] + a25[2]*S2625[1][2];
a26[2]=-(state[5].thd*v26[1]) + a25[1]*S2625[2][1] + a25[2]*S2625[2][2];
a26[3]=state[5].thdd + a25[3];
a26[4]=state[5].thd*v26[5] + a25[4]*S2625[1][1] - LEGLINK3*a25[3]*S2625[1][2] + a25[5]*S2625[1][2];
a26[5]=-(state[5].thd*v26[4]) + a25[4]*S2625[2][1] - LEGLINK3*a25[3]*S2625[2][2] + a25[5]*S2625[2][2];
a26[6]=LEGLINK3*a25[2] + a25[6];

a27[1]=state[6].thd*v27[2] + a26[1]*S2726[1][1] + a26[3]*S2726[1][3];
a27[2]=-(state[6].thd*v27[1]) + a26[1]*S2726[2][1] + a26[3]*S2726[2][3];
a27[3]=state[6].thdd + a26[2];
a27[4]=state[6].thd*v27[5] + a26[4]*S2726[1][1] + a26[6]*S2726[1][3];
a27[5]=-(state[6].thd*v27[4]) + a26[4]*S2726[2][1] + a26[6]*S2726[2][3];
a27[6]=a26[5];

a28[1]=a27[1];
a28[2]=a27[2];
a28[3]=a27[3];
a28[4]=FOOTWIDLONG*a27[2] - FOOTLLENGLONG*a27[3] + a27[4];
a28[5]=-(FOOTWIDLONG*a27[1]) - LEGLINK4*a27[3] + a27[5];
a28[6]=FOOTLLENGLONG*a27[1] + LEGLINK4*a27[2] + a27[6];

a29[1]=a27[1];
a29[2]=a27[2];
a29[3]=a27[3];
a29[4]=-(FOOTWIDSHORT*a27[2]) - FOOTLLENGLONG*a27[3] + a27[4];
a29[5]=FOOTWIDSHORT*a27[1] - LEGLINK4*a27[3] + a27[5];
a29[6]=FOOTLLENGLONG*a27[1] + LEGLINK4*a27[2] + a27[6];

a30[1]=a27[1];
a30[2]=a27[2];
a30[3]=a27[3];
a30[4]=-(FOOTWIDSHORT*a27[2]) + FOOTLENGSHORT*a27[3] + a27[4];
a30[5]=FOOTWIDSHORT*a27[1] - LEGLINK4*a27[3] + a27[5];
a30[6]=-(FOOTLENGSHORT*a27[1]) + LEGLINK4*a27[2] + a27[6];

a31[1]=a27[1];
a31[2]=a27[2];
a31[3]=a27[3];
a31[4]=FOOTWIDLONG*a27[2] + FOOTLENGSHORT*a27[3] + a27[4];
a31[5]=-(FOOTWIDLONG*a27[1]) - LEGLINK4*a27[3] + a27[5];
a31[6]=-(FOOTLENGSHORT*a27[1]) + LEGLINK4*a27[2] + a27[6];

a32[1]=a27[1]*S3227[1][1] + a27[2]*S3227[1][2] + a27[3]*S3227[1][3];
a32[2]=a27[1]*S3227[2][1] + a27[2]*S3227[2][2] + a27[3]*S3227[2][3];
a32[3]=a27[1]*S3227[3][1] + a27[2]*S3227[3][2] + a27[3]*S3227[3][3];
a32[4]=a27[4]*S3227[1][1] + a27[5]*S3227[1][2] + a27[3]*(-(eff[1].x[2]*S3227[1][1]) + eff[1].x[1]*S3227[1][2]) + a27[6]*S3227[1][3] + a27[2]*(eff[1].x[3]*S3227[1][1] - eff[1].x[1]*S3227[1][3]) + a27[1]*(-(eff[1].x[3]*S3227[1][2]) + eff[1].x[2]*S3227[1][3]);
a32[5]=a27[4]*S3227[2][1] + a27[5]*S3227[2][2] + a27[3]*(-(eff[1].x[2]*S3227[2][1]) + eff[1].x[1]*S3227[2][2]) + a27[6]*S3227[2][3] + a27[2]*(eff[1].x[3]*S3227[2][1] - eff[1].x[1]*S3227[2][3]) + a27[1]*(-(eff[1].x[3]*S3227[2][2]) + eff[1].x[2]*S3227[2][3]);
a32[6]=a27[4]*S3227[3][1] + a27[5]*S3227[3][2] + a27[3]*(-(eff[1].x[2]*S3227[3][1]) + eff[1].x[1]*S3227[3][2]) + a27[6]*S3227[3][3] + a27[2]*(eff[1].x[3]*S3227[3][1] - eff[1].x[1]*S3227[3][3]) + a27[1]*(-(eff[1].x[3]*S3227[3][2]) + eff[1].x[2]*S3227[3][3]);

a33[1]=state[11].thd*v33[2] + a21[1]*S3321[1][1] + a21[3]*S3321[1][3];
a33[2]=-(state[11].thd*v33[1]) + a21[1]*S3321[2][1] + a21[3]*S3321[2][3];
a33[3]=state[11].thdd + a21[2];
a33[4]=state[11].thd*v33[5] + WAISTLINK1*a21[3]*S3321[1][1] + a21[4]*S3321[1][1] - WAISTLINK1*a21[1]*S3321[1][3] + a21[6]*S3321[1][3] + a21[2]*(-(LEGLINK1*S3321[1][1]) + WAISTLINK2*S3321[1][3]);
a33[5]=-(state[11].thd*v33[4]) + WAISTLINK1*a21[3]*S3321[2][1] + a21[4]*S3321[2][1] - WAISTLINK1*a21[1]*S3321[2][3] + a21[6]*S3321[2][3] + a21[2]*(-(LEGLINK1*S3321[2][1]) + WAISTLINK2*S3321[2][3]);
a33[6]=LEGLINK1*a21[1] - WAISTLINK2*a21[3] + a21[5];

a34[1]=state[12].thd*v34[2] + a33[1]*S3433[1][1] + a33[3]*S3433[1][3];
a34[2]=-(state[12].thd*v34[1]) + a33[1]*S3433[2][1] + a33[3]*S3433[2][3];
a34[3]=state[12].thdd - a33[2];
a34[4]=state[12].thd*v34[5] + a33[4]*S3433[1][1] + a33[6]*S3433[1][3];
a34[5]=-(state[12].thd*v34[4]) + a33[4]*S3433[2][1] + a33[6]*S3433[2][3];
a34[6]=-a33[5];

a35[1]=state[13].thd*v35[2] + a34[1]*S3534[1][1] + a34[3]*S3534[1][3];
a35[2]=-(state[13].thd*v35[1]) + a34[1]*S3534[2][1] + a34[3]*S3534[2][3];
a35[3]=state[13].thdd - a34[2];
a35[4]=state[13].thd*v35[5] + a34[4]*S3534[1][1] + a34[6]*S3534[1][3];
a35[5]=-(state[13].thd*v35[4]) + a34[4]*S3534[2][1] + a34[6]*S3534[2][3];
a35[6]=-a34[5];

a36[1]=state[14].thd*v36[2] + a35[1]*S3635[1][1] + a35[2]*S3635[1][2];
a36[2]=-(state[14].thd*v36[1]) + a35[1]*S3635[2][1] + a35[2]*S3635[2][2];
a36[3]=state[14].thdd + a35[3];
a36[4]=state[14].thd*v36[5] + a35[4]*S3635[1][1] - LEGLINK2*a35[3]*S3635[1][2] + a35[5]*S3635[1][2];
a36[5]=-(state[14].thd*v36[4]) + a35[4]*S3635[2][1] - LEGLINK2*a35[3]*S3635[2][2] + a35[5]*S3635[2][2];
a36[6]=LEGLINK2*a35[2] + a35[6];

a37[1]=state[15].thd*v37[2] + a36[1]*S3736[1][1] + a36[2]*S3736[1][2];
a37[2]=-(state[15].thd*v37[1]) + a36[1]*S3736[2][1] + a36[2]*S3736[2][2];
a37[3]=state[15].thdd + a36[3];
a37[4]=state[15].thd*v37[5] + a36[4]*S3736[1][1] - LEGLINK3*a36[3]*S3736[1][2] + a36[5]*S3736[1][2];
a37[5]=-(state[15].thd*v37[4]) + a36[4]*S3736[2][1] - LEGLINK3*a36[3]*S3736[2][2] + a36[5]*S3736[2][2];
a37[6]=LEGLINK3*a36[2] + a36[6];

a38[1]=state[16].thd*v38[2] + a37[1]*S3837[1][1] + a37[3]*S3837[1][3];
a38[2]=-(state[16].thd*v38[1]) + a37[1]*S3837[2][1] + a37[3]*S3837[2][3];
a38[3]=state[16].thdd + a37[2];
a38[4]=state[16].thd*v38[5] + a37[4]*S3837[1][1] + a37[6]*S3837[1][3];
a38[5]=-(state[16].thd*v38[4]) + a37[4]*S3837[2][1] + a37[6]*S3837[2][3];
a38[6]=a37[5];

a39[1]=a38[3];
a39[2]=-a38[2];
a39[3]=a38[1];
a39[4]=LEGLINK4*a38[2] + a38[6];
a39[5]=LEGLINK4*a38[3] - a38[5];
a39[6]=a38[4];

a40[1]=a39[1]*S4039[1][1] + a39[2]*S4039[1][2] + a39[3]*S4039[1][3];
a40[2]=a39[1]*S4039[2][1] + a39[2]*S4039[2][2] + a39[3]*S4039[2][3];
a40[3]=a39[1]*S4039[3][1] + a39[2]*S4039[3][2] + a39[3]*S4039[3][3];
a40[4]=a39[4]*S4039[1][1] + a39[5]*S4039[1][2] + a39[3]*(-(eff[3].x[2]*S4039[1][1]) + eff[3].x[1]*S4039[1][2]) + a39[6]*S4039[1][3] + a39[2]*(eff[3].x[3]*S4039[1][1] - eff[3].x[1]*S4039[1][3]) + a39[1]*(-(eff[3].x[3]*S4039[1][2]) + eff[3].x[2]*S4039[1][3]);
a40[5]=a39[4]*S4039[2][1] + a39[5]*S4039[2][2] + a39[3]*(-(eff[3].x[2]*S4039[2][1]) + eff[3].x[1]*S4039[2][2]) + a39[6]*S4039[2][3] + a39[2]*(eff[3].x[3]*S4039[2][1] - eff[3].x[1]*S4039[2][3]) + a39[1]*(-(eff[3].x[3]*S4039[2][2]) + eff[3].x[2]*S4039[2][3]);
a40[6]=a39[4]*S4039[3][1] + a39[5]*S4039[3][2] + a39[3]*(-(eff[3].x[2]*S4039[3][1]) + eff[3].x[1]*S4039[3][2]) + a39[6]*S4039[3][3] + a39[2]*(eff[3].x[3]*S4039[3][1] - eff[3].x[1]*S4039[3][3]) + a39[1]*(-(eff[3].x[3]*S4039[3][2]) + eff[3].x[2]*S4039[3][3]);

a41[1]=a38[1];
a41[2]=a38[2];
a41[3]=a38[3];
a41[4]=-(LEGLINK4*a38[2]) - FOOTWIDLONG*a38[3] + a38[4];
a41[5]=LEGLINK4*a38[1] + FOOTLLENGLONG*a38[3] + a38[5];
a41[6]=FOOTWIDLONG*a38[1] - FOOTLLENGLONG*a38[2] + a38[6];

a42[1]=a38[1];
a42[2]=a38[2];
a42[3]=a38[3];
a42[4]=-(LEGLINK4*a38[2]) + FOOTWIDSHORT*a38[3] + a38[4];
a42[5]=LEGLINK4*a38[1] + FOOTLLENGLONG*a38[3] + a38[5];
a42[6]=-(FOOTWIDSHORT*a38[1]) - FOOTLLENGLONG*a38[2] + a38[6];

a43[1]=a38[1];
a43[2]=a38[2];
a43[3]=a38[3];
a43[4]=-(LEGLINK4*a38[2]) + FOOTWIDSHORT*a38[3] + a38[4];
a43[5]=LEGLINK4*a38[1] - FOOTLENGSHORT*a38[3] + a38[5];
a43[6]=-(FOOTWIDSHORT*a38[1]) + FOOTLENGSHORT*a38[2] + a38[6];

a44[1]=a38[1];
a44[2]=a38[2];
a44[3]=a38[3];
a44[4]=-(LEGLINK4*a38[2]) - FOOTWIDLONG*a38[3] + a38[4];
a44[5]=LEGLINK4*a38[1] - FOOTLENGSHORT*a38[3] + a38[5];
a44[6]=FOOTWIDLONG*a38[1] + FOOTLENGSHORT*a38[2] + a38[6];

a45[1]=a0[1];
a45[2]=a0[2];
a45[3]=a0[3];
a45[4]=PALM*a0[2] + a0[4];
a45[5]=-(PALM*a0[1]) - PALMOFFSETX*a0[3] + a0[5];
a45[6]=PALMOFFSETX*a0[2] + a0[6];

a46[1]=a45[1]*S4645[1][1] + a45[2]*S4645[1][2] + a45[3]*S4645[1][3];
a46[2]=a45[1]*S4645[2][1] + a45[2]*S4645[2][2] + a45[3]*S4645[2][3];
a46[3]=a45[1]*S4645[3][1] + a45[2]*S4645[3][2] + a45[3]*S4645[3][3];
a46[4]=a45[4]*S4645[1][1] + a45[5]*S4645[1][2] + a45[3]*(-(eff[2].x[2]*S4645[1][1]) + eff[2].x[1]*S4645[1][2]) + a45[6]*S4645[1][3] + a45[2]*(eff[2].x[3]*S4645[1][1] - eff[2].x[1]*S4645[1][3]) + a45[1]*(-(eff[2].x[3]*S4645[1][2]) + eff[2].x[2]*S4645[1][3]);
a46[5]=a45[4]*S4645[2][1] + a45[5]*S4645[2][2] + a45[3]*(-(eff[2].x[2]*S4645[2][1]) + eff[2].x[1]*S4645[2][2]) + a45[6]*S4645[2][3] + a45[2]*(eff[2].x[3]*S4645[2][1] - eff[2].x[1]*S4645[2][3]) + a45[1]*(-(eff[2].x[3]*S4645[2][2]) + eff[2].x[2]*S4645[2][3]);
a46[6]=a45[4]*S4645[3][1] + a45[5]*S4645[3][2] + a45[3]*(-(eff[2].x[2]*S4645[3][1]) + eff[2].x[1]*S4645[3][2]) + a45[6]*S4645[3][3] + a45[2]*(eff[2].x[3]*S4645[3][1] - eff[2].x[1]*S4645[3][3]) + a45[1]*(-(eff[2].x[3]*S4645[3][2]) + eff[2].x[2]*S4645[3][3]);



}


void
hoap_InvDynNEfunc6(void)
     {
/* net forces and external forces for each joint */
fnet0[1]=links[0].m*a0[4] - a0[3]*links[0].mcm[2] + a0[2]*links[0].mcm[3] - links[0].mcm[1]*Power(v0[2],2) - links[0].mcm[1]*Power(v0[3],2) + v0[1]*(links[0].mcm[2]*v0[2] + links[0].mcm[3]*v0[3]) - links[0].m*v0[3]*v0[5] + links[0].m*v0[2]*v0[6];
fnet0[2]=links[0].m*a0[5] + a0[3]*links[0].mcm[1] - a0[1]*links[0].mcm[3] - links[0].mcm[2]*Power(v0[1],2) - links[0].mcm[2]*Power(v0[3],2) + v0[2]*(links[0].mcm[1]*v0[1] + links[0].mcm[3]*v0[3]) + links[0].m*v0[3]*v0[4] - links[0].m*v0[1]*v0[6];
fnet0[3]=links[0].m*a0[6] - a0[2]*links[0].mcm[1] + a0[1]*links[0].mcm[2] - links[0].mcm[3]*Power(v0[1],2) - links[0].mcm[3]*Power(v0[2],2) + (links[0].mcm[1]*v0[1] + links[0].mcm[2]*v0[2])*v0[3] - links[0].m*v0[2]*v0[4] + links[0].m*v0[1]*v0[5];
fnet0[4]=a0[6]*links[0].mcm[2] - a0[5]*links[0].mcm[3] + (-(links[0].mcm[2]*v0[2]) - links[0].mcm[3]*v0[3])*v0[4] + (links[0].mcm[1]*v0[3] + links[0].m*v0[5])*v0[6] + v0[5]*(links[0].mcm[1]*v0[2] - links[0].m*v0[6]) + a0[1]*links[0].inertia[1][1] + a0[2]*links[0].inertia[1][2] + a0[3]*links[0].inertia[1][3] + v0[1]*(links[0].mcm[2]*v0[5] + links[0].mcm[3]*v0[6] - v0[3]*links[0].inertia[1][2] + v0[2]*links[0].inertia[1][3]) + v0[2]*(-(links[0].mcm[1]*v0[5]) - v0[3]*links[0].inertia[2][2] + v0[2]*links[0].inertia[2][3]) + v0[3]*(-(links[0].mcm[1]*v0[6]) - v0[3]*links[0].inertia[2][3] + v0[2]*links[0].inertia[3][3]);
fnet0[5]=-(a0[6]*links[0].mcm[1]) + a0[4]*links[0].mcm[3] + (-(links[0].mcm[1]*v0[1]) - links[0].mcm[3]*v0[3])*v0[5] + (links[0].mcm[2]*v0[3] - links[0].m*v0[4])*v0[6] + v0[4]*(links[0].mcm[2]*v0[1] + links[0].m*v0[6]) + a0[1]*links[0].inertia[1][2] + v0[1]*(-(links[0].mcm[2]*v0[4]) + v0[3]*links[0].inertia[1][1] - v0[1]*links[0].inertia[1][3]) + a0[2]*links[0].inertia[2][2] + a0[3]*links[0].inertia[2][3] + v0[2]*(links[0].mcm[1]*v0[4] + links[0].mcm[3]*v0[6] + v0[3]*links[0].inertia[1][2] - v0[1]*links[0].inertia[2][3]) + v0[3]*(-(links[0].mcm[2]*v0[6]) + v0[3]*links[0].inertia[1][3] - v0[1]*links[0].inertia[3][3]);
fnet0[6]=a0[5]*links[0].mcm[1] - a0[4]*links[0].mcm[2] + (links[0].mcm[3]*v0[2] + links[0].m*v0[4])*v0[5] + v0[4]*(links[0].mcm[3]*v0[1] - links[0].m*v0[5]) + (-(links[0].mcm[1]*v0[1]) - links[0].mcm[2]*v0[2])*v0[6] + v0[1]*(-(links[0].mcm[3]*v0[4]) - v0[2]*links[0].inertia[1][1] + v0[1]*links[0].inertia[1][2]) + a0[1]*links[0].inertia[1][3] + v0[2]*(-(links[0].mcm[3]*v0[5]) - v0[2]*links[0].inertia[1][2] + v0[1]*links[0].inertia[2][2]) + a0[2]*links[0].inertia[2][3] + v0[3]*(links[0].mcm[1]*v0[4] + links[0].mcm[2]*v0[5] - v0[2]*links[0].inertia[1][3] + v0[1]*links[0].inertia[2][3]) + a0[3]*links[0].inertia[3][3];

fnet2[1]=links[7].m*a2[4] - a2[3]*links[7].mcm[2] + a2[2]*links[7].mcm[3] - links[7].mcm[1]*Power(v2[2],2) - links[7].mcm[1]*Power(v2[3],2) + v2[1]*(links[7].mcm[2]*v2[2] + links[7].mcm[3]*v2[3]) - links[7].m*v2[3]*v2[5] + links[7].m*v2[2]*v2[6];
fnet2[2]=links[7].m*a2[5] + a2[3]*links[7].mcm[1] - a2[1]*links[7].mcm[3] - links[7].mcm[2]*Power(v2[1],2) - links[7].mcm[2]*Power(v2[3],2) + v2[2]*(links[7].mcm[1]*v2[1] + links[7].mcm[3]*v2[3]) + links[7].m*v2[3]*v2[4] - links[7].m*v2[1]*v2[6];
fnet2[3]=links[7].m*a2[6] - a2[2]*links[7].mcm[1] + a2[1]*links[7].mcm[2] - links[7].mcm[3]*Power(v2[1],2) - links[7].mcm[3]*Power(v2[2],2) + (links[7].mcm[1]*v2[1] + links[7].mcm[2]*v2[2])*v2[3] - links[7].m*v2[2]*v2[4] + links[7].m*v2[1]*v2[5];
fnet2[4]=a2[6]*links[7].mcm[2] - a2[5]*links[7].mcm[3] + (-(links[7].mcm[2]*v2[2]) - links[7].mcm[3]*v2[3])*v2[4] + (links[7].mcm[1]*v2[3] + links[7].m*v2[5])*v2[6] + v2[5]*(links[7].mcm[1]*v2[2] - links[7].m*v2[6]) + a2[1]*links[7].inertia[1][1] + a2[2]*links[7].inertia[1][2] + a2[3]*links[7].inertia[1][3] + v2[1]*(links[7].mcm[2]*v2[5] + links[7].mcm[3]*v2[6] - v2[3]*links[7].inertia[1][2] + v2[2]*links[7].inertia[1][3]) + v2[2]*(-(links[7].mcm[1]*v2[5]) - v2[3]*links[7].inertia[2][2] + v2[2]*links[7].inertia[2][3]) + v2[3]*(-(links[7].mcm[1]*v2[6]) - v2[3]*links[7].inertia[2][3] + v2[2]*links[7].inertia[3][3]);
fnet2[5]=-(a2[6]*links[7].mcm[1]) + a2[4]*links[7].mcm[3] + (-(links[7].mcm[1]*v2[1]) - links[7].mcm[3]*v2[3])*v2[5] + (links[7].mcm[2]*v2[3] - links[7].m*v2[4])*v2[6] + v2[4]*(links[7].mcm[2]*v2[1] + links[7].m*v2[6]) + a2[1]*links[7].inertia[1][2] + v2[1]*(-(links[7].mcm[2]*v2[4]) + v2[3]*links[7].inertia[1][1] - v2[1]*links[7].inertia[1][3]) + a2[2]*links[7].inertia[2][2] + a2[3]*links[7].inertia[2][3] + v2[2]*(links[7].mcm[1]*v2[4] + links[7].mcm[3]*v2[6] + v2[3]*links[7].inertia[1][2] - v2[1]*links[7].inertia[2][3]) + v2[3]*(-(links[7].mcm[2]*v2[6]) + v2[3]*links[7].inertia[1][3] - v2[1]*links[7].inertia[3][3]);
fnet2[6]=a2[5]*links[7].mcm[1] - a2[4]*links[7].mcm[2] + (links[7].mcm[3]*v2[2] + links[7].m*v2[4])*v2[5] + v2[4]*(links[7].mcm[3]*v2[1] - links[7].m*v2[5]) + (-(links[7].mcm[1]*v2[1]) - links[7].mcm[2]*v2[2])*v2[6] + v2[1]*(-(links[7].mcm[3]*v2[4]) - v2[2]*links[7].inertia[1][1] + v2[1]*links[7].inertia[1][2]) + a2[1]*links[7].inertia[1][3] + v2[2]*(-(links[7].mcm[3]*v2[5]) - v2[2]*links[7].inertia[1][2] + v2[1]*links[7].inertia[2][2]) + a2[2]*links[7].inertia[2][3] + v2[3]*(links[7].mcm[1]*v2[4] + links[7].mcm[2]*v2[5] - v2[2]*links[7].inertia[1][3] + v2[1]*links[7].inertia[2][3]) + a2[3]*links[7].inertia[3][3];

fnet3[1]=links[8].m*a3[4] - a3[3]*links[8].mcm[2] + a3[2]*links[8].mcm[3] - links[8].mcm[1]*Power(v3[2],2) - links[8].mcm[1]*Power(v3[3],2) + v3[1]*(links[8].mcm[2]*v3[2] + links[8].mcm[3]*v3[3]) - links[8].m*v3[3]*v3[5] + links[8].m*v3[2]*v3[6];
fnet3[2]=links[8].m*a3[5] + a3[3]*links[8].mcm[1] - a3[1]*links[8].mcm[3] - links[8].mcm[2]*Power(v3[1],2) - links[8].mcm[2]*Power(v3[3],2) + v3[2]*(links[8].mcm[1]*v3[1] + links[8].mcm[3]*v3[3]) + links[8].m*v3[3]*v3[4] - links[8].m*v3[1]*v3[6];
fnet3[3]=links[8].m*a3[6] - a3[2]*links[8].mcm[1] + a3[1]*links[8].mcm[2] - links[8].mcm[3]*Power(v3[1],2) - links[8].mcm[3]*Power(v3[2],2) + (links[8].mcm[1]*v3[1] + links[8].mcm[2]*v3[2])*v3[3] - links[8].m*v3[2]*v3[4] + links[8].m*v3[1]*v3[5];
fnet3[4]=a3[6]*links[8].mcm[2] - a3[5]*links[8].mcm[3] + (-(links[8].mcm[2]*v3[2]) - links[8].mcm[3]*v3[3])*v3[4] + (links[8].mcm[1]*v3[3] + links[8].m*v3[5])*v3[6] + v3[5]*(links[8].mcm[1]*v3[2] - links[8].m*v3[6]) + a3[1]*links[8].inertia[1][1] + a3[2]*links[8].inertia[1][2] + a3[3]*links[8].inertia[1][3] + v3[1]*(links[8].mcm[2]*v3[5] + links[8].mcm[3]*v3[6] - v3[3]*links[8].inertia[1][2] + v3[2]*links[8].inertia[1][3]) + v3[2]*(-(links[8].mcm[1]*v3[5]) - v3[3]*links[8].inertia[2][2] + v3[2]*links[8].inertia[2][3]) + v3[3]*(-(links[8].mcm[1]*v3[6]) - v3[3]*links[8].inertia[2][3] + v3[2]*links[8].inertia[3][3]);
fnet3[5]=-(a3[6]*links[8].mcm[1]) + a3[4]*links[8].mcm[3] + (-(links[8].mcm[1]*v3[1]) - links[8].mcm[3]*v3[3])*v3[5] + (links[8].mcm[2]*v3[3] - links[8].m*v3[4])*v3[6] + v3[4]*(links[8].mcm[2]*v3[1] + links[8].m*v3[6]) + a3[1]*links[8].inertia[1][2] + v3[1]*(-(links[8].mcm[2]*v3[4]) + v3[3]*links[8].inertia[1][1] - v3[1]*links[8].inertia[1][3]) + a3[2]*links[8].inertia[2][2] + a3[3]*links[8].inertia[2][3] + v3[2]*(links[8].mcm[1]*v3[4] + links[8].mcm[3]*v3[6] + v3[3]*links[8].inertia[1][2] - v3[1]*links[8].inertia[2][3]) + v3[3]*(-(links[8].mcm[2]*v3[6]) + v3[3]*links[8].inertia[1][3] - v3[1]*links[8].inertia[3][3]);
fnet3[6]=a3[5]*links[8].mcm[1] - a3[4]*links[8].mcm[2] + (links[8].mcm[3]*v3[2] + links[8].m*v3[4])*v3[5] + v3[4]*(links[8].mcm[3]*v3[1] - links[8].m*v3[5]) + (-(links[8].mcm[1]*v3[1]) - links[8].mcm[2]*v3[2])*v3[6] + v3[1]*(-(links[8].mcm[3]*v3[4]) - v3[2]*links[8].inertia[1][1] + v3[1]*links[8].inertia[1][2]) + a3[1]*links[8].inertia[1][3] + v3[2]*(-(links[8].mcm[3]*v3[5]) - v3[2]*links[8].inertia[1][2] + v3[1]*links[8].inertia[2][2]) + a3[2]*links[8].inertia[2][3] + v3[3]*(links[8].mcm[1]*v3[4] + links[8].mcm[2]*v3[5] - v3[2]*links[8].inertia[1][3] + v3[1]*links[8].inertia[2][3]) + a3[3]*links[8].inertia[3][3];

fnet4[1]=links[9].m*a4[4] - a4[3]*links[9].mcm[2] + a4[2]*links[9].mcm[3] - links[9].mcm[1]*Power(v4[2],2) - links[9].mcm[1]*Power(v4[3],2) + v4[1]*(links[9].mcm[2]*v4[2] + links[9].mcm[3]*v4[3]) - links[9].m*v4[3]*v4[5] + links[9].m*v4[2]*v4[6];
fnet4[2]=links[9].m*a4[5] + a4[3]*links[9].mcm[1] - a4[1]*links[9].mcm[3] - links[9].mcm[2]*Power(v4[1],2) - links[9].mcm[2]*Power(v4[3],2) + v4[2]*(links[9].mcm[1]*v4[1] + links[9].mcm[3]*v4[3]) + links[9].m*v4[3]*v4[4] - links[9].m*v4[1]*v4[6];
fnet4[3]=links[9].m*a4[6] - a4[2]*links[9].mcm[1] + a4[1]*links[9].mcm[2] - links[9].mcm[3]*Power(v4[1],2) - links[9].mcm[3]*Power(v4[2],2) + (links[9].mcm[1]*v4[1] + links[9].mcm[2]*v4[2])*v4[3] - links[9].m*v4[2]*v4[4] + links[9].m*v4[1]*v4[5];
fnet4[4]=a4[6]*links[9].mcm[2] - a4[5]*links[9].mcm[3] + (-(links[9].mcm[2]*v4[2]) - links[9].mcm[3]*v4[3])*v4[4] + (links[9].mcm[1]*v4[3] + links[9].m*v4[5])*v4[6] + v4[5]*(links[9].mcm[1]*v4[2] - links[9].m*v4[6]) + a4[1]*links[9].inertia[1][1] + a4[2]*links[9].inertia[1][2] + a4[3]*links[9].inertia[1][3] + v4[1]*(links[9].mcm[2]*v4[5] + links[9].mcm[3]*v4[6] - v4[3]*links[9].inertia[1][2] + v4[2]*links[9].inertia[1][3]) + v4[2]*(-(links[9].mcm[1]*v4[5]) - v4[3]*links[9].inertia[2][2] + v4[2]*links[9].inertia[2][3]) + v4[3]*(-(links[9].mcm[1]*v4[6]) - v4[3]*links[9].inertia[2][3] + v4[2]*links[9].inertia[3][3]);
fnet4[5]=-(a4[6]*links[9].mcm[1]) + a4[4]*links[9].mcm[3] + (-(links[9].mcm[1]*v4[1]) - links[9].mcm[3]*v4[3])*v4[5] + (links[9].mcm[2]*v4[3] - links[9].m*v4[4])*v4[6] + v4[4]*(links[9].mcm[2]*v4[1] + links[9].m*v4[6]) + a4[1]*links[9].inertia[1][2] + v4[1]*(-(links[9].mcm[2]*v4[4]) + v4[3]*links[9].inertia[1][1] - v4[1]*links[9].inertia[1][3]) + a4[2]*links[9].inertia[2][2] + a4[3]*links[9].inertia[2][3] + v4[2]*(links[9].mcm[1]*v4[4] + links[9].mcm[3]*v4[6] + v4[3]*links[9].inertia[1][2] - v4[1]*links[9].inertia[2][3]) + v4[3]*(-(links[9].mcm[2]*v4[6]) + v4[3]*links[9].inertia[1][3] - v4[1]*links[9].inertia[3][3]);
fnet4[6]=a4[5]*links[9].mcm[1] - a4[4]*links[9].mcm[2] + (links[9].mcm[3]*v4[2] + links[9].m*v4[4])*v4[5] + v4[4]*(links[9].mcm[3]*v4[1] - links[9].m*v4[5]) + (-(links[9].mcm[1]*v4[1]) - links[9].mcm[2]*v4[2])*v4[6] + v4[1]*(-(links[9].mcm[3]*v4[4]) - v4[2]*links[9].inertia[1][1] + v4[1]*links[9].inertia[1][2]) + a4[1]*links[9].inertia[1][3] + v4[2]*(-(links[9].mcm[3]*v4[5]) - v4[2]*links[9].inertia[1][2] + v4[1]*links[9].inertia[2][2]) + a4[2]*links[9].inertia[2][3] + v4[3]*(links[9].mcm[1]*v4[4] + links[9].mcm[2]*v4[5] - v4[2]*links[9].inertia[1][3] + v4[1]*links[9].inertia[2][3]) + a4[3]*links[9].inertia[3][3];

fnet5[1]=links[10].m*a5[4] - a5[3]*links[10].mcm[2] + a5[2]*links[10].mcm[3] - links[10].mcm[1]*Power(v5[2],2) - links[10].mcm[1]*Power(v5[3],2) + v5[1]*(links[10].mcm[2]*v5[2] + links[10].mcm[3]*v5[3]) - links[10].m*v5[3]*v5[5] + links[10].m*v5[2]*v5[6];
fnet5[2]=links[10].m*a5[5] + a5[3]*links[10].mcm[1] - a5[1]*links[10].mcm[3] - links[10].mcm[2]*Power(v5[1],2) - links[10].mcm[2]*Power(v5[3],2) + v5[2]*(links[10].mcm[1]*v5[1] + links[10].mcm[3]*v5[3]) + links[10].m*v5[3]*v5[4] - links[10].m*v5[1]*v5[6];
fnet5[3]=links[10].m*a5[6] - a5[2]*links[10].mcm[1] + a5[1]*links[10].mcm[2] - links[10].mcm[3]*Power(v5[1],2) - links[10].mcm[3]*Power(v5[2],2) + (links[10].mcm[1]*v5[1] + links[10].mcm[2]*v5[2])*v5[3] - links[10].m*v5[2]*v5[4] + links[10].m*v5[1]*v5[5];
fnet5[4]=a5[6]*links[10].mcm[2] - a5[5]*links[10].mcm[3] + (-(links[10].mcm[2]*v5[2]) - links[10].mcm[3]*v5[3])*v5[4] + (links[10].mcm[1]*v5[3] + links[10].m*v5[5])*v5[6] + v5[5]*(links[10].mcm[1]*v5[2] - links[10].m*v5[6]) + a5[1]*links[10].inertia[1][1] + a5[2]*links[10].inertia[1][2] + a5[3]*links[10].inertia[1][3] + v5[1]*(links[10].mcm[2]*v5[5] + links[10].mcm[3]*v5[6] - v5[3]*links[10].inertia[1][2] + v5[2]*links[10].inertia[1][3]) + v5[2]*(-(links[10].mcm[1]*v5[5]) - v5[3]*links[10].inertia[2][2] + v5[2]*links[10].inertia[2][3]) + v5[3]*(-(links[10].mcm[1]*v5[6]) - v5[3]*links[10].inertia[2][3] + v5[2]*links[10].inertia[3][3]);
fnet5[5]=-(a5[6]*links[10].mcm[1]) + a5[4]*links[10].mcm[3] + (-(links[10].mcm[1]*v5[1]) - links[10].mcm[3]*v5[3])*v5[5] + (links[10].mcm[2]*v5[3] - links[10].m*v5[4])*v5[6] + v5[4]*(links[10].mcm[2]*v5[1] + links[10].m*v5[6]) + a5[1]*links[10].inertia[1][2] + v5[1]*(-(links[10].mcm[2]*v5[4]) + v5[3]*links[10].inertia[1][1] - v5[1]*links[10].inertia[1][3]) + a5[2]*links[10].inertia[2][2] + a5[3]*links[10].inertia[2][3] + v5[2]*(links[10].mcm[1]*v5[4] + links[10].mcm[3]*v5[6] + v5[3]*links[10].inertia[1][2] - v5[1]*links[10].inertia[2][3]) + v5[3]*(-(links[10].mcm[2]*v5[6]) + v5[3]*links[10].inertia[1][3] - v5[1]*links[10].inertia[3][3]);
fnet5[6]=a5[5]*links[10].mcm[1] - a5[4]*links[10].mcm[2] + (links[10].mcm[3]*v5[2] + links[10].m*v5[4])*v5[5] + v5[4]*(links[10].mcm[3]*v5[1] - links[10].m*v5[5]) + (-(links[10].mcm[1]*v5[1]) - links[10].mcm[2]*v5[2])*v5[6] + v5[1]*(-(links[10].mcm[3]*v5[4]) - v5[2]*links[10].inertia[1][1] + v5[1]*links[10].inertia[1][2]) + a5[1]*links[10].inertia[1][3] + v5[2]*(-(links[10].mcm[3]*v5[5]) - v5[2]*links[10].inertia[1][2] + v5[1]*links[10].inertia[2][2]) + a5[2]*links[10].inertia[2][3] + v5[3]*(links[10].mcm[1]*v5[4] + links[10].mcm[2]*v5[5] - v5[2]*links[10].inertia[1][3] + v5[1]*links[10].inertia[2][3]) + a5[3]*links[10].inertia[3][3];

fnet9[1]=links[17].m*a9[4] - a9[3]*links[17].mcm[2] + a9[2]*links[17].mcm[3] - links[17].mcm[1]*Power(v9[2],2) - links[17].mcm[1]*Power(v9[3],2) + v9[1]*(links[17].mcm[2]*v9[2] + links[17].mcm[3]*v9[3]) - links[17].m*v9[3]*v9[5] + links[17].m*v9[2]*v9[6];
fnet9[2]=links[17].m*a9[5] + a9[3]*links[17].mcm[1] - a9[1]*links[17].mcm[3] - links[17].mcm[2]*Power(v9[1],2) - links[17].mcm[2]*Power(v9[3],2) + v9[2]*(links[17].mcm[1]*v9[1] + links[17].mcm[3]*v9[3]) + links[17].m*v9[3]*v9[4] - links[17].m*v9[1]*v9[6];
fnet9[3]=links[17].m*a9[6] - a9[2]*links[17].mcm[1] + a9[1]*links[17].mcm[2] - links[17].mcm[3]*Power(v9[1],2) - links[17].mcm[3]*Power(v9[2],2) + (links[17].mcm[1]*v9[1] + links[17].mcm[2]*v9[2])*v9[3] - links[17].m*v9[2]*v9[4] + links[17].m*v9[1]*v9[5];
fnet9[4]=a9[6]*links[17].mcm[2] - a9[5]*links[17].mcm[3] + (-(links[17].mcm[2]*v9[2]) - links[17].mcm[3]*v9[3])*v9[4] + (links[17].mcm[1]*v9[3] + links[17].m*v9[5])*v9[6] + v9[5]*(links[17].mcm[1]*v9[2] - links[17].m*v9[6]) + a9[1]*links[17].inertia[1][1] + a9[2]*links[17].inertia[1][2] + a9[3]*links[17].inertia[1][3] + v9[1]*(links[17].mcm[2]*v9[5] + links[17].mcm[3]*v9[6] - v9[3]*links[17].inertia[1][2] + v9[2]*links[17].inertia[1][3]) + v9[2]*(-(links[17].mcm[1]*v9[5]) - v9[3]*links[17].inertia[2][2] + v9[2]*links[17].inertia[2][3]) + v9[3]*(-(links[17].mcm[1]*v9[6]) - v9[3]*links[17].inertia[2][3] + v9[2]*links[17].inertia[3][3]);
fnet9[5]=-(a9[6]*links[17].mcm[1]) + a9[4]*links[17].mcm[3] + (-(links[17].mcm[1]*v9[1]) - links[17].mcm[3]*v9[3])*v9[5] + (links[17].mcm[2]*v9[3] - links[17].m*v9[4])*v9[6] + v9[4]*(links[17].mcm[2]*v9[1] + links[17].m*v9[6]) + a9[1]*links[17].inertia[1][2] + v9[1]*(-(links[17].mcm[2]*v9[4]) + v9[3]*links[17].inertia[1][1] - v9[1]*links[17].inertia[1][3]) + a9[2]*links[17].inertia[2][2] + a9[3]*links[17].inertia[2][3] + v9[2]*(links[17].mcm[1]*v9[4] + links[17].mcm[3]*v9[6] + v9[3]*links[17].inertia[1][2] - v9[1]*links[17].inertia[2][3]) + v9[3]*(-(links[17].mcm[2]*v9[6]) + v9[3]*links[17].inertia[1][3] - v9[1]*links[17].inertia[3][3]);
fnet9[6]=a9[5]*links[17].mcm[1] - a9[4]*links[17].mcm[2] + (links[17].mcm[3]*v9[2] + links[17].m*v9[4])*v9[5] + v9[4]*(links[17].mcm[3]*v9[1] - links[17].m*v9[5]) + (-(links[17].mcm[1]*v9[1]) - links[17].mcm[2]*v9[2])*v9[6] + v9[1]*(-(links[17].mcm[3]*v9[4]) - v9[2]*links[17].inertia[1][1] + v9[1]*links[17].inertia[1][2]) + a9[1]*links[17].inertia[1][3] + v9[2]*(-(links[17].mcm[3]*v9[5]) - v9[2]*links[17].inertia[1][2] + v9[1]*links[17].inertia[2][2]) + a9[2]*links[17].inertia[2][3] + v9[3]*(links[17].mcm[1]*v9[4] + links[17].mcm[2]*v9[5] - v9[2]*links[17].inertia[1][3] + v9[1]*links[17].inertia[2][3]) + a9[3]*links[17].inertia[3][3];

fnet10[1]=links[18].m*a10[4] - a10[3]*links[18].mcm[2] + a10[2]*links[18].mcm[3] - links[18].mcm[1]*Power(v10[2],2) - links[18].mcm[1]*Power(v10[3],2) + v10[1]*(links[18].mcm[2]*v10[2] + links[18].mcm[3]*v10[3]) - links[18].m*v10[3]*v10[5] + links[18].m*v10[2]*v10[6];
fnet10[2]=links[18].m*a10[5] + a10[3]*links[18].mcm[1] - a10[1]*links[18].mcm[3] - links[18].mcm[2]*Power(v10[1],2) - links[18].mcm[2]*Power(v10[3],2) + v10[2]*(links[18].mcm[1]*v10[1] + links[18].mcm[3]*v10[3]) + links[18].m*v10[3]*v10[4] - links[18].m*v10[1]*v10[6];
fnet10[3]=links[18].m*a10[6] - a10[2]*links[18].mcm[1] + a10[1]*links[18].mcm[2] - links[18].mcm[3]*Power(v10[1],2) - links[18].mcm[3]*Power(v10[2],2) + (links[18].mcm[1]*v10[1] + links[18].mcm[2]*v10[2])*v10[3] - links[18].m*v10[2]*v10[4] + links[18].m*v10[1]*v10[5];
fnet10[4]=a10[6]*links[18].mcm[2] - a10[5]*links[18].mcm[3] + (-(links[18].mcm[2]*v10[2]) - links[18].mcm[3]*v10[3])*v10[4] + (links[18].mcm[1]*v10[3] + links[18].m*v10[5])*v10[6] + v10[5]*(links[18].mcm[1]*v10[2] - links[18].m*v10[6]) + a10[1]*links[18].inertia[1][1] + a10[2]*links[18].inertia[1][2] + a10[3]*links[18].inertia[1][3] + v10[1]*(links[18].mcm[2]*v10[5] + links[18].mcm[3]*v10[6] - v10[3]*links[18].inertia[1][2] + v10[2]*links[18].inertia[1][3]) + v10[2]*(-(links[18].mcm[1]*v10[5]) - v10[3]*links[18].inertia[2][2] + v10[2]*links[18].inertia[2][3]) + v10[3]*(-(links[18].mcm[1]*v10[6]) - v10[3]*links[18].inertia[2][3] + v10[2]*links[18].inertia[3][3]);
fnet10[5]=-(a10[6]*links[18].mcm[1]) + a10[4]*links[18].mcm[3] + (-(links[18].mcm[1]*v10[1]) - links[18].mcm[3]*v10[3])*v10[5] + (links[18].mcm[2]*v10[3] - links[18].m*v10[4])*v10[6] + v10[4]*(links[18].mcm[2]*v10[1] + links[18].m*v10[6]) + a10[1]*links[18].inertia[1][2] + v10[1]*(-(links[18].mcm[2]*v10[4]) + v10[3]*links[18].inertia[1][1] - v10[1]*links[18].inertia[1][3]) + a10[2]*links[18].inertia[2][2] + a10[3]*links[18].inertia[2][3] + v10[2]*(links[18].mcm[1]*v10[4] + links[18].mcm[3]*v10[6] + v10[3]*links[18].inertia[1][2] - v10[1]*links[18].inertia[2][3]) + v10[3]*(-(links[18].mcm[2]*v10[6]) + v10[3]*links[18].inertia[1][3] - v10[1]*links[18].inertia[3][3]);
fnet10[6]=a10[5]*links[18].mcm[1] - a10[4]*links[18].mcm[2] + (links[18].mcm[3]*v10[2] + links[18].m*v10[4])*v10[5] + v10[4]*(links[18].mcm[3]*v10[1] - links[18].m*v10[5]) + (-(links[18].mcm[1]*v10[1]) - links[18].mcm[2]*v10[2])*v10[6] + v10[1]*(-(links[18].mcm[3]*v10[4]) - v10[2]*links[18].inertia[1][1] + v10[1]*links[18].inertia[1][2]) + a10[1]*links[18].inertia[1][3] + v10[2]*(-(links[18].mcm[3]*v10[5]) - v10[2]*links[18].inertia[1][2] + v10[1]*links[18].inertia[2][2]) + a10[2]*links[18].inertia[2][3] + v10[3]*(links[18].mcm[1]*v10[4] + links[18].mcm[2]*v10[5] - v10[2]*links[18].inertia[1][3] + v10[1]*links[18].inertia[2][3]) + a10[3]*links[18].inertia[3][3];

fnet11[1]=links[19].m*a11[4] - a11[3]*links[19].mcm[2] + a11[2]*links[19].mcm[3] - links[19].mcm[1]*Power(v11[2],2) - links[19].mcm[1]*Power(v11[3],2) + v11[1]*(links[19].mcm[2]*v11[2] + links[19].mcm[3]*v11[3]) - links[19].m*v11[3]*v11[5] + links[19].m*v11[2]*v11[6];
fnet11[2]=links[19].m*a11[5] + a11[3]*links[19].mcm[1] - a11[1]*links[19].mcm[3] - links[19].mcm[2]*Power(v11[1],2) - links[19].mcm[2]*Power(v11[3],2) + v11[2]*(links[19].mcm[1]*v11[1] + links[19].mcm[3]*v11[3]) + links[19].m*v11[3]*v11[4] - links[19].m*v11[1]*v11[6];
fnet11[3]=links[19].m*a11[6] - a11[2]*links[19].mcm[1] + a11[1]*links[19].mcm[2] - links[19].mcm[3]*Power(v11[1],2) - links[19].mcm[3]*Power(v11[2],2) + (links[19].mcm[1]*v11[1] + links[19].mcm[2]*v11[2])*v11[3] - links[19].m*v11[2]*v11[4] + links[19].m*v11[1]*v11[5];
fnet11[4]=a11[6]*links[19].mcm[2] - a11[5]*links[19].mcm[3] + (-(links[19].mcm[2]*v11[2]) - links[19].mcm[3]*v11[3])*v11[4] + (links[19].mcm[1]*v11[3] + links[19].m*v11[5])*v11[6] + v11[5]*(links[19].mcm[1]*v11[2] - links[19].m*v11[6]) + a11[1]*links[19].inertia[1][1] + a11[2]*links[19].inertia[1][2] + a11[3]*links[19].inertia[1][3] + v11[1]*(links[19].mcm[2]*v11[5] + links[19].mcm[3]*v11[6] - v11[3]*links[19].inertia[1][2] + v11[2]*links[19].inertia[1][3]) + v11[2]*(-(links[19].mcm[1]*v11[5]) - v11[3]*links[19].inertia[2][2] + v11[2]*links[19].inertia[2][3]) + v11[3]*(-(links[19].mcm[1]*v11[6]) - v11[3]*links[19].inertia[2][3] + v11[2]*links[19].inertia[3][3]);
fnet11[5]=-(a11[6]*links[19].mcm[1]) + a11[4]*links[19].mcm[3] + (-(links[19].mcm[1]*v11[1]) - links[19].mcm[3]*v11[3])*v11[5] + (links[19].mcm[2]*v11[3] - links[19].m*v11[4])*v11[6] + v11[4]*(links[19].mcm[2]*v11[1] + links[19].m*v11[6]) + a11[1]*links[19].inertia[1][2] + v11[1]*(-(links[19].mcm[2]*v11[4]) + v11[3]*links[19].inertia[1][1] - v11[1]*links[19].inertia[1][3]) + a11[2]*links[19].inertia[2][2] + a11[3]*links[19].inertia[2][3] + v11[2]*(links[19].mcm[1]*v11[4] + links[19].mcm[3]*v11[6] + v11[3]*links[19].inertia[1][2] - v11[1]*links[19].inertia[2][3]) + v11[3]*(-(links[19].mcm[2]*v11[6]) + v11[3]*links[19].inertia[1][3] - v11[1]*links[19].inertia[3][3]);
fnet11[6]=a11[5]*links[19].mcm[1] - a11[4]*links[19].mcm[2] + (links[19].mcm[3]*v11[2] + links[19].m*v11[4])*v11[5] + v11[4]*(links[19].mcm[3]*v11[1] - links[19].m*v11[5]) + (-(links[19].mcm[1]*v11[1]) - links[19].mcm[2]*v11[2])*v11[6] + v11[1]*(-(links[19].mcm[3]*v11[4]) - v11[2]*links[19].inertia[1][1] + v11[1]*links[19].inertia[1][2]) + a11[1]*links[19].inertia[1][3] + v11[2]*(-(links[19].mcm[3]*v11[5]) - v11[2]*links[19].inertia[1][2] + v11[1]*links[19].inertia[2][2]) + a11[2]*links[19].inertia[2][3] + v11[3]*(links[19].mcm[1]*v11[4] + links[19].mcm[2]*v11[5] - v11[2]*links[19].inertia[1][3] + v11[1]*links[19].inertia[2][3]) + a11[3]*links[19].inertia[3][3];

fnet12[1]=links[20].m*a12[4] - a12[3]*links[20].mcm[2] + a12[2]*links[20].mcm[3] - links[20].mcm[1]*Power(v12[2],2) - links[20].mcm[1]*Power(v12[3],2) + v12[1]*(links[20].mcm[2]*v12[2] + links[20].mcm[3]*v12[3]) - links[20].m*v12[3]*v12[5] + links[20].m*v12[2]*v12[6];
fnet12[2]=links[20].m*a12[5] + a12[3]*links[20].mcm[1] - a12[1]*links[20].mcm[3] - links[20].mcm[2]*Power(v12[1],2) - links[20].mcm[2]*Power(v12[3],2) + v12[2]*(links[20].mcm[1]*v12[1] + links[20].mcm[3]*v12[3]) + links[20].m*v12[3]*v12[4] - links[20].m*v12[1]*v12[6];
fnet12[3]=links[20].m*a12[6] - a12[2]*links[20].mcm[1] + a12[1]*links[20].mcm[2] - links[20].mcm[3]*Power(v12[1],2) - links[20].mcm[3]*Power(v12[2],2) + (links[20].mcm[1]*v12[1] + links[20].mcm[2]*v12[2])*v12[3] - links[20].m*v12[2]*v12[4] + links[20].m*v12[1]*v12[5];
fnet12[4]=a12[6]*links[20].mcm[2] - a12[5]*links[20].mcm[3] + (-(links[20].mcm[2]*v12[2]) - links[20].mcm[3]*v12[3])*v12[4] + (links[20].mcm[1]*v12[3] + links[20].m*v12[5])*v12[6] + v12[5]*(links[20].mcm[1]*v12[2] - links[20].m*v12[6]) + a12[1]*links[20].inertia[1][1] + a12[2]*links[20].inertia[1][2] + a12[3]*links[20].inertia[1][3] + v12[1]*(links[20].mcm[2]*v12[5] + links[20].mcm[3]*v12[6] - v12[3]*links[20].inertia[1][2] + v12[2]*links[20].inertia[1][3]) + v12[2]*(-(links[20].mcm[1]*v12[5]) - v12[3]*links[20].inertia[2][2] + v12[2]*links[20].inertia[2][3]) + v12[3]*(-(links[20].mcm[1]*v12[6]) - v12[3]*links[20].inertia[2][3] + v12[2]*links[20].inertia[3][3]);
fnet12[5]=-(a12[6]*links[20].mcm[1]) + a12[4]*links[20].mcm[3] + (-(links[20].mcm[1]*v12[1]) - links[20].mcm[3]*v12[3])*v12[5] + (links[20].mcm[2]*v12[3] - links[20].m*v12[4])*v12[6] + v12[4]*(links[20].mcm[2]*v12[1] + links[20].m*v12[6]) + a12[1]*links[20].inertia[1][2] + v12[1]*(-(links[20].mcm[2]*v12[4]) + v12[3]*links[20].inertia[1][1] - v12[1]*links[20].inertia[1][3]) + a12[2]*links[20].inertia[2][2] + a12[3]*links[20].inertia[2][3] + v12[2]*(links[20].mcm[1]*v12[4] + links[20].mcm[3]*v12[6] + v12[3]*links[20].inertia[1][2] - v12[1]*links[20].inertia[2][3]) + v12[3]*(-(links[20].mcm[2]*v12[6]) + v12[3]*links[20].inertia[1][3] - v12[1]*links[20].inertia[3][3]);
fnet12[6]=a12[5]*links[20].mcm[1] - a12[4]*links[20].mcm[2] + (links[20].mcm[3]*v12[2] + links[20].m*v12[4])*v12[5] + v12[4]*(links[20].mcm[3]*v12[1] - links[20].m*v12[5]) + (-(links[20].mcm[1]*v12[1]) - links[20].mcm[2]*v12[2])*v12[6] + v12[1]*(-(links[20].mcm[3]*v12[4]) - v12[2]*links[20].inertia[1][1] + v12[1]*links[20].inertia[1][2]) + a12[1]*links[20].inertia[1][3] + v12[2]*(-(links[20].mcm[3]*v12[5]) - v12[2]*links[20].inertia[1][2] + v12[1]*links[20].inertia[2][2]) + a12[2]*links[20].inertia[2][3] + v12[3]*(links[20].mcm[1]*v12[4] + links[20].mcm[2]*v12[5] - v12[2]*links[20].inertia[1][3] + v12[1]*links[20].inertia[2][3]) + a12[3]*links[20].inertia[3][3];

fnet13[1]=links[27].m*a13[4] - a13[3]*links[27].mcm[2] + a13[2]*links[27].mcm[3] - links[27].mcm[1]*Power(v13[2],2) - links[27].mcm[1]*Power(v13[3],2) + v13[1]*(links[27].mcm[2]*v13[2] + links[27].mcm[3]*v13[3]) - links[27].m*v13[3]*v13[5] + links[27].m*v13[2]*v13[6];
fnet13[2]=links[27].m*a13[5] + a13[3]*links[27].mcm[1] - a13[1]*links[27].mcm[3] - links[27].mcm[2]*Power(v13[1],2) - links[27].mcm[2]*Power(v13[3],2) + v13[2]*(links[27].mcm[1]*v13[1] + links[27].mcm[3]*v13[3]) + links[27].m*v13[3]*v13[4] - links[27].m*v13[1]*v13[6];
fnet13[3]=links[27].m*a13[6] - a13[2]*links[27].mcm[1] + a13[1]*links[27].mcm[2] - links[27].mcm[3]*Power(v13[1],2) - links[27].mcm[3]*Power(v13[2],2) + (links[27].mcm[1]*v13[1] + links[27].mcm[2]*v13[2])*v13[3] - links[27].m*v13[2]*v13[4] + links[27].m*v13[1]*v13[5];
fnet13[4]=a13[6]*links[27].mcm[2] - a13[5]*links[27].mcm[3] + (-(links[27].mcm[2]*v13[2]) - links[27].mcm[3]*v13[3])*v13[4] + (links[27].mcm[1]*v13[3] + links[27].m*v13[5])*v13[6] + v13[5]*(links[27].mcm[1]*v13[2] - links[27].m*v13[6]) + a13[1]*links[27].inertia[1][1] + a13[2]*links[27].inertia[1][2] + a13[3]*links[27].inertia[1][3] + v13[1]*(links[27].mcm[2]*v13[5] + links[27].mcm[3]*v13[6] - v13[3]*links[27].inertia[1][2] + v13[2]*links[27].inertia[1][3]) + v13[2]*(-(links[27].mcm[1]*v13[5]) - v13[3]*links[27].inertia[2][2] + v13[2]*links[27].inertia[2][3]) + v13[3]*(-(links[27].mcm[1]*v13[6]) - v13[3]*links[27].inertia[2][3] + v13[2]*links[27].inertia[3][3]);
fnet13[5]=-(a13[6]*links[27].mcm[1]) + a13[4]*links[27].mcm[3] + (-(links[27].mcm[1]*v13[1]) - links[27].mcm[3]*v13[3])*v13[5] + (links[27].mcm[2]*v13[3] - links[27].m*v13[4])*v13[6] + v13[4]*(links[27].mcm[2]*v13[1] + links[27].m*v13[6]) + a13[1]*links[27].inertia[1][2] + v13[1]*(-(links[27].mcm[2]*v13[4]) + v13[3]*links[27].inertia[1][1] - v13[1]*links[27].inertia[1][3]) + a13[2]*links[27].inertia[2][2] + a13[3]*links[27].inertia[2][3] + v13[2]*(links[27].mcm[1]*v13[4] + links[27].mcm[3]*v13[6] + v13[3]*links[27].inertia[1][2] - v13[1]*links[27].inertia[2][3]) + v13[3]*(-(links[27].mcm[2]*v13[6]) + v13[3]*links[27].inertia[1][3] - v13[1]*links[27].inertia[3][3]);
fnet13[6]=a13[5]*links[27].mcm[1] - a13[4]*links[27].mcm[2] + (links[27].mcm[3]*v13[2] + links[27].m*v13[4])*v13[5] + v13[4]*(links[27].mcm[3]*v13[1] - links[27].m*v13[5]) + (-(links[27].mcm[1]*v13[1]) - links[27].mcm[2]*v13[2])*v13[6] + v13[1]*(-(links[27].mcm[3]*v13[4]) - v13[2]*links[27].inertia[1][1] + v13[1]*links[27].inertia[1][2]) + a13[1]*links[27].inertia[1][3] + v13[2]*(-(links[27].mcm[3]*v13[5]) - v13[2]*links[27].inertia[1][2] + v13[1]*links[27].inertia[2][2]) + a13[2]*links[27].inertia[2][3] + v13[3]*(links[27].mcm[1]*v13[4] + links[27].mcm[2]*v13[5] - v13[2]*links[27].inertia[1][3] + v13[1]*links[27].inertia[2][3]) + a13[3]*links[27].inertia[3][3];

fnet14[1]=links[28].m*a14[4] - a14[3]*links[28].mcm[2] + a14[2]*links[28].mcm[3] - links[28].mcm[1]*Power(v14[2],2) - links[28].mcm[1]*Power(v14[3],2) + v14[1]*(links[28].mcm[2]*v14[2] + links[28].mcm[3]*v14[3]) - links[28].m*v14[3]*v14[5] + links[28].m*v14[2]*v14[6];
fnet14[2]=links[28].m*a14[5] + a14[3]*links[28].mcm[1] - a14[1]*links[28].mcm[3] - links[28].mcm[2]*Power(v14[1],2) - links[28].mcm[2]*Power(v14[3],2) + v14[2]*(links[28].mcm[1]*v14[1] + links[28].mcm[3]*v14[3]) + links[28].m*v14[3]*v14[4] - links[28].m*v14[1]*v14[6];
fnet14[3]=links[28].m*a14[6] - a14[2]*links[28].mcm[1] + a14[1]*links[28].mcm[2] - links[28].mcm[3]*Power(v14[1],2) - links[28].mcm[3]*Power(v14[2],2) + (links[28].mcm[1]*v14[1] + links[28].mcm[2]*v14[2])*v14[3] - links[28].m*v14[2]*v14[4] + links[28].m*v14[1]*v14[5];
fnet14[4]=a14[6]*links[28].mcm[2] - a14[5]*links[28].mcm[3] + (-(links[28].mcm[2]*v14[2]) - links[28].mcm[3]*v14[3])*v14[4] + (links[28].mcm[1]*v14[3] + links[28].m*v14[5])*v14[6] + v14[5]*(links[28].mcm[1]*v14[2] - links[28].m*v14[6]) + a14[1]*links[28].inertia[1][1] + a14[2]*links[28].inertia[1][2] + a14[3]*links[28].inertia[1][3] + v14[1]*(links[28].mcm[2]*v14[5] + links[28].mcm[3]*v14[6] - v14[3]*links[28].inertia[1][2] + v14[2]*links[28].inertia[1][3]) + v14[2]*(-(links[28].mcm[1]*v14[5]) - v14[3]*links[28].inertia[2][2] + v14[2]*links[28].inertia[2][3]) + v14[3]*(-(links[28].mcm[1]*v14[6]) - v14[3]*links[28].inertia[2][3] + v14[2]*links[28].inertia[3][3]);
fnet14[5]=-(a14[6]*links[28].mcm[1]) + a14[4]*links[28].mcm[3] + (-(links[28].mcm[1]*v14[1]) - links[28].mcm[3]*v14[3])*v14[5] + (links[28].mcm[2]*v14[3] - links[28].m*v14[4])*v14[6] + v14[4]*(links[28].mcm[2]*v14[1] + links[28].m*v14[6]) + a14[1]*links[28].inertia[1][2] + v14[1]*(-(links[28].mcm[2]*v14[4]) + v14[3]*links[28].inertia[1][1] - v14[1]*links[28].inertia[1][3]) + a14[2]*links[28].inertia[2][2] + a14[3]*links[28].inertia[2][3] + v14[2]*(links[28].mcm[1]*v14[4] + links[28].mcm[3]*v14[6] + v14[3]*links[28].inertia[1][2] - v14[1]*links[28].inertia[2][3]) + v14[3]*(-(links[28].mcm[2]*v14[6]) + v14[3]*links[28].inertia[1][3] - v14[1]*links[28].inertia[3][3]);
fnet14[6]=a14[5]*links[28].mcm[1] - a14[4]*links[28].mcm[2] + (links[28].mcm[3]*v14[2] + links[28].m*v14[4])*v14[5] + v14[4]*(links[28].mcm[3]*v14[1] - links[28].m*v14[5]) + (-(links[28].mcm[1]*v14[1]) - links[28].mcm[2]*v14[2])*v14[6] + v14[1]*(-(links[28].mcm[3]*v14[4]) - v14[2]*links[28].inertia[1][1] + v14[1]*links[28].inertia[1][2]) + a14[1]*links[28].inertia[1][3] + v14[2]*(-(links[28].mcm[3]*v14[5]) - v14[2]*links[28].inertia[1][2] + v14[1]*links[28].inertia[2][2]) + a14[2]*links[28].inertia[2][3] + v14[3]*(links[28].mcm[1]*v14[4] + links[28].mcm[2]*v14[5] - v14[2]*links[28].inertia[1][3] + v14[1]*links[28].inertia[2][3]) + a14[3]*links[28].inertia[3][3];

fnet17[1]=eff[4].m*a17[4] - a17[3]*eff[4].mcm[2] + a17[2]*eff[4].mcm[3] - eff[4].mcm[1]*Power(v17[2],2) - eff[4].mcm[1]*Power(v17[3],2) + v17[1]*(eff[4].mcm[2]*v17[2] + eff[4].mcm[3]*v17[3]) - eff[4].m*v17[3]*v17[5] + eff[4].m*v17[2]*v17[6];
fnet17[2]=eff[4].m*a17[5] + a17[3]*eff[4].mcm[1] - a17[1]*eff[4].mcm[3] - eff[4].mcm[2]*Power(v17[1],2) - eff[4].mcm[2]*Power(v17[3],2) + v17[2]*(eff[4].mcm[1]*v17[1] + eff[4].mcm[3]*v17[3]) + eff[4].m*v17[3]*v17[4] - eff[4].m*v17[1]*v17[6];
fnet17[3]=eff[4].m*a17[6] - a17[2]*eff[4].mcm[1] + a17[1]*eff[4].mcm[2] - eff[4].mcm[3]*Power(v17[1],2) - eff[4].mcm[3]*Power(v17[2],2) + (eff[4].mcm[1]*v17[1] + eff[4].mcm[2]*v17[2])*v17[3] - eff[4].m*v17[2]*v17[4] + eff[4].m*v17[1]*v17[5];
fnet17[4]=a17[6]*eff[4].mcm[2] - a17[5]*eff[4].mcm[3] + (-(eff[4].mcm[2]*v17[2]) - eff[4].mcm[3]*v17[3])*v17[4] - eff[4].mcm[1]*v17[2]*v17[5] - eff[4].mcm[1]*v17[3]*v17[6] + (eff[4].mcm[1]*v17[3] + eff[4].m*v17[5])*v17[6] + v17[5]*(eff[4].mcm[1]*v17[2] - eff[4].m*v17[6]) + v17[1]*(eff[4].mcm[2]*v17[5] + eff[4].mcm[3]*v17[6]);
fnet17[5]=-(a17[6]*eff[4].mcm[1]) + a17[4]*eff[4].mcm[3] - eff[4].mcm[2]*v17[1]*v17[4] + (-(eff[4].mcm[1]*v17[1]) - eff[4].mcm[3]*v17[3])*v17[5] - eff[4].mcm[2]*v17[3]*v17[6] + (eff[4].mcm[2]*v17[3] - eff[4].m*v17[4])*v17[6] + v17[4]*(eff[4].mcm[2]*v17[1] + eff[4].m*v17[6]) + v17[2]*(eff[4].mcm[1]*v17[4] + eff[4].mcm[3]*v17[6]);
fnet17[6]=a17[5]*eff[4].mcm[1] - a17[4]*eff[4].mcm[2] - eff[4].mcm[3]*v17[1]*v17[4] - eff[4].mcm[3]*v17[2]*v17[5] + (eff[4].mcm[3]*v17[2] + eff[4].m*v17[4])*v17[5] + v17[4]*(eff[4].mcm[3]*v17[1] - eff[4].m*v17[5]) + v17[3]*(eff[4].mcm[1]*v17[4] + eff[4].mcm[2]*v17[5]) + (-(eff[4].mcm[1]*v17[1]) - eff[4].mcm[2]*v17[2])*v17[6];

fnet18[1]=links[22].m*a18[4] - a18[3]*links[22].mcm[2] + a18[2]*links[22].mcm[3] - links[22].mcm[1]*Power(v18[2],2) - links[22].mcm[1]*Power(v18[3],2) + v18[1]*(links[22].mcm[2]*v18[2] + links[22].mcm[3]*v18[3]) - links[22].m*v18[3]*v18[5] + links[22].m*v18[2]*v18[6];
fnet18[2]=links[22].m*a18[5] + a18[3]*links[22].mcm[1] - a18[1]*links[22].mcm[3] - links[22].mcm[2]*Power(v18[1],2) - links[22].mcm[2]*Power(v18[3],2) + v18[2]*(links[22].mcm[1]*v18[1] + links[22].mcm[3]*v18[3]) + links[22].m*v18[3]*v18[4] - links[22].m*v18[1]*v18[6];
fnet18[3]=links[22].m*a18[6] - a18[2]*links[22].mcm[1] + a18[1]*links[22].mcm[2] - links[22].mcm[3]*Power(v18[1],2) - links[22].mcm[3]*Power(v18[2],2) + (links[22].mcm[1]*v18[1] + links[22].mcm[2]*v18[2])*v18[3] - links[22].m*v18[2]*v18[4] + links[22].m*v18[1]*v18[5];
fnet18[4]=a18[6]*links[22].mcm[2] - a18[5]*links[22].mcm[3] + (-(links[22].mcm[2]*v18[2]) - links[22].mcm[3]*v18[3])*v18[4] + (links[22].mcm[1]*v18[3] + links[22].m*v18[5])*v18[6] + v18[5]*(links[22].mcm[1]*v18[2] - links[22].m*v18[6]) + a18[1]*links[22].inertia[1][1] + a18[2]*links[22].inertia[1][2] + a18[3]*links[22].inertia[1][3] + v18[1]*(links[22].mcm[2]*v18[5] + links[22].mcm[3]*v18[6] - v18[3]*links[22].inertia[1][2] + v18[2]*links[22].inertia[1][3]) + v18[2]*(-(links[22].mcm[1]*v18[5]) - v18[3]*links[22].inertia[2][2] + v18[2]*links[22].inertia[2][3]) + v18[3]*(-(links[22].mcm[1]*v18[6]) - v18[3]*links[22].inertia[2][3] + v18[2]*links[22].inertia[3][3]);
fnet18[5]=-(a18[6]*links[22].mcm[1]) + a18[4]*links[22].mcm[3] + (-(links[22].mcm[1]*v18[1]) - links[22].mcm[3]*v18[3])*v18[5] + (links[22].mcm[2]*v18[3] - links[22].m*v18[4])*v18[6] + v18[4]*(links[22].mcm[2]*v18[1] + links[22].m*v18[6]) + a18[1]*links[22].inertia[1][2] + v18[1]*(-(links[22].mcm[2]*v18[4]) + v18[3]*links[22].inertia[1][1] - v18[1]*links[22].inertia[1][3]) + a18[2]*links[22].inertia[2][2] + a18[3]*links[22].inertia[2][3] + v18[2]*(links[22].mcm[1]*v18[4] + links[22].mcm[3]*v18[6] + v18[3]*links[22].inertia[1][2] - v18[1]*links[22].inertia[2][3]) + v18[3]*(-(links[22].mcm[2]*v18[6]) + v18[3]*links[22].inertia[1][3] - v18[1]*links[22].inertia[3][3]);
fnet18[6]=a18[5]*links[22].mcm[1] - a18[4]*links[22].mcm[2] + (links[22].mcm[3]*v18[2] + links[22].m*v18[4])*v18[5] + v18[4]*(links[22].mcm[3]*v18[1] - links[22].m*v18[5]) + (-(links[22].mcm[1]*v18[1]) - links[22].mcm[2]*v18[2])*v18[6] + v18[1]*(-(links[22].mcm[3]*v18[4]) - v18[2]*links[22].inertia[1][1] + v18[1]*links[22].inertia[1][2]) + a18[1]*links[22].inertia[1][3] + v18[2]*(-(links[22].mcm[3]*v18[5]) - v18[2]*links[22].inertia[1][2] + v18[1]*links[22].inertia[2][2]) + a18[2]*links[22].inertia[2][3] + v18[3]*(links[22].mcm[1]*v18[4] + links[22].mcm[2]*v18[5] - v18[2]*links[22].inertia[1][3] + v18[1]*links[22].inertia[2][3]) + a18[3]*links[22].inertia[3][3];

fnet20[1]=links[24].m*a20[4] - a20[3]*links[24].mcm[2] + a20[2]*links[24].mcm[3] - links[24].mcm[1]*Power(v20[2],2) - links[24].mcm[1]*Power(v20[3],2) + v20[1]*(links[24].mcm[2]*v20[2] + links[24].mcm[3]*v20[3]) - links[24].m*v20[3]*v20[5] + links[24].m*v20[2]*v20[6];
fnet20[2]=links[24].m*a20[5] + a20[3]*links[24].mcm[1] - a20[1]*links[24].mcm[3] - links[24].mcm[2]*Power(v20[1],2) - links[24].mcm[2]*Power(v20[3],2) + v20[2]*(links[24].mcm[1]*v20[1] + links[24].mcm[3]*v20[3]) + links[24].m*v20[3]*v20[4] - links[24].m*v20[1]*v20[6];
fnet20[3]=links[24].m*a20[6] - a20[2]*links[24].mcm[1] + a20[1]*links[24].mcm[2] - links[24].mcm[3]*Power(v20[1],2) - links[24].mcm[3]*Power(v20[2],2) + (links[24].mcm[1]*v20[1] + links[24].mcm[2]*v20[2])*v20[3] - links[24].m*v20[2]*v20[4] + links[24].m*v20[1]*v20[5];
fnet20[4]=a20[6]*links[24].mcm[2] - a20[5]*links[24].mcm[3] + (-(links[24].mcm[2]*v20[2]) - links[24].mcm[3]*v20[3])*v20[4] + (links[24].mcm[1]*v20[3] + links[24].m*v20[5])*v20[6] + v20[5]*(links[24].mcm[1]*v20[2] - links[24].m*v20[6]) + a20[1]*links[24].inertia[1][1] + a20[2]*links[24].inertia[1][2] + a20[3]*links[24].inertia[1][3] + v20[1]*(links[24].mcm[2]*v20[5] + links[24].mcm[3]*v20[6] - v20[3]*links[24].inertia[1][2] + v20[2]*links[24].inertia[1][3]) + v20[2]*(-(links[24].mcm[1]*v20[5]) - v20[3]*links[24].inertia[2][2] + v20[2]*links[24].inertia[2][3]) + v20[3]*(-(links[24].mcm[1]*v20[6]) - v20[3]*links[24].inertia[2][3] + v20[2]*links[24].inertia[3][3]);
fnet20[5]=-(a20[6]*links[24].mcm[1]) + a20[4]*links[24].mcm[3] + (-(links[24].mcm[1]*v20[1]) - links[24].mcm[3]*v20[3])*v20[5] + (links[24].mcm[2]*v20[3] - links[24].m*v20[4])*v20[6] + v20[4]*(links[24].mcm[2]*v20[1] + links[24].m*v20[6]) + a20[1]*links[24].inertia[1][2] + v20[1]*(-(links[24].mcm[2]*v20[4]) + v20[3]*links[24].inertia[1][1] - v20[1]*links[24].inertia[1][3]) + a20[2]*links[24].inertia[2][2] + a20[3]*links[24].inertia[2][3] + v20[2]*(links[24].mcm[1]*v20[4] + links[24].mcm[3]*v20[6] + v20[3]*links[24].inertia[1][2] - v20[1]*links[24].inertia[2][3]) + v20[3]*(-(links[24].mcm[2]*v20[6]) + v20[3]*links[24].inertia[1][3] - v20[1]*links[24].inertia[3][3]);
fnet20[6]=a20[5]*links[24].mcm[1] - a20[4]*links[24].mcm[2] + (links[24].mcm[3]*v20[2] + links[24].m*v20[4])*v20[5] + v20[4]*(links[24].mcm[3]*v20[1] - links[24].m*v20[5]) + (-(links[24].mcm[1]*v20[1]) - links[24].mcm[2]*v20[2])*v20[6] + v20[1]*(-(links[24].mcm[3]*v20[4]) - v20[2]*links[24].inertia[1][1] + v20[1]*links[24].inertia[1][2]) + a20[1]*links[24].inertia[1][3] + v20[2]*(-(links[24].mcm[3]*v20[5]) - v20[2]*links[24].inertia[1][2] + v20[1]*links[24].inertia[2][2]) + a20[2]*links[24].inertia[2][3] + v20[3]*(links[24].mcm[1]*v20[4] + links[24].mcm[2]*v20[5] - v20[2]*links[24].inertia[1][3] + v20[1]*links[24].inertia[2][3]) + a20[3]*links[24].inertia[3][3];

fnet21[1]=links[21].m*a21[4] - a21[3]*links[21].mcm[2] + a21[2]*links[21].mcm[3] - links[21].mcm[1]*Power(v21[2],2) - links[21].mcm[1]*Power(v21[3],2) + v21[1]*(links[21].mcm[2]*v21[2] + links[21].mcm[3]*v21[3]) - links[21].m*v21[3]*v21[5] + links[21].m*v21[2]*v21[6];
fnet21[2]=links[21].m*a21[5] + a21[3]*links[21].mcm[1] - a21[1]*links[21].mcm[3] - links[21].mcm[2]*Power(v21[1],2) - links[21].mcm[2]*Power(v21[3],2) + v21[2]*(links[21].mcm[1]*v21[1] + links[21].mcm[3]*v21[3]) + links[21].m*v21[3]*v21[4] - links[21].m*v21[1]*v21[6];
fnet21[3]=links[21].m*a21[6] - a21[2]*links[21].mcm[1] + a21[1]*links[21].mcm[2] - links[21].mcm[3]*Power(v21[1],2) - links[21].mcm[3]*Power(v21[2],2) + (links[21].mcm[1]*v21[1] + links[21].mcm[2]*v21[2])*v21[3] - links[21].m*v21[2]*v21[4] + links[21].m*v21[1]*v21[5];
fnet21[4]=a21[6]*links[21].mcm[2] - a21[5]*links[21].mcm[3] + (-(links[21].mcm[2]*v21[2]) - links[21].mcm[3]*v21[3])*v21[4] + (links[21].mcm[1]*v21[3] + links[21].m*v21[5])*v21[6] + v21[5]*(links[21].mcm[1]*v21[2] - links[21].m*v21[6]) + a21[1]*links[21].inertia[1][1] + a21[2]*links[21].inertia[1][2] + a21[3]*links[21].inertia[1][3] + v21[1]*(links[21].mcm[2]*v21[5] + links[21].mcm[3]*v21[6] - v21[3]*links[21].inertia[1][2] + v21[2]*links[21].inertia[1][3]) + v21[2]*(-(links[21].mcm[1]*v21[5]) - v21[3]*links[21].inertia[2][2] + v21[2]*links[21].inertia[2][3]) + v21[3]*(-(links[21].mcm[1]*v21[6]) - v21[3]*links[21].inertia[2][3] + v21[2]*links[21].inertia[3][3]);
fnet21[5]=-(a21[6]*links[21].mcm[1]) + a21[4]*links[21].mcm[3] + (-(links[21].mcm[1]*v21[1]) - links[21].mcm[3]*v21[3])*v21[5] + (links[21].mcm[2]*v21[3] - links[21].m*v21[4])*v21[6] + v21[4]*(links[21].mcm[2]*v21[1] + links[21].m*v21[6]) + a21[1]*links[21].inertia[1][2] + v21[1]*(-(links[21].mcm[2]*v21[4]) + v21[3]*links[21].inertia[1][1] - v21[1]*links[21].inertia[1][3]) + a21[2]*links[21].inertia[2][2] + a21[3]*links[21].inertia[2][3] + v21[2]*(links[21].mcm[1]*v21[4] + links[21].mcm[3]*v21[6] + v21[3]*links[21].inertia[1][2] - v21[1]*links[21].inertia[2][3]) + v21[3]*(-(links[21].mcm[2]*v21[6]) + v21[3]*links[21].inertia[1][3] - v21[1]*links[21].inertia[3][3]);
fnet21[6]=a21[5]*links[21].mcm[1] - a21[4]*links[21].mcm[2] + (links[21].mcm[3]*v21[2] + links[21].m*v21[4])*v21[5] + v21[4]*(links[21].mcm[3]*v21[1] - links[21].m*v21[5]) + (-(links[21].mcm[1]*v21[1]) - links[21].mcm[2]*v21[2])*v21[6] + v21[1]*(-(links[21].mcm[3]*v21[4]) - v21[2]*links[21].inertia[1][1] + v21[1]*links[21].inertia[1][2]) + a21[1]*links[21].inertia[1][3] + v21[2]*(-(links[21].mcm[3]*v21[5]) - v21[2]*links[21].inertia[1][2] + v21[1]*links[21].inertia[2][2]) + a21[2]*links[21].inertia[2][3] + v21[3]*(links[21].mcm[1]*v21[4] + links[21].mcm[2]*v21[5] - v21[2]*links[21].inertia[1][3] + v21[1]*links[21].inertia[2][3]) + a21[3]*links[21].inertia[3][3];

fnet22[1]=links[1].m*a22[4] - a22[3]*links[1].mcm[2] + a22[2]*links[1].mcm[3] - links[1].mcm[1]*Power(v22[2],2) - links[1].mcm[1]*Power(v22[3],2) + v22[1]*(links[1].mcm[2]*v22[2] + links[1].mcm[3]*v22[3]) - links[1].m*v22[3]*v22[5] + links[1].m*v22[2]*v22[6];
fnet22[2]=links[1].m*a22[5] + a22[3]*links[1].mcm[1] - a22[1]*links[1].mcm[3] - links[1].mcm[2]*Power(v22[1],2) - links[1].mcm[2]*Power(v22[3],2) + v22[2]*(links[1].mcm[1]*v22[1] + links[1].mcm[3]*v22[3]) + links[1].m*v22[3]*v22[4] - links[1].m*v22[1]*v22[6];
fnet22[3]=links[1].m*a22[6] - a22[2]*links[1].mcm[1] + a22[1]*links[1].mcm[2] - links[1].mcm[3]*Power(v22[1],2) - links[1].mcm[3]*Power(v22[2],2) + (links[1].mcm[1]*v22[1] + links[1].mcm[2]*v22[2])*v22[3] - links[1].m*v22[2]*v22[4] + links[1].m*v22[1]*v22[5];
fnet22[4]=a22[6]*links[1].mcm[2] - a22[5]*links[1].mcm[3] + (-(links[1].mcm[2]*v22[2]) - links[1].mcm[3]*v22[3])*v22[4] + (links[1].mcm[1]*v22[3] + links[1].m*v22[5])*v22[6] + v22[5]*(links[1].mcm[1]*v22[2] - links[1].m*v22[6]) + a22[1]*links[1].inertia[1][1] + a22[2]*links[1].inertia[1][2] + a22[3]*links[1].inertia[1][3] + v22[1]*(links[1].mcm[2]*v22[5] + links[1].mcm[3]*v22[6] - v22[3]*links[1].inertia[1][2] + v22[2]*links[1].inertia[1][3]) + v22[2]*(-(links[1].mcm[1]*v22[5]) - v22[3]*links[1].inertia[2][2] + v22[2]*links[1].inertia[2][3]) + v22[3]*(-(links[1].mcm[1]*v22[6]) - v22[3]*links[1].inertia[2][3] + v22[2]*links[1].inertia[3][3]);
fnet22[5]=-(a22[6]*links[1].mcm[1]) + a22[4]*links[1].mcm[3] + (-(links[1].mcm[1]*v22[1]) - links[1].mcm[3]*v22[3])*v22[5] + (links[1].mcm[2]*v22[3] - links[1].m*v22[4])*v22[6] + v22[4]*(links[1].mcm[2]*v22[1] + links[1].m*v22[6]) + a22[1]*links[1].inertia[1][2] + v22[1]*(-(links[1].mcm[2]*v22[4]) + v22[3]*links[1].inertia[1][1] - v22[1]*links[1].inertia[1][3]) + a22[2]*links[1].inertia[2][2] + a22[3]*links[1].inertia[2][3] + v22[2]*(links[1].mcm[1]*v22[4] + links[1].mcm[3]*v22[6] + v22[3]*links[1].inertia[1][2] - v22[1]*links[1].inertia[2][3]) + v22[3]*(-(links[1].mcm[2]*v22[6]) + v22[3]*links[1].inertia[1][3] - v22[1]*links[1].inertia[3][3]);
fnet22[6]=a22[5]*links[1].mcm[1] - a22[4]*links[1].mcm[2] + (links[1].mcm[3]*v22[2] + links[1].m*v22[4])*v22[5] + v22[4]*(links[1].mcm[3]*v22[1] - links[1].m*v22[5]) + (-(links[1].mcm[1]*v22[1]) - links[1].mcm[2]*v22[2])*v22[6] + v22[1]*(-(links[1].mcm[3]*v22[4]) - v22[2]*links[1].inertia[1][1] + v22[1]*links[1].inertia[1][2]) + a22[1]*links[1].inertia[1][3] + v22[2]*(-(links[1].mcm[3]*v22[5]) - v22[2]*links[1].inertia[1][2] + v22[1]*links[1].inertia[2][2]) + a22[2]*links[1].inertia[2][3] + v22[3]*(links[1].mcm[1]*v22[4] + links[1].mcm[2]*v22[5] - v22[2]*links[1].inertia[1][3] + v22[1]*links[1].inertia[2][3]) + a22[3]*links[1].inertia[3][3];

fnet23[1]=links[2].m*a23[4] - a23[3]*links[2].mcm[2] + a23[2]*links[2].mcm[3] - links[2].mcm[1]*Power(v23[2],2) - links[2].mcm[1]*Power(v23[3],2) + v23[1]*(links[2].mcm[2]*v23[2] + links[2].mcm[3]*v23[3]) - links[2].m*v23[3]*v23[5] + links[2].m*v23[2]*v23[6];
fnet23[2]=links[2].m*a23[5] + a23[3]*links[2].mcm[1] - a23[1]*links[2].mcm[3] - links[2].mcm[2]*Power(v23[1],2) - links[2].mcm[2]*Power(v23[3],2) + v23[2]*(links[2].mcm[1]*v23[1] + links[2].mcm[3]*v23[3]) + links[2].m*v23[3]*v23[4] - links[2].m*v23[1]*v23[6];
fnet23[3]=links[2].m*a23[6] - a23[2]*links[2].mcm[1] + a23[1]*links[2].mcm[2] - links[2].mcm[3]*Power(v23[1],2) - links[2].mcm[3]*Power(v23[2],2) + (links[2].mcm[1]*v23[1] + links[2].mcm[2]*v23[2])*v23[3] - links[2].m*v23[2]*v23[4] + links[2].m*v23[1]*v23[5];
fnet23[4]=a23[6]*links[2].mcm[2] - a23[5]*links[2].mcm[3] + (-(links[2].mcm[2]*v23[2]) - links[2].mcm[3]*v23[3])*v23[4] + (links[2].mcm[1]*v23[3] + links[2].m*v23[5])*v23[6] + v23[5]*(links[2].mcm[1]*v23[2] - links[2].m*v23[6]) + a23[1]*links[2].inertia[1][1] + a23[2]*links[2].inertia[1][2] + a23[3]*links[2].inertia[1][3] + v23[1]*(links[2].mcm[2]*v23[5] + links[2].mcm[3]*v23[6] - v23[3]*links[2].inertia[1][2] + v23[2]*links[2].inertia[1][3]) + v23[2]*(-(links[2].mcm[1]*v23[5]) - v23[3]*links[2].inertia[2][2] + v23[2]*links[2].inertia[2][3]) + v23[3]*(-(links[2].mcm[1]*v23[6]) - v23[3]*links[2].inertia[2][3] + v23[2]*links[2].inertia[3][3]);
fnet23[5]=-(a23[6]*links[2].mcm[1]) + a23[4]*links[2].mcm[3] + (-(links[2].mcm[1]*v23[1]) - links[2].mcm[3]*v23[3])*v23[5] + (links[2].mcm[2]*v23[3] - links[2].m*v23[4])*v23[6] + v23[4]*(links[2].mcm[2]*v23[1] + links[2].m*v23[6]) + a23[1]*links[2].inertia[1][2] + v23[1]*(-(links[2].mcm[2]*v23[4]) + v23[3]*links[2].inertia[1][1] - v23[1]*links[2].inertia[1][3]) + a23[2]*links[2].inertia[2][2] + a23[3]*links[2].inertia[2][3] + v23[2]*(links[2].mcm[1]*v23[4] + links[2].mcm[3]*v23[6] + v23[3]*links[2].inertia[1][2] - v23[1]*links[2].inertia[2][3]) + v23[3]*(-(links[2].mcm[2]*v23[6]) + v23[3]*links[2].inertia[1][3] - v23[1]*links[2].inertia[3][3]);
fnet23[6]=a23[5]*links[2].mcm[1] - a23[4]*links[2].mcm[2] + (links[2].mcm[3]*v23[2] + links[2].m*v23[4])*v23[5] + v23[4]*(links[2].mcm[3]*v23[1] - links[2].m*v23[5]) + (-(links[2].mcm[1]*v23[1]) - links[2].mcm[2]*v23[2])*v23[6] + v23[1]*(-(links[2].mcm[3]*v23[4]) - v23[2]*links[2].inertia[1][1] + v23[1]*links[2].inertia[1][2]) + a23[1]*links[2].inertia[1][3] + v23[2]*(-(links[2].mcm[3]*v23[5]) - v23[2]*links[2].inertia[1][2] + v23[1]*links[2].inertia[2][2]) + a23[2]*links[2].inertia[2][3] + v23[3]*(links[2].mcm[1]*v23[4] + links[2].mcm[2]*v23[5] - v23[2]*links[2].inertia[1][3] + v23[1]*links[2].inertia[2][3]) + a23[3]*links[2].inertia[3][3];

fnet24[1]=links[3].m*a24[4] - a24[3]*links[3].mcm[2] + a24[2]*links[3].mcm[3] - links[3].mcm[1]*Power(v24[2],2) - links[3].mcm[1]*Power(v24[3],2) + v24[1]*(links[3].mcm[2]*v24[2] + links[3].mcm[3]*v24[3]) - links[3].m*v24[3]*v24[5] + links[3].m*v24[2]*v24[6];
fnet24[2]=links[3].m*a24[5] + a24[3]*links[3].mcm[1] - a24[1]*links[3].mcm[3] - links[3].mcm[2]*Power(v24[1],2) - links[3].mcm[2]*Power(v24[3],2) + v24[2]*(links[3].mcm[1]*v24[1] + links[3].mcm[3]*v24[3]) + links[3].m*v24[3]*v24[4] - links[3].m*v24[1]*v24[6];
fnet24[3]=links[3].m*a24[6] - a24[2]*links[3].mcm[1] + a24[1]*links[3].mcm[2] - links[3].mcm[3]*Power(v24[1],2) - links[3].mcm[3]*Power(v24[2],2) + (links[3].mcm[1]*v24[1] + links[3].mcm[2]*v24[2])*v24[3] - links[3].m*v24[2]*v24[4] + links[3].m*v24[1]*v24[5];
fnet24[4]=a24[6]*links[3].mcm[2] - a24[5]*links[3].mcm[3] + (-(links[3].mcm[2]*v24[2]) - links[3].mcm[3]*v24[3])*v24[4] + (links[3].mcm[1]*v24[3] + links[3].m*v24[5])*v24[6] + v24[5]*(links[3].mcm[1]*v24[2] - links[3].m*v24[6]) + a24[1]*links[3].inertia[1][1] + a24[2]*links[3].inertia[1][2] + a24[3]*links[3].inertia[1][3] + v24[1]*(links[3].mcm[2]*v24[5] + links[3].mcm[3]*v24[6] - v24[3]*links[3].inertia[1][2] + v24[2]*links[3].inertia[1][3]) + v24[2]*(-(links[3].mcm[1]*v24[5]) - v24[3]*links[3].inertia[2][2] + v24[2]*links[3].inertia[2][3]) + v24[3]*(-(links[3].mcm[1]*v24[6]) - v24[3]*links[3].inertia[2][3] + v24[2]*links[3].inertia[3][3]);
fnet24[5]=-(a24[6]*links[3].mcm[1]) + a24[4]*links[3].mcm[3] + (-(links[3].mcm[1]*v24[1]) - links[3].mcm[3]*v24[3])*v24[5] + (links[3].mcm[2]*v24[3] - links[3].m*v24[4])*v24[6] + v24[4]*(links[3].mcm[2]*v24[1] + links[3].m*v24[6]) + a24[1]*links[3].inertia[1][2] + v24[1]*(-(links[3].mcm[2]*v24[4]) + v24[3]*links[3].inertia[1][1] - v24[1]*links[3].inertia[1][3]) + a24[2]*links[3].inertia[2][2] + a24[3]*links[3].inertia[2][3] + v24[2]*(links[3].mcm[1]*v24[4] + links[3].mcm[3]*v24[6] + v24[3]*links[3].inertia[1][2] - v24[1]*links[3].inertia[2][3]) + v24[3]*(-(links[3].mcm[2]*v24[6]) + v24[3]*links[3].inertia[1][3] - v24[1]*links[3].inertia[3][3]);
fnet24[6]=a24[5]*links[3].mcm[1] - a24[4]*links[3].mcm[2] + (links[3].mcm[3]*v24[2] + links[3].m*v24[4])*v24[5] + v24[4]*(links[3].mcm[3]*v24[1] - links[3].m*v24[5]) + (-(links[3].mcm[1]*v24[1]) - links[3].mcm[2]*v24[2])*v24[6] + v24[1]*(-(links[3].mcm[3]*v24[4]) - v24[2]*links[3].inertia[1][1] + v24[1]*links[3].inertia[1][2]) + a24[1]*links[3].inertia[1][3] + v24[2]*(-(links[3].mcm[3]*v24[5]) - v24[2]*links[3].inertia[1][2] + v24[1]*links[3].inertia[2][2]) + a24[2]*links[3].inertia[2][3] + v24[3]*(links[3].mcm[1]*v24[4] + links[3].mcm[2]*v24[5] - v24[2]*links[3].inertia[1][3] + v24[1]*links[3].inertia[2][3]) + a24[3]*links[3].inertia[3][3];

fnet25[1]=links[4].m*a25[4] - a25[3]*links[4].mcm[2] + a25[2]*links[4].mcm[3] - links[4].mcm[1]*Power(v25[2],2) - links[4].mcm[1]*Power(v25[3],2) + v25[1]*(links[4].mcm[2]*v25[2] + links[4].mcm[3]*v25[3]) - links[4].m*v25[3]*v25[5] + links[4].m*v25[2]*v25[6];
fnet25[2]=links[4].m*a25[5] + a25[3]*links[4].mcm[1] - a25[1]*links[4].mcm[3] - links[4].mcm[2]*Power(v25[1],2) - links[4].mcm[2]*Power(v25[3],2) + v25[2]*(links[4].mcm[1]*v25[1] + links[4].mcm[3]*v25[3]) + links[4].m*v25[3]*v25[4] - links[4].m*v25[1]*v25[6];
fnet25[3]=links[4].m*a25[6] - a25[2]*links[4].mcm[1] + a25[1]*links[4].mcm[2] - links[4].mcm[3]*Power(v25[1],2) - links[4].mcm[3]*Power(v25[2],2) + (links[4].mcm[1]*v25[1] + links[4].mcm[2]*v25[2])*v25[3] - links[4].m*v25[2]*v25[4] + links[4].m*v25[1]*v25[5];
fnet25[4]=a25[6]*links[4].mcm[2] - a25[5]*links[4].mcm[3] + (-(links[4].mcm[2]*v25[2]) - links[4].mcm[3]*v25[3])*v25[4] + (links[4].mcm[1]*v25[3] + links[4].m*v25[5])*v25[6] + v25[5]*(links[4].mcm[1]*v25[2] - links[4].m*v25[6]) + a25[1]*links[4].inertia[1][1] + a25[2]*links[4].inertia[1][2] + a25[3]*links[4].inertia[1][3] + v25[1]*(links[4].mcm[2]*v25[5] + links[4].mcm[3]*v25[6] - v25[3]*links[4].inertia[1][2] + v25[2]*links[4].inertia[1][3]) + v25[2]*(-(links[4].mcm[1]*v25[5]) - v25[3]*links[4].inertia[2][2] + v25[2]*links[4].inertia[2][3]) + v25[3]*(-(links[4].mcm[1]*v25[6]) - v25[3]*links[4].inertia[2][3] + v25[2]*links[4].inertia[3][3]);
fnet25[5]=-(a25[6]*links[4].mcm[1]) + a25[4]*links[4].mcm[3] + (-(links[4].mcm[1]*v25[1]) - links[4].mcm[3]*v25[3])*v25[5] + (links[4].mcm[2]*v25[3] - links[4].m*v25[4])*v25[6] + v25[4]*(links[4].mcm[2]*v25[1] + links[4].m*v25[6]) + a25[1]*links[4].inertia[1][2] + v25[1]*(-(links[4].mcm[2]*v25[4]) + v25[3]*links[4].inertia[1][1] - v25[1]*links[4].inertia[1][3]) + a25[2]*links[4].inertia[2][2] + a25[3]*links[4].inertia[2][3] + v25[2]*(links[4].mcm[1]*v25[4] + links[4].mcm[3]*v25[6] + v25[3]*links[4].inertia[1][2] - v25[1]*links[4].inertia[2][3]) + v25[3]*(-(links[4].mcm[2]*v25[6]) + v25[3]*links[4].inertia[1][3] - v25[1]*links[4].inertia[3][3]);
fnet25[6]=a25[5]*links[4].mcm[1] - a25[4]*links[4].mcm[2] + (links[4].mcm[3]*v25[2] + links[4].m*v25[4])*v25[5] + v25[4]*(links[4].mcm[3]*v25[1] - links[4].m*v25[5]) + (-(links[4].mcm[1]*v25[1]) - links[4].mcm[2]*v25[2])*v25[6] + v25[1]*(-(links[4].mcm[3]*v25[4]) - v25[2]*links[4].inertia[1][1] + v25[1]*links[4].inertia[1][2]) + a25[1]*links[4].inertia[1][3] + v25[2]*(-(links[4].mcm[3]*v25[5]) - v25[2]*links[4].inertia[1][2] + v25[1]*links[4].inertia[2][2]) + a25[2]*links[4].inertia[2][3] + v25[3]*(links[4].mcm[1]*v25[4] + links[4].mcm[2]*v25[5] - v25[2]*links[4].inertia[1][3] + v25[1]*links[4].inertia[2][3]) + a25[3]*links[4].inertia[3][3];

fnet26[1]=links[5].m*a26[4] - a26[3]*links[5].mcm[2] + a26[2]*links[5].mcm[3] - links[5].mcm[1]*Power(v26[2],2) - links[5].mcm[1]*Power(v26[3],2) + v26[1]*(links[5].mcm[2]*v26[2] + links[5].mcm[3]*v26[3]) - links[5].m*v26[3]*v26[5] + links[5].m*v26[2]*v26[6];
fnet26[2]=links[5].m*a26[5] + a26[3]*links[5].mcm[1] - a26[1]*links[5].mcm[3] - links[5].mcm[2]*Power(v26[1],2) - links[5].mcm[2]*Power(v26[3],2) + v26[2]*(links[5].mcm[1]*v26[1] + links[5].mcm[3]*v26[3]) + links[5].m*v26[3]*v26[4] - links[5].m*v26[1]*v26[6];
fnet26[3]=links[5].m*a26[6] - a26[2]*links[5].mcm[1] + a26[1]*links[5].mcm[2] - links[5].mcm[3]*Power(v26[1],2) - links[5].mcm[3]*Power(v26[2],2) + (links[5].mcm[1]*v26[1] + links[5].mcm[2]*v26[2])*v26[3] - links[5].m*v26[2]*v26[4] + links[5].m*v26[1]*v26[5];
fnet26[4]=a26[6]*links[5].mcm[2] - a26[5]*links[5].mcm[3] + (-(links[5].mcm[2]*v26[2]) - links[5].mcm[3]*v26[3])*v26[4] + (links[5].mcm[1]*v26[3] + links[5].m*v26[5])*v26[6] + v26[5]*(links[5].mcm[1]*v26[2] - links[5].m*v26[6]) + a26[1]*links[5].inertia[1][1] + a26[2]*links[5].inertia[1][2] + a26[3]*links[5].inertia[1][3] + v26[1]*(links[5].mcm[2]*v26[5] + links[5].mcm[3]*v26[6] - v26[3]*links[5].inertia[1][2] + v26[2]*links[5].inertia[1][3]) + v26[2]*(-(links[5].mcm[1]*v26[5]) - v26[3]*links[5].inertia[2][2] + v26[2]*links[5].inertia[2][3]) + v26[3]*(-(links[5].mcm[1]*v26[6]) - v26[3]*links[5].inertia[2][3] + v26[2]*links[5].inertia[3][3]);
fnet26[5]=-(a26[6]*links[5].mcm[1]) + a26[4]*links[5].mcm[3] + (-(links[5].mcm[1]*v26[1]) - links[5].mcm[3]*v26[3])*v26[5] + (links[5].mcm[2]*v26[3] - links[5].m*v26[4])*v26[6] + v26[4]*(links[5].mcm[2]*v26[1] + links[5].m*v26[6]) + a26[1]*links[5].inertia[1][2] + v26[1]*(-(links[5].mcm[2]*v26[4]) + v26[3]*links[5].inertia[1][1] - v26[1]*links[5].inertia[1][3]) + a26[2]*links[5].inertia[2][2] + a26[3]*links[5].inertia[2][3] + v26[2]*(links[5].mcm[1]*v26[4] + links[5].mcm[3]*v26[6] + v26[3]*links[5].inertia[1][2] - v26[1]*links[5].inertia[2][3]) + v26[3]*(-(links[5].mcm[2]*v26[6]) + v26[3]*links[5].inertia[1][3] - v26[1]*links[5].inertia[3][3]);
fnet26[6]=a26[5]*links[5].mcm[1] - a26[4]*links[5].mcm[2] + (links[5].mcm[3]*v26[2] + links[5].m*v26[4])*v26[5] + v26[4]*(links[5].mcm[3]*v26[1] - links[5].m*v26[5]) + (-(links[5].mcm[1]*v26[1]) - links[5].mcm[2]*v26[2])*v26[6] + v26[1]*(-(links[5].mcm[3]*v26[4]) - v26[2]*links[5].inertia[1][1] + v26[1]*links[5].inertia[1][2]) + a26[1]*links[5].inertia[1][3] + v26[2]*(-(links[5].mcm[3]*v26[5]) - v26[2]*links[5].inertia[1][2] + v26[1]*links[5].inertia[2][2]) + a26[2]*links[5].inertia[2][3] + v26[3]*(links[5].mcm[1]*v26[4] + links[5].mcm[2]*v26[5] - v26[2]*links[5].inertia[1][3] + v26[1]*links[5].inertia[2][3]) + a26[3]*links[5].inertia[3][3];

fnet27[1]=links[6].m*a27[4] - a27[3]*links[6].mcm[2] + a27[2]*links[6].mcm[3] - links[6].mcm[1]*Power(v27[2],2) - links[6].mcm[1]*Power(v27[3],2) + v27[1]*(links[6].mcm[2]*v27[2] + links[6].mcm[3]*v27[3]) - links[6].m*v27[3]*v27[5] + links[6].m*v27[2]*v27[6];
fnet27[2]=links[6].m*a27[5] + a27[3]*links[6].mcm[1] - a27[1]*links[6].mcm[3] - links[6].mcm[2]*Power(v27[1],2) - links[6].mcm[2]*Power(v27[3],2) + v27[2]*(links[6].mcm[1]*v27[1] + links[6].mcm[3]*v27[3]) + links[6].m*v27[3]*v27[4] - links[6].m*v27[1]*v27[6];
fnet27[3]=links[6].m*a27[6] - a27[2]*links[6].mcm[1] + a27[1]*links[6].mcm[2] - links[6].mcm[3]*Power(v27[1],2) - links[6].mcm[3]*Power(v27[2],2) + (links[6].mcm[1]*v27[1] + links[6].mcm[2]*v27[2])*v27[3] - links[6].m*v27[2]*v27[4] + links[6].m*v27[1]*v27[5];
fnet27[4]=a27[6]*links[6].mcm[2] - a27[5]*links[6].mcm[3] + (-(links[6].mcm[2]*v27[2]) - links[6].mcm[3]*v27[3])*v27[4] + (links[6].mcm[1]*v27[3] + links[6].m*v27[5])*v27[6] + v27[5]*(links[6].mcm[1]*v27[2] - links[6].m*v27[6]) + a27[1]*links[6].inertia[1][1] + a27[2]*links[6].inertia[1][2] + a27[3]*links[6].inertia[1][3] + v27[1]*(links[6].mcm[2]*v27[5] + links[6].mcm[3]*v27[6] - v27[3]*links[6].inertia[1][2] + v27[2]*links[6].inertia[1][3]) + v27[2]*(-(links[6].mcm[1]*v27[5]) - v27[3]*links[6].inertia[2][2] + v27[2]*links[6].inertia[2][3]) + v27[3]*(-(links[6].mcm[1]*v27[6]) - v27[3]*links[6].inertia[2][3] + v27[2]*links[6].inertia[3][3]);
fnet27[5]=-(a27[6]*links[6].mcm[1]) + a27[4]*links[6].mcm[3] + (-(links[6].mcm[1]*v27[1]) - links[6].mcm[3]*v27[3])*v27[5] + (links[6].mcm[2]*v27[3] - links[6].m*v27[4])*v27[6] + v27[4]*(links[6].mcm[2]*v27[1] + links[6].m*v27[6]) + a27[1]*links[6].inertia[1][2] + v27[1]*(-(links[6].mcm[2]*v27[4]) + v27[3]*links[6].inertia[1][1] - v27[1]*links[6].inertia[1][3]) + a27[2]*links[6].inertia[2][2] + a27[3]*links[6].inertia[2][3] + v27[2]*(links[6].mcm[1]*v27[4] + links[6].mcm[3]*v27[6] + v27[3]*links[6].inertia[1][2] - v27[1]*links[6].inertia[2][3]) + v27[3]*(-(links[6].mcm[2]*v27[6]) + v27[3]*links[6].inertia[1][3] - v27[1]*links[6].inertia[3][3]);
fnet27[6]=a27[5]*links[6].mcm[1] - a27[4]*links[6].mcm[2] + (links[6].mcm[3]*v27[2] + links[6].m*v27[4])*v27[5] + v27[4]*(links[6].mcm[3]*v27[1] - links[6].m*v27[5]) + (-(links[6].mcm[1]*v27[1]) - links[6].mcm[2]*v27[2])*v27[6] + v27[1]*(-(links[6].mcm[3]*v27[4]) - v27[2]*links[6].inertia[1][1] + v27[1]*links[6].inertia[1][2]) + a27[1]*links[6].inertia[1][3] + v27[2]*(-(links[6].mcm[3]*v27[5]) - v27[2]*links[6].inertia[1][2] + v27[1]*links[6].inertia[2][2]) + a27[2]*links[6].inertia[2][3] + v27[3]*(links[6].mcm[1]*v27[4] + links[6].mcm[2]*v27[5] - v27[2]*links[6].inertia[1][3] + v27[1]*links[6].inertia[2][3]) + a27[3]*links[6].inertia[3][3];

fnet32[1]=eff[1].m*a32[4] - a32[3]*eff[1].mcm[2] + a32[2]*eff[1].mcm[3] - eff[1].mcm[1]*Power(v32[2],2) - eff[1].mcm[1]*Power(v32[3],2) + v32[1]*(eff[1].mcm[2]*v32[2] + eff[1].mcm[3]*v32[3]) - eff[1].m*v32[3]*v32[5] + eff[1].m*v32[2]*v32[6];
fnet32[2]=eff[1].m*a32[5] + a32[3]*eff[1].mcm[1] - a32[1]*eff[1].mcm[3] - eff[1].mcm[2]*Power(v32[1],2) - eff[1].mcm[2]*Power(v32[3],2) + v32[2]*(eff[1].mcm[1]*v32[1] + eff[1].mcm[3]*v32[3]) + eff[1].m*v32[3]*v32[4] - eff[1].m*v32[1]*v32[6];
fnet32[3]=eff[1].m*a32[6] - a32[2]*eff[1].mcm[1] + a32[1]*eff[1].mcm[2] - eff[1].mcm[3]*Power(v32[1],2) - eff[1].mcm[3]*Power(v32[2],2) + (eff[1].mcm[1]*v32[1] + eff[1].mcm[2]*v32[2])*v32[3] - eff[1].m*v32[2]*v32[4] + eff[1].m*v32[1]*v32[5];
fnet32[4]=a32[6]*eff[1].mcm[2] - a32[5]*eff[1].mcm[3] + (-(eff[1].mcm[2]*v32[2]) - eff[1].mcm[3]*v32[3])*v32[4] - eff[1].mcm[1]*v32[2]*v32[5] - eff[1].mcm[1]*v32[3]*v32[6] + (eff[1].mcm[1]*v32[3] + eff[1].m*v32[5])*v32[6] + v32[5]*(eff[1].mcm[1]*v32[2] - eff[1].m*v32[6]) + v32[1]*(eff[1].mcm[2]*v32[5] + eff[1].mcm[3]*v32[6]);
fnet32[5]=-(a32[6]*eff[1].mcm[1]) + a32[4]*eff[1].mcm[3] - eff[1].mcm[2]*v32[1]*v32[4] + (-(eff[1].mcm[1]*v32[1]) - eff[1].mcm[3]*v32[3])*v32[5] - eff[1].mcm[2]*v32[3]*v32[6] + (eff[1].mcm[2]*v32[3] - eff[1].m*v32[4])*v32[6] + v32[4]*(eff[1].mcm[2]*v32[1] + eff[1].m*v32[6]) + v32[2]*(eff[1].mcm[1]*v32[4] + eff[1].mcm[3]*v32[6]);
fnet32[6]=a32[5]*eff[1].mcm[1] - a32[4]*eff[1].mcm[2] - eff[1].mcm[3]*v32[1]*v32[4] - eff[1].mcm[3]*v32[2]*v32[5] + (eff[1].mcm[3]*v32[2] + eff[1].m*v32[4])*v32[5] + v32[4]*(eff[1].mcm[3]*v32[1] - eff[1].m*v32[5]) + v32[3]*(eff[1].mcm[1]*v32[4] + eff[1].mcm[2]*v32[5]) + (-(eff[1].mcm[1]*v32[1]) - eff[1].mcm[2]*v32[2])*v32[6];

fnet33[1]=links[11].m*a33[4] - a33[3]*links[11].mcm[2] + a33[2]*links[11].mcm[3] - links[11].mcm[1]*Power(v33[2],2) - links[11].mcm[1]*Power(v33[3],2) + v33[1]*(links[11].mcm[2]*v33[2] + links[11].mcm[3]*v33[3]) - links[11].m*v33[3]*v33[5] + links[11].m*v33[2]*v33[6];
fnet33[2]=links[11].m*a33[5] + a33[3]*links[11].mcm[1] - a33[1]*links[11].mcm[3] - links[11].mcm[2]*Power(v33[1],2) - links[11].mcm[2]*Power(v33[3],2) + v33[2]*(links[11].mcm[1]*v33[1] + links[11].mcm[3]*v33[3]) + links[11].m*v33[3]*v33[4] - links[11].m*v33[1]*v33[6];
fnet33[3]=links[11].m*a33[6] - a33[2]*links[11].mcm[1] + a33[1]*links[11].mcm[2] - links[11].mcm[3]*Power(v33[1],2) - links[11].mcm[3]*Power(v33[2],2) + (links[11].mcm[1]*v33[1] + links[11].mcm[2]*v33[2])*v33[3] - links[11].m*v33[2]*v33[4] + links[11].m*v33[1]*v33[5];
fnet33[4]=a33[6]*links[11].mcm[2] - a33[5]*links[11].mcm[3] + (-(links[11].mcm[2]*v33[2]) - links[11].mcm[3]*v33[3])*v33[4] + (links[11].mcm[1]*v33[3] + links[11].m*v33[5])*v33[6] + v33[5]*(links[11].mcm[1]*v33[2] - links[11].m*v33[6]) + a33[1]*links[11].inertia[1][1] + a33[2]*links[11].inertia[1][2] + a33[3]*links[11].inertia[1][3] + v33[1]*(links[11].mcm[2]*v33[5] + links[11].mcm[3]*v33[6] - v33[3]*links[11].inertia[1][2] + v33[2]*links[11].inertia[1][3]) + v33[2]*(-(links[11].mcm[1]*v33[5]) - v33[3]*links[11].inertia[2][2] + v33[2]*links[11].inertia[2][3]) + v33[3]*(-(links[11].mcm[1]*v33[6]) - v33[3]*links[11].inertia[2][3] + v33[2]*links[11].inertia[3][3]);
fnet33[5]=-(a33[6]*links[11].mcm[1]) + a33[4]*links[11].mcm[3] + (-(links[11].mcm[1]*v33[1]) - links[11].mcm[3]*v33[3])*v33[5] + (links[11].mcm[2]*v33[3] - links[11].m*v33[4])*v33[6] + v33[4]*(links[11].mcm[2]*v33[1] + links[11].m*v33[6]) + a33[1]*links[11].inertia[1][2] + v33[1]*(-(links[11].mcm[2]*v33[4]) + v33[3]*links[11].inertia[1][1] - v33[1]*links[11].inertia[1][3]) + a33[2]*links[11].inertia[2][2] + a33[3]*links[11].inertia[2][3] + v33[2]*(links[11].mcm[1]*v33[4] + links[11].mcm[3]*v33[6] + v33[3]*links[11].inertia[1][2] - v33[1]*links[11].inertia[2][3]) + v33[3]*(-(links[11].mcm[2]*v33[6]) + v33[3]*links[11].inertia[1][3] - v33[1]*links[11].inertia[3][3]);
fnet33[6]=a33[5]*links[11].mcm[1] - a33[4]*links[11].mcm[2] + (links[11].mcm[3]*v33[2] + links[11].m*v33[4])*v33[5] + v33[4]*(links[11].mcm[3]*v33[1] - links[11].m*v33[5]) + (-(links[11].mcm[1]*v33[1]) - links[11].mcm[2]*v33[2])*v33[6] + v33[1]*(-(links[11].mcm[3]*v33[4]) - v33[2]*links[11].inertia[1][1] + v33[1]*links[11].inertia[1][2]) + a33[1]*links[11].inertia[1][3] + v33[2]*(-(links[11].mcm[3]*v33[5]) - v33[2]*links[11].inertia[1][2] + v33[1]*links[11].inertia[2][2]) + a33[2]*links[11].inertia[2][3] + v33[3]*(links[11].mcm[1]*v33[4] + links[11].mcm[2]*v33[5] - v33[2]*links[11].inertia[1][3] + v33[1]*links[11].inertia[2][3]) + a33[3]*links[11].inertia[3][3];

fnet34[1]=links[12].m*a34[4] - a34[3]*links[12].mcm[2] + a34[2]*links[12].mcm[3] - links[12].mcm[1]*Power(v34[2],2) - links[12].mcm[1]*Power(v34[3],2) + v34[1]*(links[12].mcm[2]*v34[2] + links[12].mcm[3]*v34[3]) - links[12].m*v34[3]*v34[5] + links[12].m*v34[2]*v34[6];
fnet34[2]=links[12].m*a34[5] + a34[3]*links[12].mcm[1] - a34[1]*links[12].mcm[3] - links[12].mcm[2]*Power(v34[1],2) - links[12].mcm[2]*Power(v34[3],2) + v34[2]*(links[12].mcm[1]*v34[1] + links[12].mcm[3]*v34[3]) + links[12].m*v34[3]*v34[4] - links[12].m*v34[1]*v34[6];
fnet34[3]=links[12].m*a34[6] - a34[2]*links[12].mcm[1] + a34[1]*links[12].mcm[2] - links[12].mcm[3]*Power(v34[1],2) - links[12].mcm[3]*Power(v34[2],2) + (links[12].mcm[1]*v34[1] + links[12].mcm[2]*v34[2])*v34[3] - links[12].m*v34[2]*v34[4] + links[12].m*v34[1]*v34[5];
fnet34[4]=a34[6]*links[12].mcm[2] - a34[5]*links[12].mcm[3] + (-(links[12].mcm[2]*v34[2]) - links[12].mcm[3]*v34[3])*v34[4] + (links[12].mcm[1]*v34[3] + links[12].m*v34[5])*v34[6] + v34[5]*(links[12].mcm[1]*v34[2] - links[12].m*v34[6]) + a34[1]*links[12].inertia[1][1] + a34[2]*links[12].inertia[1][2] + a34[3]*links[12].inertia[1][3] + v34[1]*(links[12].mcm[2]*v34[5] + links[12].mcm[3]*v34[6] - v34[3]*links[12].inertia[1][2] + v34[2]*links[12].inertia[1][3]) + v34[2]*(-(links[12].mcm[1]*v34[5]) - v34[3]*links[12].inertia[2][2] + v34[2]*links[12].inertia[2][3]) + v34[3]*(-(links[12].mcm[1]*v34[6]) - v34[3]*links[12].inertia[2][3] + v34[2]*links[12].inertia[3][3]);
fnet34[5]=-(a34[6]*links[12].mcm[1]) + a34[4]*links[12].mcm[3] + (-(links[12].mcm[1]*v34[1]) - links[12].mcm[3]*v34[3])*v34[5] + (links[12].mcm[2]*v34[3] - links[12].m*v34[4])*v34[6] + v34[4]*(links[12].mcm[2]*v34[1] + links[12].m*v34[6]) + a34[1]*links[12].inertia[1][2] + v34[1]*(-(links[12].mcm[2]*v34[4]) + v34[3]*links[12].inertia[1][1] - v34[1]*links[12].inertia[1][3]) + a34[2]*links[12].inertia[2][2] + a34[3]*links[12].inertia[2][3] + v34[2]*(links[12].mcm[1]*v34[4] + links[12].mcm[3]*v34[6] + v34[3]*links[12].inertia[1][2] - v34[1]*links[12].inertia[2][3]) + v34[3]*(-(links[12].mcm[2]*v34[6]) + v34[3]*links[12].inertia[1][3] - v34[1]*links[12].inertia[3][3]);
fnet34[6]=a34[5]*links[12].mcm[1] - a34[4]*links[12].mcm[2] + (links[12].mcm[3]*v34[2] + links[12].m*v34[4])*v34[5] + v34[4]*(links[12].mcm[3]*v34[1] - links[12].m*v34[5]) + (-(links[12].mcm[1]*v34[1]) - links[12].mcm[2]*v34[2])*v34[6] + v34[1]*(-(links[12].mcm[3]*v34[4]) - v34[2]*links[12].inertia[1][1] + v34[1]*links[12].inertia[1][2]) + a34[1]*links[12].inertia[1][3] + v34[2]*(-(links[12].mcm[3]*v34[5]) - v34[2]*links[12].inertia[1][2] + v34[1]*links[12].inertia[2][2]) + a34[2]*links[12].inertia[2][3] + v34[3]*(links[12].mcm[1]*v34[4] + links[12].mcm[2]*v34[5] - v34[2]*links[12].inertia[1][3] + v34[1]*links[12].inertia[2][3]) + a34[3]*links[12].inertia[3][3];

fnet35[1]=links[13].m*a35[4] - a35[3]*links[13].mcm[2] + a35[2]*links[13].mcm[3] - links[13].mcm[1]*Power(v35[2],2) - links[13].mcm[1]*Power(v35[3],2) + v35[1]*(links[13].mcm[2]*v35[2] + links[13].mcm[3]*v35[3]) - links[13].m*v35[3]*v35[5] + links[13].m*v35[2]*v35[6];
fnet35[2]=links[13].m*a35[5] + a35[3]*links[13].mcm[1] - a35[1]*links[13].mcm[3] - links[13].mcm[2]*Power(v35[1],2) - links[13].mcm[2]*Power(v35[3],2) + v35[2]*(links[13].mcm[1]*v35[1] + links[13].mcm[3]*v35[3]) + links[13].m*v35[3]*v35[4] - links[13].m*v35[1]*v35[6];
fnet35[3]=links[13].m*a35[6] - a35[2]*links[13].mcm[1] + a35[1]*links[13].mcm[2] - links[13].mcm[3]*Power(v35[1],2) - links[13].mcm[3]*Power(v35[2],2) + (links[13].mcm[1]*v35[1] + links[13].mcm[2]*v35[2])*v35[3] - links[13].m*v35[2]*v35[4] + links[13].m*v35[1]*v35[5];
fnet35[4]=a35[6]*links[13].mcm[2] - a35[5]*links[13].mcm[3] + (-(links[13].mcm[2]*v35[2]) - links[13].mcm[3]*v35[3])*v35[4] + (links[13].mcm[1]*v35[3] + links[13].m*v35[5])*v35[6] + v35[5]*(links[13].mcm[1]*v35[2] - links[13].m*v35[6]) + a35[1]*links[13].inertia[1][1] + a35[2]*links[13].inertia[1][2] + a35[3]*links[13].inertia[1][3] + v35[1]*(links[13].mcm[2]*v35[5] + links[13].mcm[3]*v35[6] - v35[3]*links[13].inertia[1][2] + v35[2]*links[13].inertia[1][3]) + v35[2]*(-(links[13].mcm[1]*v35[5]) - v35[3]*links[13].inertia[2][2] + v35[2]*links[13].inertia[2][3]) + v35[3]*(-(links[13].mcm[1]*v35[6]) - v35[3]*links[13].inertia[2][3] + v35[2]*links[13].inertia[3][3]);
fnet35[5]=-(a35[6]*links[13].mcm[1]) + a35[4]*links[13].mcm[3] + (-(links[13].mcm[1]*v35[1]) - links[13].mcm[3]*v35[3])*v35[5] + (links[13].mcm[2]*v35[3] - links[13].m*v35[4])*v35[6] + v35[4]*(links[13].mcm[2]*v35[1] + links[13].m*v35[6]) + a35[1]*links[13].inertia[1][2] + v35[1]*(-(links[13].mcm[2]*v35[4]) + v35[3]*links[13].inertia[1][1] - v35[1]*links[13].inertia[1][3]) + a35[2]*links[13].inertia[2][2] + a35[3]*links[13].inertia[2][3] + v35[2]*(links[13].mcm[1]*v35[4] + links[13].mcm[3]*v35[6] + v35[3]*links[13].inertia[1][2] - v35[1]*links[13].inertia[2][3]) + v35[3]*(-(links[13].mcm[2]*v35[6]) + v35[3]*links[13].inertia[1][3] - v35[1]*links[13].inertia[3][3]);
fnet35[6]=a35[5]*links[13].mcm[1] - a35[4]*links[13].mcm[2] + (links[13].mcm[3]*v35[2] + links[13].m*v35[4])*v35[5] + v35[4]*(links[13].mcm[3]*v35[1] - links[13].m*v35[5]) + (-(links[13].mcm[1]*v35[1]) - links[13].mcm[2]*v35[2])*v35[6] + v35[1]*(-(links[13].mcm[3]*v35[4]) - v35[2]*links[13].inertia[1][1] + v35[1]*links[13].inertia[1][2]) + a35[1]*links[13].inertia[1][3] + v35[2]*(-(links[13].mcm[3]*v35[5]) - v35[2]*links[13].inertia[1][2] + v35[1]*links[13].inertia[2][2]) + a35[2]*links[13].inertia[2][3] + v35[3]*(links[13].mcm[1]*v35[4] + links[13].mcm[2]*v35[5] - v35[2]*links[13].inertia[1][3] + v35[1]*links[13].inertia[2][3]) + a35[3]*links[13].inertia[3][3];

fnet36[1]=links[14].m*a36[4] - a36[3]*links[14].mcm[2] + a36[2]*links[14].mcm[3] - links[14].mcm[1]*Power(v36[2],2) - links[14].mcm[1]*Power(v36[3],2) + v36[1]*(links[14].mcm[2]*v36[2] + links[14].mcm[3]*v36[3]) - links[14].m*v36[3]*v36[5] + links[14].m*v36[2]*v36[6];
fnet36[2]=links[14].m*a36[5] + a36[3]*links[14].mcm[1] - a36[1]*links[14].mcm[3] - links[14].mcm[2]*Power(v36[1],2) - links[14].mcm[2]*Power(v36[3],2) + v36[2]*(links[14].mcm[1]*v36[1] + links[14].mcm[3]*v36[3]) + links[14].m*v36[3]*v36[4] - links[14].m*v36[1]*v36[6];
fnet36[3]=links[14].m*a36[6] - a36[2]*links[14].mcm[1] + a36[1]*links[14].mcm[2] - links[14].mcm[3]*Power(v36[1],2) - links[14].mcm[3]*Power(v36[2],2) + (links[14].mcm[1]*v36[1] + links[14].mcm[2]*v36[2])*v36[3] - links[14].m*v36[2]*v36[4] + links[14].m*v36[1]*v36[5];
fnet36[4]=a36[6]*links[14].mcm[2] - a36[5]*links[14].mcm[3] + (-(links[14].mcm[2]*v36[2]) - links[14].mcm[3]*v36[3])*v36[4] + (links[14].mcm[1]*v36[3] + links[14].m*v36[5])*v36[6] + v36[5]*(links[14].mcm[1]*v36[2] - links[14].m*v36[6]) + a36[1]*links[14].inertia[1][1] + a36[2]*links[14].inertia[1][2] + a36[3]*links[14].inertia[1][3] + v36[1]*(links[14].mcm[2]*v36[5] + links[14].mcm[3]*v36[6] - v36[3]*links[14].inertia[1][2] + v36[2]*links[14].inertia[1][3]) + v36[2]*(-(links[14].mcm[1]*v36[5]) - v36[3]*links[14].inertia[2][2] + v36[2]*links[14].inertia[2][3]) + v36[3]*(-(links[14].mcm[1]*v36[6]) - v36[3]*links[14].inertia[2][3] + v36[2]*links[14].inertia[3][3]);
fnet36[5]=-(a36[6]*links[14].mcm[1]) + a36[4]*links[14].mcm[3] + (-(links[14].mcm[1]*v36[1]) - links[14].mcm[3]*v36[3])*v36[5] + (links[14].mcm[2]*v36[3] - links[14].m*v36[4])*v36[6] + v36[4]*(links[14].mcm[2]*v36[1] + links[14].m*v36[6]) + a36[1]*links[14].inertia[1][2] + v36[1]*(-(links[14].mcm[2]*v36[4]) + v36[3]*links[14].inertia[1][1] - v36[1]*links[14].inertia[1][3]) + a36[2]*links[14].inertia[2][2] + a36[3]*links[14].inertia[2][3] + v36[2]*(links[14].mcm[1]*v36[4] + links[14].mcm[3]*v36[6] + v36[3]*links[14].inertia[1][2] - v36[1]*links[14].inertia[2][3]) + v36[3]*(-(links[14].mcm[2]*v36[6]) + v36[3]*links[14].inertia[1][3] - v36[1]*links[14].inertia[3][3]);
fnet36[6]=a36[5]*links[14].mcm[1] - a36[4]*links[14].mcm[2] + (links[14].mcm[3]*v36[2] + links[14].m*v36[4])*v36[5] + v36[4]*(links[14].mcm[3]*v36[1] - links[14].m*v36[5]) + (-(links[14].mcm[1]*v36[1]) - links[14].mcm[2]*v36[2])*v36[6] + v36[1]*(-(links[14].mcm[3]*v36[4]) - v36[2]*links[14].inertia[1][1] + v36[1]*links[14].inertia[1][2]) + a36[1]*links[14].inertia[1][3] + v36[2]*(-(links[14].mcm[3]*v36[5]) - v36[2]*links[14].inertia[1][2] + v36[1]*links[14].inertia[2][2]) + a36[2]*links[14].inertia[2][3] + v36[3]*(links[14].mcm[1]*v36[4] + links[14].mcm[2]*v36[5] - v36[2]*links[14].inertia[1][3] + v36[1]*links[14].inertia[2][3]) + a36[3]*links[14].inertia[3][3];

fnet37[1]=links[15].m*a37[4] - a37[3]*links[15].mcm[2] + a37[2]*links[15].mcm[3] - links[15].mcm[1]*Power(v37[2],2) - links[15].mcm[1]*Power(v37[3],2) + v37[1]*(links[15].mcm[2]*v37[2] + links[15].mcm[3]*v37[3]) - links[15].m*v37[3]*v37[5] + links[15].m*v37[2]*v37[6];
fnet37[2]=links[15].m*a37[5] + a37[3]*links[15].mcm[1] - a37[1]*links[15].mcm[3] - links[15].mcm[2]*Power(v37[1],2) - links[15].mcm[2]*Power(v37[3],2) + v37[2]*(links[15].mcm[1]*v37[1] + links[15].mcm[3]*v37[3]) + links[15].m*v37[3]*v37[4] - links[15].m*v37[1]*v37[6];
fnet37[3]=links[15].m*a37[6] - a37[2]*links[15].mcm[1] + a37[1]*links[15].mcm[2] - links[15].mcm[3]*Power(v37[1],2) - links[15].mcm[3]*Power(v37[2],2) + (links[15].mcm[1]*v37[1] + links[15].mcm[2]*v37[2])*v37[3] - links[15].m*v37[2]*v37[4] + links[15].m*v37[1]*v37[5];
fnet37[4]=a37[6]*links[15].mcm[2] - a37[5]*links[15].mcm[3] + (-(links[15].mcm[2]*v37[2]) - links[15].mcm[3]*v37[3])*v37[4] + (links[15].mcm[1]*v37[3] + links[15].m*v37[5])*v37[6] + v37[5]*(links[15].mcm[1]*v37[2] - links[15].m*v37[6]) + a37[1]*links[15].inertia[1][1] + a37[2]*links[15].inertia[1][2] + a37[3]*links[15].inertia[1][3] + v37[1]*(links[15].mcm[2]*v37[5] + links[15].mcm[3]*v37[6] - v37[3]*links[15].inertia[1][2] + v37[2]*links[15].inertia[1][3]) + v37[2]*(-(links[15].mcm[1]*v37[5]) - v37[3]*links[15].inertia[2][2] + v37[2]*links[15].inertia[2][3]) + v37[3]*(-(links[15].mcm[1]*v37[6]) - v37[3]*links[15].inertia[2][3] + v37[2]*links[15].inertia[3][3]);
fnet37[5]=-(a37[6]*links[15].mcm[1]) + a37[4]*links[15].mcm[3] + (-(links[15].mcm[1]*v37[1]) - links[15].mcm[3]*v37[3])*v37[5] + (links[15].mcm[2]*v37[3] - links[15].m*v37[4])*v37[6] + v37[4]*(links[15].mcm[2]*v37[1] + links[15].m*v37[6]) + a37[1]*links[15].inertia[1][2] + v37[1]*(-(links[15].mcm[2]*v37[4]) + v37[3]*links[15].inertia[1][1] - v37[1]*links[15].inertia[1][3]) + a37[2]*links[15].inertia[2][2] + a37[3]*links[15].inertia[2][3] + v37[2]*(links[15].mcm[1]*v37[4] + links[15].mcm[3]*v37[6] + v37[3]*links[15].inertia[1][2] - v37[1]*links[15].inertia[2][3]) + v37[3]*(-(links[15].mcm[2]*v37[6]) + v37[3]*links[15].inertia[1][3] - v37[1]*links[15].inertia[3][3]);
fnet37[6]=a37[5]*links[15].mcm[1] - a37[4]*links[15].mcm[2] + (links[15].mcm[3]*v37[2] + links[15].m*v37[4])*v37[5] + v37[4]*(links[15].mcm[3]*v37[1] - links[15].m*v37[5]) + (-(links[15].mcm[1]*v37[1]) - links[15].mcm[2]*v37[2])*v37[6] + v37[1]*(-(links[15].mcm[3]*v37[4]) - v37[2]*links[15].inertia[1][1] + v37[1]*links[15].inertia[1][2]) + a37[1]*links[15].inertia[1][3] + v37[2]*(-(links[15].mcm[3]*v37[5]) - v37[2]*links[15].inertia[1][2] + v37[1]*links[15].inertia[2][2]) + a37[2]*links[15].inertia[2][3] + v37[3]*(links[15].mcm[1]*v37[4] + links[15].mcm[2]*v37[5] - v37[2]*links[15].inertia[1][3] + v37[1]*links[15].inertia[2][3]) + a37[3]*links[15].inertia[3][3];

fnet38[1]=links[16].m*a38[4] - a38[3]*links[16].mcm[2] + a38[2]*links[16].mcm[3] - links[16].mcm[1]*Power(v38[2],2) - links[16].mcm[1]*Power(v38[3],2) + v38[1]*(links[16].mcm[2]*v38[2] + links[16].mcm[3]*v38[3]) - links[16].m*v38[3]*v38[5] + links[16].m*v38[2]*v38[6];
fnet38[2]=links[16].m*a38[5] + a38[3]*links[16].mcm[1] - a38[1]*links[16].mcm[3] - links[16].mcm[2]*Power(v38[1],2) - links[16].mcm[2]*Power(v38[3],2) + v38[2]*(links[16].mcm[1]*v38[1] + links[16].mcm[3]*v38[3]) + links[16].m*v38[3]*v38[4] - links[16].m*v38[1]*v38[6];
fnet38[3]=links[16].m*a38[6] - a38[2]*links[16].mcm[1] + a38[1]*links[16].mcm[2] - links[16].mcm[3]*Power(v38[1],2) - links[16].mcm[3]*Power(v38[2],2) + (links[16].mcm[1]*v38[1] + links[16].mcm[2]*v38[2])*v38[3] - links[16].m*v38[2]*v38[4] + links[16].m*v38[1]*v38[5];
fnet38[4]=a38[6]*links[16].mcm[2] - a38[5]*links[16].mcm[3] + (-(links[16].mcm[2]*v38[2]) - links[16].mcm[3]*v38[3])*v38[4] + (links[16].mcm[1]*v38[3] + links[16].m*v38[5])*v38[6] + v38[5]*(links[16].mcm[1]*v38[2] - links[16].m*v38[6]) + a38[1]*links[16].inertia[1][1] + a38[2]*links[16].inertia[1][2] + a38[3]*links[16].inertia[1][3] + v38[1]*(links[16].mcm[2]*v38[5] + links[16].mcm[3]*v38[6] - v38[3]*links[16].inertia[1][2] + v38[2]*links[16].inertia[1][3]) + v38[2]*(-(links[16].mcm[1]*v38[5]) - v38[3]*links[16].inertia[2][2] + v38[2]*links[16].inertia[2][3]) + v38[3]*(-(links[16].mcm[1]*v38[6]) - v38[3]*links[16].inertia[2][3] + v38[2]*links[16].inertia[3][3]);
fnet38[5]=-(a38[6]*links[16].mcm[1]) + a38[4]*links[16].mcm[3] + (-(links[16].mcm[1]*v38[1]) - links[16].mcm[3]*v38[3])*v38[5] + (links[16].mcm[2]*v38[3] - links[16].m*v38[4])*v38[6] + v38[4]*(links[16].mcm[2]*v38[1] + links[16].m*v38[6]) + a38[1]*links[16].inertia[1][2] + v38[1]*(-(links[16].mcm[2]*v38[4]) + v38[3]*links[16].inertia[1][1] - v38[1]*links[16].inertia[1][3]) + a38[2]*links[16].inertia[2][2] + a38[3]*links[16].inertia[2][3] + v38[2]*(links[16].mcm[1]*v38[4] + links[16].mcm[3]*v38[6] + v38[3]*links[16].inertia[1][2] - v38[1]*links[16].inertia[2][3]) + v38[3]*(-(links[16].mcm[2]*v38[6]) + v38[3]*links[16].inertia[1][3] - v38[1]*links[16].inertia[3][3]);
fnet38[6]=a38[5]*links[16].mcm[1] - a38[4]*links[16].mcm[2] + (links[16].mcm[3]*v38[2] + links[16].m*v38[4])*v38[5] + v38[4]*(links[16].mcm[3]*v38[1] - links[16].m*v38[5]) + (-(links[16].mcm[1]*v38[1]) - links[16].mcm[2]*v38[2])*v38[6] + v38[1]*(-(links[16].mcm[3]*v38[4]) - v38[2]*links[16].inertia[1][1] + v38[1]*links[16].inertia[1][2]) + a38[1]*links[16].inertia[1][3] + v38[2]*(-(links[16].mcm[3]*v38[5]) - v38[2]*links[16].inertia[1][2] + v38[1]*links[16].inertia[2][2]) + a38[2]*links[16].inertia[2][3] + v38[3]*(links[16].mcm[1]*v38[4] + links[16].mcm[2]*v38[5] - v38[2]*links[16].inertia[1][3] + v38[1]*links[16].inertia[2][3]) + a38[3]*links[16].inertia[3][3];

fnet40[1]=eff[3].m*a40[4] - a40[3]*eff[3].mcm[2] + a40[2]*eff[3].mcm[3] - eff[3].mcm[1]*Power(v40[2],2) - eff[3].mcm[1]*Power(v40[3],2) + v40[1]*(eff[3].mcm[2]*v40[2] + eff[3].mcm[3]*v40[3]) - eff[3].m*v40[3]*v40[5] + eff[3].m*v40[2]*v40[6];
fnet40[2]=eff[3].m*a40[5] + a40[3]*eff[3].mcm[1] - a40[1]*eff[3].mcm[3] - eff[3].mcm[2]*Power(v40[1],2) - eff[3].mcm[2]*Power(v40[3],2) + v40[2]*(eff[3].mcm[1]*v40[1] + eff[3].mcm[3]*v40[3]) + eff[3].m*v40[3]*v40[4] - eff[3].m*v40[1]*v40[6];
fnet40[3]=eff[3].m*a40[6] - a40[2]*eff[3].mcm[1] + a40[1]*eff[3].mcm[2] - eff[3].mcm[3]*Power(v40[1],2) - eff[3].mcm[3]*Power(v40[2],2) + (eff[3].mcm[1]*v40[1] + eff[3].mcm[2]*v40[2])*v40[3] - eff[3].m*v40[2]*v40[4] + eff[3].m*v40[1]*v40[5];
fnet40[4]=a40[6]*eff[3].mcm[2] - a40[5]*eff[3].mcm[3] + (-(eff[3].mcm[2]*v40[2]) - eff[3].mcm[3]*v40[3])*v40[4] - eff[3].mcm[1]*v40[2]*v40[5] - eff[3].mcm[1]*v40[3]*v40[6] + (eff[3].mcm[1]*v40[3] + eff[3].m*v40[5])*v40[6] + v40[5]*(eff[3].mcm[1]*v40[2] - eff[3].m*v40[6]) + v40[1]*(eff[3].mcm[2]*v40[5] + eff[3].mcm[3]*v40[6]);
fnet40[5]=-(a40[6]*eff[3].mcm[1]) + a40[4]*eff[3].mcm[3] - eff[3].mcm[2]*v40[1]*v40[4] + (-(eff[3].mcm[1]*v40[1]) - eff[3].mcm[3]*v40[3])*v40[5] - eff[3].mcm[2]*v40[3]*v40[6] + (eff[3].mcm[2]*v40[3] - eff[3].m*v40[4])*v40[6] + v40[4]*(eff[3].mcm[2]*v40[1] + eff[3].m*v40[6]) + v40[2]*(eff[3].mcm[1]*v40[4] + eff[3].mcm[3]*v40[6]);
fnet40[6]=a40[5]*eff[3].mcm[1] - a40[4]*eff[3].mcm[2] - eff[3].mcm[3]*v40[1]*v40[4] - eff[3].mcm[3]*v40[2]*v40[5] + (eff[3].mcm[3]*v40[2] + eff[3].m*v40[4])*v40[5] + v40[4]*(eff[3].mcm[3]*v40[1] - eff[3].m*v40[5]) + v40[3]*(eff[3].mcm[1]*v40[4] + eff[3].mcm[2]*v40[5]) + (-(eff[3].mcm[1]*v40[1]) - eff[3].mcm[2]*v40[2])*v40[6];

fnet46[1]=eff[2].m*a46[4] - a46[3]*eff[2].mcm[2] + a46[2]*eff[2].mcm[3] - eff[2].mcm[1]*Power(v46[2],2) - eff[2].mcm[1]*Power(v46[3],2) + v46[1]*(eff[2].mcm[2]*v46[2] + eff[2].mcm[3]*v46[3]) - eff[2].m*v46[3]*v46[5] + eff[2].m*v46[2]*v46[6];
fnet46[2]=eff[2].m*a46[5] + a46[3]*eff[2].mcm[1] - a46[1]*eff[2].mcm[3] - eff[2].mcm[2]*Power(v46[1],2) - eff[2].mcm[2]*Power(v46[3],2) + v46[2]*(eff[2].mcm[1]*v46[1] + eff[2].mcm[3]*v46[3]) + eff[2].m*v46[3]*v46[4] - eff[2].m*v46[1]*v46[6];
fnet46[3]=eff[2].m*a46[6] - a46[2]*eff[2].mcm[1] + a46[1]*eff[2].mcm[2] - eff[2].mcm[3]*Power(v46[1],2) - eff[2].mcm[3]*Power(v46[2],2) + (eff[2].mcm[1]*v46[1] + eff[2].mcm[2]*v46[2])*v46[3] - eff[2].m*v46[2]*v46[4] + eff[2].m*v46[1]*v46[5];
fnet46[4]=a46[6]*eff[2].mcm[2] - a46[5]*eff[2].mcm[3] + (-(eff[2].mcm[2]*v46[2]) - eff[2].mcm[3]*v46[3])*v46[4] - eff[2].mcm[1]*v46[2]*v46[5] - eff[2].mcm[1]*v46[3]*v46[6] + (eff[2].mcm[1]*v46[3] + eff[2].m*v46[5])*v46[6] + v46[5]*(eff[2].mcm[1]*v46[2] - eff[2].m*v46[6]) + v46[1]*(eff[2].mcm[2]*v46[5] + eff[2].mcm[3]*v46[6]);
fnet46[5]=-(a46[6]*eff[2].mcm[1]) + a46[4]*eff[2].mcm[3] - eff[2].mcm[2]*v46[1]*v46[4] + (-(eff[2].mcm[1]*v46[1]) - eff[2].mcm[3]*v46[3])*v46[5] - eff[2].mcm[2]*v46[3]*v46[6] + (eff[2].mcm[2]*v46[3] - eff[2].m*v46[4])*v46[6] + v46[4]*(eff[2].mcm[2]*v46[1] + eff[2].m*v46[6]) + v46[2]*(eff[2].mcm[1]*v46[4] + eff[2].mcm[3]*v46[6]);
fnet46[6]=a46[5]*eff[2].mcm[1] - a46[4]*eff[2].mcm[2] - eff[2].mcm[3]*v46[1]*v46[4] - eff[2].mcm[3]*v46[2]*v46[5] + (eff[2].mcm[3]*v46[2] + eff[2].m*v46[4])*v46[5] + v46[4]*(eff[2].mcm[3]*v46[1] - eff[2].m*v46[5]) + v46[3]*(eff[2].mcm[1]*v46[4] + eff[2].mcm[2]*v46[5]) + (-(eff[2].mcm[1]*v46[1]) - eff[2].mcm[2]*v46[2])*v46[6];


fex0[1]=-(uex[0].f[1]*S00[1][1]) - uex[0].f[2]*S00[1][2] - uex[0].f[3]*S00[1][3];
fex0[2]=-(uex[0].f[1]*S00[2][1]) - uex[0].f[2]*S00[2][2] - uex[0].f[3]*S00[2][3];
fex0[3]=-(uex[0].f[1]*S00[3][1]) - uex[0].f[2]*S00[3][2] - uex[0].f[3]*S00[3][3];
fex0[4]=-(uex[0].t[1]*S00[1][1]) - uex[0].t[2]*S00[1][2] - uex[0].t[3]*S00[1][3];
fex0[5]=-(uex[0].t[1]*S00[2][1]) - uex[0].t[2]*S00[2][2] - uex[0].t[3]*S00[2][3];
fex0[6]=-(uex[0].t[1]*S00[3][1]) - uex[0].t[2]*S00[3][2] - uex[0].t[3]*S00[3][3];

fex2[1]=-(uex[7].f[1]*SG20[1][1]) - uex[7].f[2]*SG20[1][2] - uex[7].f[3]*SG20[1][3];
fex2[2]=-(uex[7].f[1]*SG20[2][1]) - uex[7].f[2]*SG20[2][2] - uex[7].f[3]*SG20[2][3];
fex2[3]=-(uex[7].f[1]*SG20[3][1]) - uex[7].f[2]*SG20[3][2] - uex[7].f[3]*SG20[3][3];
fex2[4]=-(uex[7].t[1]*SG20[1][1]) - uex[7].t[2]*SG20[1][2] - uex[7].t[3]*SG20[1][3];
fex2[5]=-(uex[7].t[1]*SG20[2][1]) - uex[7].t[2]*SG20[2][2] - uex[7].t[3]*SG20[2][3];
fex2[6]=-(uex[7].t[1]*SG20[3][1]) - uex[7].t[2]*SG20[3][2] - uex[7].t[3]*SG20[3][3];

fex3[1]=-(uex[8].f[1]*SG30[1][1]) - uex[8].f[2]*SG30[1][2] - uex[8].f[3]*SG30[1][3];
fex3[2]=-(uex[8].f[1]*SG30[2][1]) - uex[8].f[2]*SG30[2][2] - uex[8].f[3]*SG30[2][3];
fex3[3]=-(uex[8].f[1]*SG30[3][1]) - uex[8].f[2]*SG30[3][2] - uex[8].f[3]*SG30[3][3];
fex3[4]=-(uex[8].t[1]*SG30[1][1]) - uex[8].t[2]*SG30[1][2] - uex[8].t[3]*SG30[1][3];
fex3[5]=-(uex[8].t[1]*SG30[2][1]) - uex[8].t[2]*SG30[2][2] - uex[8].t[3]*SG30[2][3];
fex3[6]=-(uex[8].t[1]*SG30[3][1]) - uex[8].t[2]*SG30[3][2] - uex[8].t[3]*SG30[3][3];

fex4[1]=-(uex[9].f[1]*SG40[1][1]) - uex[9].f[2]*SG40[1][2] - uex[9].f[3]*SG40[1][3];
fex4[2]=-(uex[9].f[1]*SG40[2][1]) - uex[9].f[2]*SG40[2][2] - uex[9].f[3]*SG40[2][3];
fex4[3]=-(uex[9].f[1]*SG40[3][1]) - uex[9].f[2]*SG40[3][2] - uex[9].f[3]*SG40[3][3];
fex4[4]=-(uex[9].t[1]*SG40[1][1]) - uex[9].t[2]*SG40[1][2] - uex[9].t[3]*SG40[1][3];
fex4[5]=-(uex[9].t[1]*SG40[2][1]) - uex[9].t[2]*SG40[2][2] - uex[9].t[3]*SG40[2][3];
fex4[6]=-(uex[9].t[1]*SG40[3][1]) - uex[9].t[2]*SG40[3][2] - uex[9].t[3]*SG40[3][3];

fex5[1]=-(uex[10].f[1]*SG50[1][1]) - uex[10].f[2]*SG50[1][2] - uex[10].f[3]*SG50[1][3];
fex5[2]=-(uex[10].f[1]*SG50[2][1]) - uex[10].f[2]*SG50[2][2] - uex[10].f[3]*SG50[2][3];
fex5[3]=-(uex[10].f[1]*SG50[3][1]) - uex[10].f[2]*SG50[3][2] - uex[10].f[3]*SG50[3][3];
fex5[4]=-(uex[10].t[1]*SG50[1][1]) - uex[10].t[2]*SG50[1][2] - uex[10].t[3]*SG50[1][3];
fex5[5]=-(uex[10].t[1]*SG50[2][1]) - uex[10].t[2]*SG50[2][2] - uex[10].t[3]*SG50[2][3];
fex5[6]=-(uex[10].t[1]*SG50[3][1]) - uex[10].t[2]*SG50[3][2] - uex[10].t[3]*SG50[3][3];

fex9[1]=-(uex[17].f[1]*SG90[1][1]) - uex[17].f[2]*SG90[1][2] - uex[17].f[3]*SG90[1][3];
fex9[2]=-(uex[17].f[1]*SG90[2][1]) - uex[17].f[2]*SG90[2][2] - uex[17].f[3]*SG90[2][3];
fex9[3]=-(uex[17].f[1]*SG90[3][1]) - uex[17].f[2]*SG90[3][2] - uex[17].f[3]*SG90[3][3];
fex9[4]=-(uex[17].t[1]*SG90[1][1]) - uex[17].t[2]*SG90[1][2] - uex[17].t[3]*SG90[1][3];
fex9[5]=-(uex[17].t[1]*SG90[2][1]) - uex[17].t[2]*SG90[2][2] - uex[17].t[3]*SG90[2][3];
fex9[6]=-(uex[17].t[1]*SG90[3][1]) - uex[17].t[2]*SG90[3][2] - uex[17].t[3]*SG90[3][3];

fex10[1]=-(uex[18].f[1]*SG100[1][1]) - uex[18].f[2]*SG100[1][2] - uex[18].f[3]*SG100[1][3];
fex10[2]=-(uex[18].f[1]*SG100[2][1]) - uex[18].f[2]*SG100[2][2] - uex[18].f[3]*SG100[2][3];
fex10[3]=-(uex[18].f[1]*SG100[3][1]) - uex[18].f[2]*SG100[3][2] - uex[18].f[3]*SG100[3][3];
fex10[4]=-(uex[18].t[1]*SG100[1][1]) - uex[18].t[2]*SG100[1][2] - uex[18].t[3]*SG100[1][3];
fex10[5]=-(uex[18].t[1]*SG100[2][1]) - uex[18].t[2]*SG100[2][2] - uex[18].t[3]*SG100[2][3];
fex10[6]=-(uex[18].t[1]*SG100[3][1]) - uex[18].t[2]*SG100[3][2] - uex[18].t[3]*SG100[3][3];

fex11[1]=-(uex[19].f[1]*SG110[1][1]) - uex[19].f[2]*SG110[1][2] - uex[19].f[3]*SG110[1][3];
fex11[2]=-(uex[19].f[1]*SG110[2][1]) - uex[19].f[2]*SG110[2][2] - uex[19].f[3]*SG110[2][3];
fex11[3]=-(uex[19].f[1]*SG110[3][1]) - uex[19].f[2]*SG110[3][2] - uex[19].f[3]*SG110[3][3];
fex11[4]=-(uex[19].t[1]*SG110[1][1]) - uex[19].t[2]*SG110[1][2] - uex[19].t[3]*SG110[1][3];
fex11[5]=-(uex[19].t[1]*SG110[2][1]) - uex[19].t[2]*SG110[2][2] - uex[19].t[3]*SG110[2][3];
fex11[6]=-(uex[19].t[1]*SG110[3][1]) - uex[19].t[2]*SG110[3][2] - uex[19].t[3]*SG110[3][3];

fex12[1]=-(uex[20].f[1]*SG120[1][1]) - uex[20].f[2]*SG120[1][2] - uex[20].f[3]*SG120[1][3];
fex12[2]=-(uex[20].f[1]*SG120[2][1]) - uex[20].f[2]*SG120[2][2] - uex[20].f[3]*SG120[2][3];
fex12[3]=-(uex[20].f[1]*SG120[3][1]) - uex[20].f[2]*SG120[3][2] - uex[20].f[3]*SG120[3][3];
fex12[4]=-(uex[20].t[1]*SG120[1][1]) - uex[20].t[2]*SG120[1][2] - uex[20].t[3]*SG120[1][3];
fex12[5]=-(uex[20].t[1]*SG120[2][1]) - uex[20].t[2]*SG120[2][2] - uex[20].t[3]*SG120[2][3];
fex12[6]=-(uex[20].t[1]*SG120[3][1]) - uex[20].t[2]*SG120[3][2] - uex[20].t[3]*SG120[3][3];

fex13[1]=-(uex[27].f[1]*SG130[1][1]) - uex[27].f[2]*SG130[1][2] - uex[27].f[3]*SG130[1][3];
fex13[2]=-(uex[27].f[1]*SG130[2][1]) - uex[27].f[2]*SG130[2][2] - uex[27].f[3]*SG130[2][3];
fex13[3]=-(uex[27].f[1]*SG130[3][1]) - uex[27].f[2]*SG130[3][2] - uex[27].f[3]*SG130[3][3];
fex13[4]=-(uex[27].t[1]*SG130[1][1]) - uex[27].t[2]*SG130[1][2] - uex[27].t[3]*SG130[1][3];
fex13[5]=-(uex[27].t[1]*SG130[2][1]) - uex[27].t[2]*SG130[2][2] - uex[27].t[3]*SG130[2][3];
fex13[6]=-(uex[27].t[1]*SG130[3][1]) - uex[27].t[2]*SG130[3][2] - uex[27].t[3]*SG130[3][3];

fex14[1]=-(uex[28].f[1]*SG140[1][1]) - uex[28].f[2]*SG140[1][2] - uex[28].f[3]*SG140[1][3];
fex14[2]=-(uex[28].f[1]*SG140[2][1]) - uex[28].f[2]*SG140[2][2] - uex[28].f[3]*SG140[2][3];
fex14[3]=-(uex[28].f[1]*SG140[3][1]) - uex[28].f[2]*SG140[3][2] - uex[28].f[3]*SG140[3][3];
fex14[4]=-(uex[28].t[1]*SG140[1][1]) - uex[28].t[2]*SG140[1][2] - uex[28].t[3]*SG140[1][3];
fex14[5]=-(uex[28].t[1]*SG140[2][1]) - uex[28].t[2]*SG140[2][2] - uex[28].t[3]*SG140[2][3];
fex14[6]=-(uex[28].t[1]*SG140[3][1]) - uex[28].t[2]*SG140[3][2] - uex[28].t[3]*SG140[3][3];

fex18[1]=-(uex[22].f[1]*SG180[1][1]) - uex[22].f[2]*SG180[1][2] - uex[22].f[3]*SG180[1][3];
fex18[2]=-(uex[22].f[1]*SG180[2][1]) - uex[22].f[2]*SG180[2][2] - uex[22].f[3]*SG180[2][3];
fex18[3]=-(uex[22].f[1]*SG180[3][1]) - uex[22].f[2]*SG180[3][2] - uex[22].f[3]*SG180[3][3];
fex18[4]=-(uex[22].t[1]*SG180[1][1]) - uex[22].t[2]*SG180[1][2] - uex[22].t[3]*SG180[1][3];
fex18[5]=-(uex[22].t[1]*SG180[2][1]) - uex[22].t[2]*SG180[2][2] - uex[22].t[3]*SG180[2][3];
fex18[6]=-(uex[22].t[1]*SG180[3][1]) - uex[22].t[2]*SG180[3][2] - uex[22].t[3]*SG180[3][3];

fex20[1]=-(uex[24].f[1]*SG200[1][1]) - uex[24].f[2]*SG200[1][2] - uex[24].f[3]*SG200[1][3];
fex20[2]=-(uex[24].f[1]*SG200[2][1]) - uex[24].f[2]*SG200[2][2] - uex[24].f[3]*SG200[2][3];
fex20[3]=-(uex[24].f[1]*SG200[3][1]) - uex[24].f[2]*SG200[3][2] - uex[24].f[3]*SG200[3][3];
fex20[4]=-(uex[24].t[1]*SG200[1][1]) - uex[24].t[2]*SG200[1][2] - uex[24].t[3]*SG200[1][3];
fex20[5]=-(uex[24].t[1]*SG200[2][1]) - uex[24].t[2]*SG200[2][2] - uex[24].t[3]*SG200[2][3];
fex20[6]=-(uex[24].t[1]*SG200[3][1]) - uex[24].t[2]*SG200[3][2] - uex[24].t[3]*SG200[3][3];

fex21[1]=-(uex[21].f[1]*SG210[1][1]) - uex[21].f[2]*SG210[1][2] - uex[21].f[3]*SG210[1][3];
fex21[2]=-(uex[21].f[1]*SG210[2][1]) - uex[21].f[2]*SG210[2][2] - uex[21].f[3]*SG210[2][3];
fex21[3]=-(uex[21].f[1]*SG210[3][1]) - uex[21].f[2]*SG210[3][2] - uex[21].f[3]*SG210[3][3];
fex21[4]=-(uex[21].t[1]*SG210[1][1]) - uex[21].t[2]*SG210[1][2] - uex[21].t[3]*SG210[1][3];
fex21[5]=-(uex[21].t[1]*SG210[2][1]) - uex[21].t[2]*SG210[2][2] - uex[21].t[3]*SG210[2][3];
fex21[6]=-(uex[21].t[1]*SG210[3][1]) - uex[21].t[2]*SG210[3][2] - uex[21].t[3]*SG210[3][3];

fex22[1]=-(uex[1].f[1]*SG220[1][1]) - uex[1].f[2]*SG220[1][2] - uex[1].f[3]*SG220[1][3];
fex22[2]=-(uex[1].f[1]*SG220[2][1]) - uex[1].f[2]*SG220[2][2] - uex[1].f[3]*SG220[2][3];
fex22[3]=-(uex[1].f[1]*SG220[3][1]) - uex[1].f[2]*SG220[3][2] - uex[1].f[3]*SG220[3][3];
fex22[4]=-(uex[1].t[1]*SG220[1][1]) - uex[1].t[2]*SG220[1][2] - uex[1].t[3]*SG220[1][3];
fex22[5]=-(uex[1].t[1]*SG220[2][1]) - uex[1].t[2]*SG220[2][2] - uex[1].t[3]*SG220[2][3];
fex22[6]=-(uex[1].t[1]*SG220[3][1]) - uex[1].t[2]*SG220[3][2] - uex[1].t[3]*SG220[3][3];

fex23[1]=-(uex[2].f[1]*SG230[1][1]) - uex[2].f[2]*SG230[1][2] - uex[2].f[3]*SG230[1][3];
fex23[2]=-(uex[2].f[1]*SG230[2][1]) - uex[2].f[2]*SG230[2][2] - uex[2].f[3]*SG230[2][3];
fex23[3]=-(uex[2].f[1]*SG230[3][1]) - uex[2].f[2]*SG230[3][2] - uex[2].f[3]*SG230[3][3];
fex23[4]=-(uex[2].t[1]*SG230[1][1]) - uex[2].t[2]*SG230[1][2] - uex[2].t[3]*SG230[1][3];
fex23[5]=-(uex[2].t[1]*SG230[2][1]) - uex[2].t[2]*SG230[2][2] - uex[2].t[3]*SG230[2][3];
fex23[6]=-(uex[2].t[1]*SG230[3][1]) - uex[2].t[2]*SG230[3][2] - uex[2].t[3]*SG230[3][3];

fex24[1]=-(uex[3].f[1]*SG240[1][1]) - uex[3].f[2]*SG240[1][2] - uex[3].f[3]*SG240[1][3];
fex24[2]=-(uex[3].f[1]*SG240[2][1]) - uex[3].f[2]*SG240[2][2] - uex[3].f[3]*SG240[2][3];
fex24[3]=-(uex[3].f[1]*SG240[3][1]) - uex[3].f[2]*SG240[3][2] - uex[3].f[3]*SG240[3][3];
fex24[4]=-(uex[3].t[1]*SG240[1][1]) - uex[3].t[2]*SG240[1][2] - uex[3].t[3]*SG240[1][3];
fex24[5]=-(uex[3].t[1]*SG240[2][1]) - uex[3].t[2]*SG240[2][2] - uex[3].t[3]*SG240[2][3];
fex24[6]=-(uex[3].t[1]*SG240[3][1]) - uex[3].t[2]*SG240[3][2] - uex[3].t[3]*SG240[3][3];

fex25[1]=-(uex[4].f[1]*SG250[1][1]) - uex[4].f[2]*SG250[1][2] - uex[4].f[3]*SG250[1][3];
fex25[2]=-(uex[4].f[1]*SG250[2][1]) - uex[4].f[2]*SG250[2][2] - uex[4].f[3]*SG250[2][3];
fex25[3]=-(uex[4].f[1]*SG250[3][1]) - uex[4].f[2]*SG250[3][2] - uex[4].f[3]*SG250[3][3];
fex25[4]=-(uex[4].t[1]*SG250[1][1]) - uex[4].t[2]*SG250[1][2] - uex[4].t[3]*SG250[1][3];
fex25[5]=-(uex[4].t[1]*SG250[2][1]) - uex[4].t[2]*SG250[2][2] - uex[4].t[3]*SG250[2][3];
fex25[6]=-(uex[4].t[1]*SG250[3][1]) - uex[4].t[2]*SG250[3][2] - uex[4].t[3]*SG250[3][3];

fex26[1]=-(uex[5].f[1]*SG260[1][1]) - uex[5].f[2]*SG260[1][2] - uex[5].f[3]*SG260[1][3];
fex26[2]=-(uex[5].f[1]*SG260[2][1]) - uex[5].f[2]*SG260[2][2] - uex[5].f[3]*SG260[2][3];
fex26[3]=-(uex[5].f[1]*SG260[3][1]) - uex[5].f[2]*SG260[3][2] - uex[5].f[3]*SG260[3][3];
fex26[4]=-(uex[5].t[1]*SG260[1][1]) - uex[5].t[2]*SG260[1][2] - uex[5].t[3]*SG260[1][3];
fex26[5]=-(uex[5].t[1]*SG260[2][1]) - uex[5].t[2]*SG260[2][2] - uex[5].t[3]*SG260[2][3];
fex26[6]=-(uex[5].t[1]*SG260[3][1]) - uex[5].t[2]*SG260[3][2] - uex[5].t[3]*SG260[3][3];

fex27[1]=-(uex[6].f[1]*SG270[1][1]) - uex[6].f[2]*SG270[1][2] - uex[6].f[3]*SG270[1][3];
fex27[2]=-(uex[6].f[1]*SG270[2][1]) - uex[6].f[2]*SG270[2][2] - uex[6].f[3]*SG270[2][3];
fex27[3]=-(uex[6].f[1]*SG270[3][1]) - uex[6].f[2]*SG270[3][2] - uex[6].f[3]*SG270[3][3];
fex27[4]=-(uex[6].t[1]*SG270[1][1]) - uex[6].t[2]*SG270[1][2] - uex[6].t[3]*SG270[1][3];
fex27[5]=-(uex[6].t[1]*SG270[2][1]) - uex[6].t[2]*SG270[2][2] - uex[6].t[3]*SG270[2][3];
fex27[6]=-(uex[6].t[1]*SG270[3][1]) - uex[6].t[2]*SG270[3][2] - uex[6].t[3]*SG270[3][3];

fex33[1]=-(uex[11].f[1]*SG330[1][1]) - uex[11].f[2]*SG330[1][2] - uex[11].f[3]*SG330[1][3];
fex33[2]=-(uex[11].f[1]*SG330[2][1]) - uex[11].f[2]*SG330[2][2] - uex[11].f[3]*SG330[2][3];
fex33[3]=-(uex[11].f[1]*SG330[3][1]) - uex[11].f[2]*SG330[3][2] - uex[11].f[3]*SG330[3][3];
fex33[4]=-(uex[11].t[1]*SG330[1][1]) - uex[11].t[2]*SG330[1][2] - uex[11].t[3]*SG330[1][3];
fex33[5]=-(uex[11].t[1]*SG330[2][1]) - uex[11].t[2]*SG330[2][2] - uex[11].t[3]*SG330[2][3];
fex33[6]=-(uex[11].t[1]*SG330[3][1]) - uex[11].t[2]*SG330[3][2] - uex[11].t[3]*SG330[3][3];

fex34[1]=-(uex[12].f[1]*SG340[1][1]) - uex[12].f[2]*SG340[1][2] - uex[12].f[3]*SG340[1][3];
fex34[2]=-(uex[12].f[1]*SG340[2][1]) - uex[12].f[2]*SG340[2][2] - uex[12].f[3]*SG340[2][3];
fex34[3]=-(uex[12].f[1]*SG340[3][1]) - uex[12].f[2]*SG340[3][2] - uex[12].f[3]*SG340[3][3];
fex34[4]=-(uex[12].t[1]*SG340[1][1]) - uex[12].t[2]*SG340[1][2] - uex[12].t[3]*SG340[1][3];
fex34[5]=-(uex[12].t[1]*SG340[2][1]) - uex[12].t[2]*SG340[2][2] - uex[12].t[3]*SG340[2][3];
fex34[6]=-(uex[12].t[1]*SG340[3][1]) - uex[12].t[2]*SG340[3][2] - uex[12].t[3]*SG340[3][3];

fex35[1]=-(uex[13].f[1]*SG350[1][1]) - uex[13].f[2]*SG350[1][2] - uex[13].f[3]*SG350[1][3];
fex35[2]=-(uex[13].f[1]*SG350[2][1]) - uex[13].f[2]*SG350[2][2] - uex[13].f[3]*SG350[2][3];
fex35[3]=-(uex[13].f[1]*SG350[3][1]) - uex[13].f[2]*SG350[3][2] - uex[13].f[3]*SG350[3][3];
fex35[4]=-(uex[13].t[1]*SG350[1][1]) - uex[13].t[2]*SG350[1][2] - uex[13].t[3]*SG350[1][3];
fex35[5]=-(uex[13].t[1]*SG350[2][1]) - uex[13].t[2]*SG350[2][2] - uex[13].t[3]*SG350[2][3];
fex35[6]=-(uex[13].t[1]*SG350[3][1]) - uex[13].t[2]*SG350[3][2] - uex[13].t[3]*SG350[3][3];

fex36[1]=-(uex[14].f[1]*SG360[1][1]) - uex[14].f[2]*SG360[1][2] - uex[14].f[3]*SG360[1][3];
fex36[2]=-(uex[14].f[1]*SG360[2][1]) - uex[14].f[2]*SG360[2][2] - uex[14].f[3]*SG360[2][3];
fex36[3]=-(uex[14].f[1]*SG360[3][1]) - uex[14].f[2]*SG360[3][2] - uex[14].f[3]*SG360[3][3];
fex36[4]=-(uex[14].t[1]*SG360[1][1]) - uex[14].t[2]*SG360[1][2] - uex[14].t[3]*SG360[1][3];
fex36[5]=-(uex[14].t[1]*SG360[2][1]) - uex[14].t[2]*SG360[2][2] - uex[14].t[3]*SG360[2][3];
fex36[6]=-(uex[14].t[1]*SG360[3][1]) - uex[14].t[2]*SG360[3][2] - uex[14].t[3]*SG360[3][3];

fex37[1]=-(uex[15].f[1]*SG370[1][1]) - uex[15].f[2]*SG370[1][2] - uex[15].f[3]*SG370[1][3];
fex37[2]=-(uex[15].f[1]*SG370[2][1]) - uex[15].f[2]*SG370[2][2] - uex[15].f[3]*SG370[2][3];
fex37[3]=-(uex[15].f[1]*SG370[3][1]) - uex[15].f[2]*SG370[3][2] - uex[15].f[3]*SG370[3][3];
fex37[4]=-(uex[15].t[1]*SG370[1][1]) - uex[15].t[2]*SG370[1][2] - uex[15].t[3]*SG370[1][3];
fex37[5]=-(uex[15].t[1]*SG370[2][1]) - uex[15].t[2]*SG370[2][2] - uex[15].t[3]*SG370[2][3];
fex37[6]=-(uex[15].t[1]*SG370[3][1]) - uex[15].t[2]*SG370[3][2] - uex[15].t[3]*SG370[3][3];

fex38[1]=-(uex[16].f[1]*SG380[1][1]) - uex[16].f[2]*SG380[1][2] - uex[16].f[3]*SG380[1][3];
fex38[2]=-(uex[16].f[1]*SG380[2][1]) - uex[16].f[2]*SG380[2][2] - uex[16].f[3]*SG380[2][3];
fex38[3]=-(uex[16].f[1]*SG380[3][1]) - uex[16].f[2]*SG380[3][2] - uex[16].f[3]*SG380[3][3];
fex38[4]=-(uex[16].t[1]*SG380[1][1]) - uex[16].t[2]*SG380[1][2] - uex[16].t[3]*SG380[1][3];
fex38[5]=-(uex[16].t[1]*SG380[2][1]) - uex[16].t[2]*SG380[2][2] - uex[16].t[3]*SG380[2][3];
fex38[6]=-(uex[16].t[1]*SG380[3][1]) - uex[16].t[2]*SG380[3][2] - uex[16].t[3]*SG380[3][3];



}


void
hoap_InvDynNEfunc7(void)
     {
/* total forces and external forces for each joint */
f46[1]=fnet46[1];
f46[2]=fnet46[2];
f46[3]=fnet46[3];
f46[4]=fnet46[4];
f46[5]=fnet46[5];
f46[6]=fnet46[6];

f45[1]=f46[1]*Si4546[1][1] + f46[2]*Si4546[1][2] + f46[3]*Si4546[1][3];
f45[2]=f46[1]*Si4546[2][1] + f46[2]*Si4546[2][2] + f46[3]*Si4546[2][3];
f45[3]=f46[1]*Si4546[3][1] + f46[2]*Si4546[3][2] + f46[3]*Si4546[3][3];
f45[4]=f46[4]*Si4546[1][1] + f46[5]*Si4546[1][2] + f46[6]*Si4546[1][3] + f46[1]*(-(eff[2].x[3]*Si4546[2][1]) + eff[2].x[2]*Si4546[3][1]) + f46[2]*(-(eff[2].x[3]*Si4546[2][2]) + eff[2].x[2]*Si4546[3][2]) + f46[3]*(-(eff[2].x[3]*Si4546[2][3]) + eff[2].x[2]*Si4546[3][3]);
f45[5]=f46[4]*Si4546[2][1] + f46[5]*Si4546[2][2] + f46[6]*Si4546[2][3] + f46[1]*(eff[2].x[3]*Si4546[1][1] - eff[2].x[1]*Si4546[3][1]) + f46[2]*(eff[2].x[3]*Si4546[1][2] - eff[2].x[1]*Si4546[3][2]) + f46[3]*(eff[2].x[3]*Si4546[1][3] - eff[2].x[1]*Si4546[3][3]);
f45[6]=f46[1]*(-(eff[2].x[2]*Si4546[1][1]) + eff[2].x[1]*Si4546[2][1]) + f46[2]*(-(eff[2].x[2]*Si4546[1][2]) + eff[2].x[1]*Si4546[2][2]) + f46[3]*(-(eff[2].x[2]*Si4546[1][3]) + eff[2].x[1]*Si4546[2][3]) + f46[4]*Si4546[3][1] + f46[5]*Si4546[3][2] + f46[6]*Si4546[3][3];

f40[1]=fnet40[1];
f40[2]=fnet40[2];
f40[3]=fnet40[3];
f40[4]=fnet40[4];
f40[5]=fnet40[5];
f40[6]=fnet40[6];

f39[1]=f40[1]*Si3940[1][1] + f40[2]*Si3940[1][2] + f40[3]*Si3940[1][3];
f39[2]=f40[1]*Si3940[2][1] + f40[2]*Si3940[2][2] + f40[3]*Si3940[2][3];
f39[3]=f40[1]*Si3940[3][1] + f40[2]*Si3940[3][2] + f40[3]*Si3940[3][3];
f39[4]=f40[4]*Si3940[1][1] + f40[5]*Si3940[1][2] + f40[6]*Si3940[1][3] + f40[1]*(-(eff[3].x[3]*Si3940[2][1]) + eff[3].x[2]*Si3940[3][1]) + f40[2]*(-(eff[3].x[3]*Si3940[2][2]) + eff[3].x[2]*Si3940[3][2]) + f40[3]*(-(eff[3].x[3]*Si3940[2][3]) + eff[3].x[2]*Si3940[3][3]);
f39[5]=f40[4]*Si3940[2][1] + f40[5]*Si3940[2][2] + f40[6]*Si3940[2][3] + f40[1]*(eff[3].x[3]*Si3940[1][1] - eff[3].x[1]*Si3940[3][1]) + f40[2]*(eff[3].x[3]*Si3940[1][2] - eff[3].x[1]*Si3940[3][2]) + f40[3]*(eff[3].x[3]*Si3940[1][3] - eff[3].x[1]*Si3940[3][3]);
f39[6]=f40[1]*(-(eff[3].x[2]*Si3940[1][1]) + eff[3].x[1]*Si3940[2][1]) + f40[2]*(-(eff[3].x[2]*Si3940[1][2]) + eff[3].x[1]*Si3940[2][2]) + f40[3]*(-(eff[3].x[2]*Si3940[1][3]) + eff[3].x[1]*Si3940[2][3]) + f40[4]*Si3940[3][1] + f40[5]*Si3940[3][2] + f40[6]*Si3940[3][3];

f38[1]=f39[3] + fnet38[1];
f38[2]=-f39[2] + fnet38[2];
f38[3]=f39[1] + fnet38[3];
f38[4]=f39[6] + fnet38[4];
f38[5]=LEGLINK4*f39[1] - f39[5] + fnet38[5];
f38[6]=LEGLINK4*f39[2] + f39[4] + fnet38[6];

f37[1]=fnet37[1] + f38[1]*Si3738[1][1] + f38[2]*Si3738[1][2];
f37[2]=f38[3] + fnet37[2];
f37[3]=fnet37[3] + f38[1]*Si3738[3][1] + f38[2]*Si3738[3][2];
f37[4]=fnet37[4] + f38[4]*Si3738[1][1] + f38[5]*Si3738[1][2];
f37[5]=f38[6] + fnet37[5];
f37[6]=fnet37[6] + f38[4]*Si3738[3][1] + f38[5]*Si3738[3][2];

f36[1]=fnet36[1] + f37[1]*Si3637[1][1] + f37[2]*Si3637[1][2];
f36[2]=fnet36[2] + f37[1]*Si3637[2][1] + f37[2]*Si3637[2][2];
f36[3]=f37[3] + fnet36[3];
f36[4]=fnet36[4] + f37[4]*Si3637[1][1] + f37[5]*Si3637[1][2];
f36[5]=LEGLINK3*f37[3] + fnet36[5] + f37[4]*Si3637[2][1] + f37[5]*Si3637[2][2];
f36[6]=f37[6] + fnet36[6] - LEGLINK3*f37[1]*Si3637[2][1] - LEGLINK3*f37[2]*Si3637[2][2];

f35[1]=fnet35[1] + f36[1]*Si3536[1][1] + f36[2]*Si3536[1][2];
f35[2]=fnet35[2] + f36[1]*Si3536[2][1] + f36[2]*Si3536[2][2];
f35[3]=f36[3] + fnet35[3];
f35[4]=fnet35[4] + f36[4]*Si3536[1][1] + f36[5]*Si3536[1][2];
f35[5]=LEGLINK2*f36[3] + fnet35[5] + f36[4]*Si3536[2][1] + f36[5]*Si3536[2][2];
f35[6]=f36[6] + fnet35[6] - LEGLINK2*f36[1]*Si3536[2][1] - LEGLINK2*f36[2]*Si3536[2][2];

f34[1]=fnet34[1] + f35[1]*Si3435[1][1] + f35[2]*Si3435[1][2];
f34[2]=-f35[3] + fnet34[2];
f34[3]=fnet34[3] + f35[1]*Si3435[3][1] + f35[2]*Si3435[3][2];
f34[4]=fnet34[4] + f35[4]*Si3435[1][1] + f35[5]*Si3435[1][2];
f34[5]=-f35[6] + fnet34[5];
f34[6]=fnet34[6] + f35[4]*Si3435[3][1] + f35[5]*Si3435[3][2];

f33[1]=fnet33[1] + f34[1]*Si3334[1][1] + f34[2]*Si3334[1][2];
f33[2]=-f34[3] + fnet33[2];
f33[3]=fnet33[3] + f34[1]*Si3334[3][1] + f34[2]*Si3334[3][2];
f33[4]=fnet33[4] + f34[4]*Si3334[1][1] + f34[5]*Si3334[1][2];
f33[5]=-f34[6] + fnet33[5];
f33[6]=fnet33[6] + f34[4]*Si3334[3][1] + f34[5]*Si3334[3][2];

f32[1]=fnet32[1];
f32[2]=fnet32[2];
f32[3]=fnet32[3];
f32[4]=fnet32[4];
f32[5]=fnet32[5];
f32[6]=fnet32[6];

f27[1]=fnet27[1] + f32[1]*Si2732[1][1] + f32[2]*Si2732[1][2] + f32[3]*Si2732[1][3];
f27[2]=fnet27[2] + f32[1]*Si2732[2][1] + f32[2]*Si2732[2][2] + f32[3]*Si2732[2][3];
f27[3]=fnet27[3] + f32[1]*Si2732[3][1] + f32[2]*Si2732[3][2] + f32[3]*Si2732[3][3];
f27[4]=fnet27[4] + f32[4]*Si2732[1][1] + f32[5]*Si2732[1][2] + f32[6]*Si2732[1][3] + f32[1]*(-(eff[1].x[3]*Si2732[2][1]) + eff[1].x[2]*Si2732[3][1]) + f32[2]*(-(eff[1].x[3]*Si2732[2][2]) + eff[1].x[2]*Si2732[3][2]) + f32[3]*(-(eff[1].x[3]*Si2732[2][3]) + eff[1].x[2]*Si2732[3][3]);
f27[5]=fnet27[5] + f32[4]*Si2732[2][1] + f32[5]*Si2732[2][2] + f32[6]*Si2732[2][3] + f32[1]*(eff[1].x[3]*Si2732[1][1] - eff[1].x[1]*Si2732[3][1]) + f32[2]*(eff[1].x[3]*Si2732[1][2] - eff[1].x[1]*Si2732[3][2]) + f32[3]*(eff[1].x[3]*Si2732[1][3] - eff[1].x[1]*Si2732[3][3]);
f27[6]=fnet27[6] + f32[1]*(-(eff[1].x[2]*Si2732[1][1]) + eff[1].x[1]*Si2732[2][1]) + f32[2]*(-(eff[1].x[2]*Si2732[1][2]) + eff[1].x[1]*Si2732[2][2]) + f32[3]*(-(eff[1].x[2]*Si2732[1][3]) + eff[1].x[1]*Si2732[2][3]) + f32[4]*Si2732[3][1] + f32[5]*Si2732[3][2] + f32[6]*Si2732[3][3];

f26[1]=fnet26[1] + f27[1]*Si2627[1][1] + f27[2]*Si2627[1][2];
f26[2]=f27[3] + fnet26[2];
f26[3]=fnet26[3] + f27[1]*Si2627[3][1] + f27[2]*Si2627[3][2];
f26[4]=fnet26[4] + f27[4]*Si2627[1][1] + f27[5]*Si2627[1][2];
f26[5]=f27[6] + fnet26[5];
f26[6]=fnet26[6] + f27[4]*Si2627[3][1] + f27[5]*Si2627[3][2];

f25[1]=fnet25[1] + f26[1]*Si2526[1][1] + f26[2]*Si2526[1][2];
f25[2]=fnet25[2] + f26[1]*Si2526[2][1] + f26[2]*Si2526[2][2];
f25[3]=f26[3] + fnet25[3];
f25[4]=fnet25[4] + f26[4]*Si2526[1][1] + f26[5]*Si2526[1][2];
f25[5]=LEGLINK3*f26[3] + fnet25[5] + f26[4]*Si2526[2][1] + f26[5]*Si2526[2][2];
f25[6]=f26[6] + fnet25[6] - LEGLINK3*f26[1]*Si2526[2][1] - LEGLINK3*f26[2]*Si2526[2][2];

f24[1]=fnet24[1] + f25[1]*Si2425[1][1] + f25[2]*Si2425[1][2];
f24[2]=fnet24[2] + f25[1]*Si2425[2][1] + f25[2]*Si2425[2][2];
f24[3]=f25[3] + fnet24[3];
f24[4]=fnet24[4] + f25[4]*Si2425[1][1] + f25[5]*Si2425[1][2];
f24[5]=LEGLINK2*f25[3] + fnet24[5] + f25[4]*Si2425[2][1] + f25[5]*Si2425[2][2];
f24[6]=f25[6] + fnet24[6] - LEGLINK2*f25[1]*Si2425[2][1] - LEGLINK2*f25[2]*Si2425[2][2];

f23[1]=fnet23[1] + f24[1]*Si2324[1][1] + f24[2]*Si2324[1][2];
f23[2]=-f24[3] + fnet23[2];
f23[3]=fnet23[3] + f24[1]*Si2324[3][1] + f24[2]*Si2324[3][2];
f23[4]=fnet23[4] + f24[4]*Si2324[1][1] + f24[5]*Si2324[1][2];
f23[5]=-f24[6] + fnet23[5];
f23[6]=fnet23[6] + f24[4]*Si2324[3][1] + f24[5]*Si2324[3][2];

f22[1]=fnet22[1] + f23[1]*Si2223[1][1] + f23[2]*Si2223[1][2];
f22[2]=-f23[3] + fnet22[2];
f22[3]=fnet22[3] + f23[1]*Si2223[3][1] + f23[2]*Si2223[3][2];
f22[4]=fnet22[4] + f23[4]*Si2223[1][1] + f23[5]*Si2223[1][2];
f22[5]=-f23[6] + fnet22[5];
f22[6]=fnet22[6] + f23[4]*Si2223[3][1] + f23[5]*Si2223[3][2];

f21[1]=fnet21[1] + f22[1]*Si2122[1][1] + f22[2]*Si2122[1][2] + f33[1]*Si2133[1][1] + f33[2]*Si2133[1][2];
f21[2]=f22[3] + f33[3] + fnet21[2];
f21[3]=fnet21[3] + f22[1]*Si2122[3][1] + f22[2]*Si2122[3][2] + f33[1]*Si2133[3][1] + f33[2]*Si2133[3][2];
f21[4]=-(LEGLINK1*f22[3]) + LEGLINK1*f33[3] + fnet21[4] + f22[4]*Si2122[1][1] + f22[5]*Si2122[1][2] - WAISTLINK1*f22[1]*Si2122[3][1] - WAISTLINK1*f22[2]*Si2122[3][2] + f33[4]*Si2133[1][1] + f33[5]*Si2133[1][2] - WAISTLINK1*f33[1]*Si2133[3][1] - WAISTLINK1*f33[2]*Si2133[3][2];
f21[5]=f22[6] + f33[6] + fnet21[5] + f22[1]*(LEGLINK1*Si2122[1][1] + WAISTLINK2*Si2122[3][1]) + f22[2]*(LEGLINK1*Si2122[1][2] + WAISTLINK2*Si2122[3][2]) + f33[1]*(-(LEGLINK1*Si2133[1][1]) + WAISTLINK2*Si2133[3][1]) + f33[2]*(-(LEGLINK1*Si2133[1][2]) + WAISTLINK2*Si2133[3][2]);
f21[6]=-(WAISTLINK2*f22[3]) - WAISTLINK2*f33[3] + fnet21[6] + WAISTLINK1*f22[1]*Si2122[1][1] + WAISTLINK1*f22[2]*Si2122[1][2] + f22[4]*Si2122[3][1] + f22[5]*Si2122[3][2] + WAISTLINK1*f33[1]*Si2133[1][1] + WAISTLINK1*f33[2]*Si2133[1][2] + f33[4]*Si2133[3][1] + f33[5]*Si2133[3][2];

f20[1]=fnet20[1];
f20[2]=fnet20[2];
f20[3]=fnet20[3];
f20[4]=fnet20[4];
f20[5]=fnet20[5];
f20[6]=fnet20[6];

f19[1]=f20[1]*Si1920[1][1] + f20[2]*Si1920[1][2];
f19[2]=-f20[3];
f19[3]=f20[1]*Si1920[3][1] + f20[2]*Si1920[3][2];
f19[4]=f20[4]*Si1920[1][1] + f20[5]*Si1920[1][2];
f19[5]=-f20[6];
f19[6]=f20[4]*Si1920[3][1] + f20[5]*Si1920[3][2];

f18[1]=f19[1] + fnet18[1];
f18[2]=f19[3] + fnet18[2];
f18[3]=-f19[2] + fnet18[3];
f18[4]=-(HEADLINK1*f19[3]) + f19[4] + fnet18[4];
f18[5]=HEADLINK1*f19[1] + HEADLINK2*f19[2] + f19[6] + fnet18[5];
f18[6]=HEADLINK2*f19[3] - f19[5] + fnet18[6];

f17[1]=fnet17[1];
f17[2]=fnet17[2];
f17[3]=fnet17[3];
f17[4]=fnet17[4];
f17[5]=fnet17[5];
f17[6]=fnet17[6];

f16[1]=f17[1]*Si1617[1][1] + f17[2]*Si1617[1][2] + f17[3]*Si1617[1][3];
f16[2]=f17[1]*Si1617[2][1] + f17[2]*Si1617[2][2] + f17[3]*Si1617[2][3];
f16[3]=f17[1]*Si1617[3][1] + f17[2]*Si1617[3][2] + f17[3]*Si1617[3][3];
f16[4]=f17[4]*Si1617[1][1] + f17[5]*Si1617[1][2] + f17[6]*Si1617[1][3] + f17[1]*(-(eff[4].x[3]*Si1617[2][1]) + eff[4].x[2]*Si1617[3][1]) + f17[2]*(-(eff[4].x[3]*Si1617[2][2]) + eff[4].x[2]*Si1617[3][2]) + f17[3]*(-(eff[4].x[3]*Si1617[2][3]) + eff[4].x[2]*Si1617[3][3]);
f16[5]=f17[4]*Si1617[2][1] + f17[5]*Si1617[2][2] + f17[6]*Si1617[2][3] + f17[1]*(eff[4].x[3]*Si1617[1][1] - eff[4].x[1]*Si1617[3][1]) + f17[2]*(eff[4].x[3]*Si1617[1][2] - eff[4].x[1]*Si1617[3][2]) + f17[3]*(eff[4].x[3]*Si1617[1][3] - eff[4].x[1]*Si1617[3][3]);
f16[6]=f17[1]*(-(eff[4].x[2]*Si1617[1][1]) + eff[4].x[1]*Si1617[2][1]) + f17[2]*(-(eff[4].x[2]*Si1617[1][2]) + eff[4].x[1]*Si1617[2][2]) + f17[3]*(-(eff[4].x[2]*Si1617[1][3]) + eff[4].x[1]*Si1617[2][3]) + f17[4]*Si1617[3][1] + f17[5]*Si1617[3][2] + f17[6]*Si1617[3][3];

f14[1]=fnet14[1];
f14[2]=fnet14[2];
f14[3]=fnet14[3];
f14[4]=fnet14[4];
f14[5]=fnet14[5];
f14[6]=fnet14[6];

f13[1]=f14[3] + f16[1] + fnet13[1];
f13[2]=f16[2] + fnet13[2] + f14[1]*Si1314[2][1] + f14[2]*Si1314[2][2];
f13[3]=f16[3] + fnet13[3] + f14[1]*Si1314[3][1] + f14[2]*Si1314[3][2];
f13[4]=f14[6] - PALM*f16[2] + f16[4] + fnet13[4] - GRIPJOFFZ*f14[1]*Si1314[2][1] - GRIPJOFFZ*f14[2]*Si1314[2][2];
f13[5]=GRIPJOFFZ*f14[3] + PALM*f16[1] + PALMOFFSETX*f16[3] + f16[5] + fnet13[5] + f14[4]*Si1314[2][1] + f14[5]*Si1314[2][2] + GRIPJOFFX*f14[1]*Si1314[3][1] + GRIPJOFFX*f14[2]*Si1314[3][2];
f13[6]=-(PALMOFFSETX*f16[2]) + f16[6] + fnet13[6] - GRIPJOFFX*f14[1]*Si1314[2][1] - GRIPJOFFX*f14[2]*Si1314[2][2] + f14[4]*Si1314[3][1] + f14[5]*Si1314[3][2];

f12[1]=fnet12[1] + f13[1]*Si1213[1][1] + f13[2]*Si1213[1][2];
f12[2]=f13[3] + fnet12[2];
f12[3]=fnet12[3] + f13[1]*Si1213[3][1] + f13[2]*Si1213[3][2];
f12[4]=fnet12[4] + f13[4]*Si1213[1][1] + f13[5]*Si1213[1][2] + ARMLINK3*f13[1]*Si1213[3][1] + ARMLINK3*f13[2]*Si1213[3][2];
f12[5]=f13[6] + fnet12[5];
f12[6]=fnet12[6] - ARMLINK3*f13[1]*Si1213[1][1] - ARMLINK3*f13[2]*Si1213[1][2] + f13[4]*Si1213[3][1] + f13[5]*Si1213[3][2];

f11[1]=fnet11[1] + f12[1]*Si1112[1][1] + f12[2]*Si1112[1][2];
f11[2]=-f12[3] + fnet11[2];
f11[3]=fnet11[3] + f12[1]*Si1112[3][1] + f12[2]*Si1112[3][2];
f11[4]=fnet11[4] + f12[4]*Si1112[1][1] + f12[5]*Si1112[1][2];
f11[5]=-f12[6] + fnet11[5];
f11[6]=fnet11[6] + f12[4]*Si1112[3][1] + f12[5]*Si1112[3][2];

f10[1]=fnet10[1] + f11[1]*Si1011[1][1] + f11[2]*Si1011[1][2];
f10[2]=-f11[3] + fnet10[2];
f10[3]=fnet10[3] + f11[1]*Si1011[3][1] + f11[2]*Si1011[3][2];
f10[4]=fnet10[4] + f11[4]*Si1011[1][1] + f11[5]*Si1011[1][2] - ARMLINK2*f11[1]*Si1011[3][1] - ARMLINK2*f11[2]*Si1011[3][2];
f10[5]=-f11[6] + fnet10[5];
f10[6]=fnet10[6] + ARMLINK2*f11[1]*Si1011[1][1] + ARMLINK2*f11[2]*Si1011[1][2] + f11[4]*Si1011[3][1] + f11[5]*Si1011[3][2];

f9[1]=fnet9[1] + f10[1]*Si910[1][1] + f10[2]*Si910[1][2];
f9[2]=-f10[3] + fnet9[2];
f9[3]=fnet9[3] + f10[1]*Si910[3][1] + f10[2]*Si910[3][2];
f9[4]=fnet9[4] + f10[4]*Si910[1][1] + f10[5]*Si910[1][2];
f9[5]=-f10[6] + fnet9[5];
f9[6]=fnet9[6] + f10[4]*Si910[3][1] + f10[5]*Si910[3][2];

f5[1]=fnet5[1];
f5[2]=fnet5[2];
f5[3]=fnet5[3];
f5[4]=fnet5[4];
f5[5]=fnet5[5];
f5[6]=fnet5[6];

f4[1]=fnet4[1] + f5[1]*Si45[1][1] + f5[2]*Si45[1][2];
f4[2]=-f5[3] + fnet4[2];
f4[3]=fnet4[3] + f5[1]*Si45[3][1] + f5[2]*Si45[3][2];
f4[4]=fnet4[4] + f5[4]*Si45[1][1] + f5[5]*Si45[1][2];
f4[5]=-f5[6] + fnet4[5];
f4[6]=fnet4[6] + f5[4]*Si45[3][1] + f5[5]*Si45[3][2];

f3[1]=fnet3[1] + f4[1]*Si34[1][1] + f4[2]*Si34[1][2];
f3[2]=-f4[3] + fnet3[2];
f3[3]=fnet3[3] + f4[1]*Si34[3][1] + f4[2]*Si34[3][2];
f3[4]=fnet3[4] + f4[4]*Si34[1][1] + f4[5]*Si34[1][2] - ARMLINK2*f4[1]*Si34[3][1] - ARMLINK2*f4[2]*Si34[3][2];
f3[5]=-f4[6] + fnet3[5];
f3[6]=fnet3[6] + ARMLINK2*f4[1]*Si34[1][1] + ARMLINK2*f4[2]*Si34[1][2] + f4[4]*Si34[3][1] + f4[5]*Si34[3][2];

f2[1]=fnet2[1] + f3[1]*Si23[1][1] + f3[2]*Si23[1][2];
f2[2]=-f3[3] + fnet2[2];
f2[3]=fnet2[3] + f3[1]*Si23[3][1] + f3[2]*Si23[3][2];
f2[4]=fnet2[4] + f3[4]*Si23[1][1] + f3[5]*Si23[1][2];
f2[5]=-f3[6] + fnet2[5];
f2[6]=fnet2[6] + f3[4]*Si23[3][1] + f3[5]*Si23[3][2];

f1[1]=f18[1]*Si118[1][1] + f18[2]*Si118[1][2] + f2[1]*Si12[1][1] + f2[2]*Si12[1][2] + f9[1]*Si19[1][1] + f9[2]*Si19[1][2];
f1[2]=f2[3] + f9[3] + f18[1]*Si118[2][1] + f18[2]*Si118[2][2];
f1[3]=f18[3] + f2[1]*Si12[3][1] + f2[2]*Si12[3][2] + f9[1]*Si19[3][1] + f9[2]*Si19[3][2];
f1[4]=f18[4]*Si118[1][1] + f18[5]*Si118[1][2] + f2[4]*Si12[1][1] + f2[5]*Si12[1][2] - ARMLINK1*f2[1]*Si12[3][1] - ARMLINK1*f2[2]*Si12[3][2] + f9[4]*Si19[1][1] + f9[5]*Si19[1][2] + ARMLINK1*f9[1]*Si19[3][1] + ARMLINK1*f9[2]*Si19[3][2];
f1[5]=f2[6] + f9[6] + f18[4]*Si118[2][1] + f18[5]*Si118[2][2];
f1[6]=f18[6] + ARMLINK1*f2[1]*Si12[1][1] + ARMLINK1*f2[2]*Si12[1][2] + f2[4]*Si12[3][1] + f2[5]*Si12[3][2] - ARMLINK1*f9[1]*Si19[1][1] - ARMLINK1*f9[2]*Si19[1][2] + f9[4]*Si19[3][1] + f9[5]*Si19[3][2];

f0[1]=f1[1] + f45[1] + fnet0[1] + f21[1]*Si021[1][1] + f21[2]*Si021[1][2];
f0[2]=f1[2] - f21[3] + f45[2] + fnet0[2];
f0[3]=f1[3] + f45[3] + fnet0[3] + f21[1]*Si021[3][1] + f21[2]*Si021[3][2];
f0[4]=-(BODYLINK1*f1[2]) + f1[4] - PALM*f45[2] + f45[4] + fnet0[4] + f21[4]*Si021[1][1] + f21[5]*Si021[1][2];
f0[5]=BODYLINK1*f1[1] + f1[5] - f21[6] + PALM*f45[1] + PALMOFFSETX*f45[3] + f45[5] + fnet0[5] - BODYLINK2*f21[1]*Si021[3][1] - BODYLINK2*f21[2]*Si021[3][2];
f0[6]=f1[6] - BODYLINK2*f21[3] - PALMOFFSETX*f45[2] + f45[6] + fnet0[6] + f21[4]*Si021[3][1] + f21[5]*Si021[3][2];


fext38[1]=fex38[1];
fext38[2]=fex38[2];
fext38[3]=fex38[3];
fext38[4]=fex38[4];
fext38[5]=fex38[5];
fext38[6]=fex38[6];

fext37[1]=fex37[1] + fext38[1]*Si3738[1][1] + fext38[2]*Si3738[1][2];
fext37[2]=fex37[2] + fext38[3];
fext37[3]=fex37[3] + fext38[1]*Si3738[3][1] + fext38[2]*Si3738[3][2];
fext37[4]=fex37[4] + fext38[4]*Si3738[1][1] + fext38[5]*Si3738[1][2];
fext37[5]=fex37[5] + fext38[6];
fext37[6]=fex37[6] + fext38[4]*Si3738[3][1] + fext38[5]*Si3738[3][2];

fext36[1]=fex36[1] + fext37[1]*Si3637[1][1] + fext37[2]*Si3637[1][2];
fext36[2]=fex36[2] + fext37[1]*Si3637[2][1] + fext37[2]*Si3637[2][2];
fext36[3]=fex36[3] + fext37[3];
fext36[4]=fex36[4] + fext37[4]*Si3637[1][1] + fext37[5]*Si3637[1][2];
fext36[5]=fex36[5] + LEGLINK3*fext37[3] + fext37[4]*Si3637[2][1] + fext37[5]*Si3637[2][2];
fext36[6]=fex36[6] + fext37[6] - LEGLINK3*fext37[1]*Si3637[2][1] - LEGLINK3*fext37[2]*Si3637[2][2];

fext35[1]=fex35[1] + fext36[1]*Si3536[1][1] + fext36[2]*Si3536[1][2];
fext35[2]=fex35[2] + fext36[1]*Si3536[2][1] + fext36[2]*Si3536[2][2];
fext35[3]=fex35[3] + fext36[3];
fext35[4]=fex35[4] + fext36[4]*Si3536[1][1] + fext36[5]*Si3536[1][2];
fext35[5]=fex35[5] + LEGLINK2*fext36[3] + fext36[4]*Si3536[2][1] + fext36[5]*Si3536[2][2];
fext35[6]=fex35[6] + fext36[6] - LEGLINK2*fext36[1]*Si3536[2][1] - LEGLINK2*fext36[2]*Si3536[2][2];

fext34[1]=fex34[1] + fext35[1]*Si3435[1][1] + fext35[2]*Si3435[1][2];
fext34[2]=fex34[2] - fext35[3];
fext34[3]=fex34[3] + fext35[1]*Si3435[3][1] + fext35[2]*Si3435[3][2];
fext34[4]=fex34[4] + fext35[4]*Si3435[1][1] + fext35[5]*Si3435[1][2];
fext34[5]=fex34[5] - fext35[6];
fext34[6]=fex34[6] + fext35[4]*Si3435[3][1] + fext35[5]*Si3435[3][2];

fext33[1]=fex33[1] + fext34[1]*Si3334[1][1] + fext34[2]*Si3334[1][2];
fext33[2]=fex33[2] - fext34[3];
fext33[3]=fex33[3] + fext34[1]*Si3334[3][1] + fext34[2]*Si3334[3][2];
fext33[4]=fex33[4] + fext34[4]*Si3334[1][1] + fext34[5]*Si3334[1][2];
fext33[5]=fex33[5] - fext34[6];
fext33[6]=fex33[6] + fext34[4]*Si3334[3][1] + fext34[5]*Si3334[3][2];

fext27[1]=fex27[1];
fext27[2]=fex27[2];
fext27[3]=fex27[3];
fext27[4]=fex27[4];
fext27[5]=fex27[5];
fext27[6]=fex27[6];

fext26[1]=fex26[1] + fext27[1]*Si2627[1][1] + fext27[2]*Si2627[1][2];
fext26[2]=fex26[2] + fext27[3];
fext26[3]=fex26[3] + fext27[1]*Si2627[3][1] + fext27[2]*Si2627[3][2];
fext26[4]=fex26[4] + fext27[4]*Si2627[1][1] + fext27[5]*Si2627[1][2];
fext26[5]=fex26[5] + fext27[6];
fext26[6]=fex26[6] + fext27[4]*Si2627[3][1] + fext27[5]*Si2627[3][2];

fext25[1]=fex25[1] + fext26[1]*Si2526[1][1] + fext26[2]*Si2526[1][2];
fext25[2]=fex25[2] + fext26[1]*Si2526[2][1] + fext26[2]*Si2526[2][2];
fext25[3]=fex25[3] + fext26[3];
fext25[4]=fex25[4] + fext26[4]*Si2526[1][1] + fext26[5]*Si2526[1][2];
fext25[5]=fex25[5] + LEGLINK3*fext26[3] + fext26[4]*Si2526[2][1] + fext26[5]*Si2526[2][2];
fext25[6]=fex25[6] + fext26[6] - LEGLINK3*fext26[1]*Si2526[2][1] - LEGLINK3*fext26[2]*Si2526[2][2];

fext24[1]=fex24[1] + fext25[1]*Si2425[1][1] + fext25[2]*Si2425[1][2];
fext24[2]=fex24[2] + fext25[1]*Si2425[2][1] + fext25[2]*Si2425[2][2];
fext24[3]=fex24[3] + fext25[3];
fext24[4]=fex24[4] + fext25[4]*Si2425[1][1] + fext25[5]*Si2425[1][2];
fext24[5]=fex24[5] + LEGLINK2*fext25[3] + fext25[4]*Si2425[2][1] + fext25[5]*Si2425[2][2];
fext24[6]=fex24[6] + fext25[6] - LEGLINK2*fext25[1]*Si2425[2][1] - LEGLINK2*fext25[2]*Si2425[2][2];

fext23[1]=fex23[1] + fext24[1]*Si2324[1][1] + fext24[2]*Si2324[1][2];
fext23[2]=fex23[2] - fext24[3];
fext23[3]=fex23[3] + fext24[1]*Si2324[3][1] + fext24[2]*Si2324[3][2];
fext23[4]=fex23[4] + fext24[4]*Si2324[1][1] + fext24[5]*Si2324[1][2];
fext23[5]=fex23[5] - fext24[6];
fext23[6]=fex23[6] + fext24[4]*Si2324[3][1] + fext24[5]*Si2324[3][2];

fext22[1]=fex22[1] + fext23[1]*Si2223[1][1] + fext23[2]*Si2223[1][2];
fext22[2]=fex22[2] - fext23[3];
fext22[3]=fex22[3] + fext23[1]*Si2223[3][1] + fext23[2]*Si2223[3][2];
fext22[4]=fex22[4] + fext23[4]*Si2223[1][1] + fext23[5]*Si2223[1][2];
fext22[5]=fex22[5] - fext23[6];
fext22[6]=fex22[6] + fext23[4]*Si2223[3][1] + fext23[5]*Si2223[3][2];

fext21[1]=fex21[1] + fext22[1]*Si2122[1][1] + fext22[2]*Si2122[1][2] + fext33[1]*Si2133[1][1] + fext33[2]*Si2133[1][2];
fext21[2]=fex21[2] + fext22[3] + fext33[3];
fext21[3]=fex21[3] + fext22[1]*Si2122[3][1] + fext22[2]*Si2122[3][2] + fext33[1]*Si2133[3][1] + fext33[2]*Si2133[3][2];
fext21[4]=fex21[4] - LEGLINK1*fext22[3] + LEGLINK1*fext33[3] + fext22[4]*Si2122[1][1] + fext22[5]*Si2122[1][2] - WAISTLINK1*fext22[1]*Si2122[3][1] - WAISTLINK1*fext22[2]*Si2122[3][2] + fext33[4]*Si2133[1][1] + fext33[5]*Si2133[1][2] - WAISTLINK1*fext33[1]*Si2133[3][1] - WAISTLINK1*fext33[2]*Si2133[3][2];
fext21[5]=fex21[5] + fext22[6] + fext33[6] + fext22[1]*(LEGLINK1*Si2122[1][1] + WAISTLINK2*Si2122[3][1]) + fext22[2]*(LEGLINK1*Si2122[1][2] + WAISTLINK2*Si2122[3][2]) + fext33[1]*(-(LEGLINK1*Si2133[1][1]) + WAISTLINK2*Si2133[3][1]) + fext33[2]*(-(LEGLINK1*Si2133[1][2]) + WAISTLINK2*Si2133[3][2]);
fext21[6]=fex21[6] - WAISTLINK2*fext22[3] - WAISTLINK2*fext33[3] + WAISTLINK1*fext22[1]*Si2122[1][1] + WAISTLINK1*fext22[2]*Si2122[1][2] + fext22[4]*Si2122[3][1] + fext22[5]*Si2122[3][2] + WAISTLINK1*fext33[1]*Si2133[1][1] + WAISTLINK1*fext33[2]*Si2133[1][2] + fext33[4]*Si2133[3][1] + fext33[5]*Si2133[3][2];

fext20[1]=fex20[1];
fext20[2]=fex20[2];
fext20[3]=fex20[3];
fext20[4]=fex20[4];
fext20[5]=fex20[5];
fext20[6]=fex20[6];

fext19[1]=fext20[1]*Si1920[1][1] + fext20[2]*Si1920[1][2];
fext19[2]=-fext20[3];
fext19[3]=fext20[1]*Si1920[3][1] + fext20[2]*Si1920[3][2];
fext19[4]=fext20[4]*Si1920[1][1] + fext20[5]*Si1920[1][2];
fext19[5]=-fext20[6];
fext19[6]=fext20[4]*Si1920[3][1] + fext20[5]*Si1920[3][2];

fext18[1]=fex18[1] + fext19[1];
fext18[2]=fex18[2] + fext19[3];
fext18[3]=fex18[3] - fext19[2];
fext18[4]=fex18[4] - HEADLINK1*fext19[3] + fext19[4];
fext18[5]=fex18[5] + HEADLINK1*fext19[1] + HEADLINK2*fext19[2] + fext19[6];
fext18[6]=fex18[6] + HEADLINK2*fext19[3] - fext19[5];

fext14[1]=fex14[1];
fext14[2]=fex14[2];
fext14[3]=fex14[3];
fext14[4]=fex14[4];
fext14[5]=fex14[5];
fext14[6]=fex14[6];

fext13[1]=fex13[1] + fext14[3];
fext13[2]=fex13[2] + fext14[1]*Si1314[2][1] + fext14[2]*Si1314[2][2];
fext13[3]=fex13[3] + fext14[1]*Si1314[3][1] + fext14[2]*Si1314[3][2];
fext13[4]=fex13[4] + fext14[6] - GRIPJOFFZ*fext14[1]*Si1314[2][1] - GRIPJOFFZ*fext14[2]*Si1314[2][2];
fext13[5]=fex13[5] + GRIPJOFFZ*fext14[3] + fext14[4]*Si1314[2][1] + fext14[5]*Si1314[2][2] + GRIPJOFFX*fext14[1]*Si1314[3][1] + GRIPJOFFX*fext14[2]*Si1314[3][2];
fext13[6]=fex13[6] - GRIPJOFFX*fext14[1]*Si1314[2][1] - GRIPJOFFX*fext14[2]*Si1314[2][2] + fext14[4]*Si1314[3][1] + fext14[5]*Si1314[3][2];

fext12[1]=fex12[1] + fext13[1]*Si1213[1][1] + fext13[2]*Si1213[1][2];
fext12[2]=fex12[2] + fext13[3];
fext12[3]=fex12[3] + fext13[1]*Si1213[3][1] + fext13[2]*Si1213[3][2];
fext12[4]=fex12[4] + fext13[4]*Si1213[1][1] + fext13[5]*Si1213[1][2] + ARMLINK3*fext13[1]*Si1213[3][1] + ARMLINK3*fext13[2]*Si1213[3][2];
fext12[5]=fex12[5] + fext13[6];
fext12[6]=fex12[6] - ARMLINK3*fext13[1]*Si1213[1][1] - ARMLINK3*fext13[2]*Si1213[1][2] + fext13[4]*Si1213[3][1] + fext13[5]*Si1213[3][2];

fext11[1]=fex11[1] + fext12[1]*Si1112[1][1] + fext12[2]*Si1112[1][2];
fext11[2]=fex11[2] - fext12[3];
fext11[3]=fex11[3] + fext12[1]*Si1112[3][1] + fext12[2]*Si1112[3][2];
fext11[4]=fex11[4] + fext12[4]*Si1112[1][1] + fext12[5]*Si1112[1][2];
fext11[5]=fex11[5] - fext12[6];
fext11[6]=fex11[6] + fext12[4]*Si1112[3][1] + fext12[5]*Si1112[3][2];

fext10[1]=fex10[1] + fext11[1]*Si1011[1][1] + fext11[2]*Si1011[1][2];
fext10[2]=fex10[2] - fext11[3];
fext10[3]=fex10[3] + fext11[1]*Si1011[3][1] + fext11[2]*Si1011[3][2];
fext10[4]=fex10[4] + fext11[4]*Si1011[1][1] + fext11[5]*Si1011[1][2] - ARMLINK2*fext11[1]*Si1011[3][1] - ARMLINK2*fext11[2]*Si1011[3][2];
fext10[5]=fex10[5] - fext11[6];
fext10[6]=fex10[6] + ARMLINK2*fext11[1]*Si1011[1][1] + ARMLINK2*fext11[2]*Si1011[1][2] + fext11[4]*Si1011[3][1] + fext11[5]*Si1011[3][2];

fext9[1]=fex9[1] + fext10[1]*Si910[1][1] + fext10[2]*Si910[1][2];
fext9[2]=fex9[2] - fext10[3];
fext9[3]=fex9[3] + fext10[1]*Si910[3][1] + fext10[2]*Si910[3][2];
fext9[4]=fex9[4] + fext10[4]*Si910[1][1] + fext10[5]*Si910[1][2];
fext9[5]=fex9[5] - fext10[6];
fext9[6]=fex9[6] + fext10[4]*Si910[3][1] + fext10[5]*Si910[3][2];

fext5[1]=fex5[1];
fext5[2]=fex5[2];
fext5[3]=fex5[3];
fext5[4]=fex5[4];
fext5[5]=fex5[5];
fext5[6]=fex5[6];

fext4[1]=fex4[1] + fext5[1]*Si45[1][1] + fext5[2]*Si45[1][2];
fext4[2]=fex4[2] - fext5[3];
fext4[3]=fex4[3] + fext5[1]*Si45[3][1] + fext5[2]*Si45[3][2];
fext4[4]=fex4[4] + fext5[4]*Si45[1][1] + fext5[5]*Si45[1][2];
fext4[5]=fex4[5] - fext5[6];
fext4[6]=fex4[6] + fext5[4]*Si45[3][1] + fext5[5]*Si45[3][2];

fext3[1]=fex3[1] + fext4[1]*Si34[1][1] + fext4[2]*Si34[1][2];
fext3[2]=fex3[2] - fext4[3];
fext3[3]=fex3[3] + fext4[1]*Si34[3][1] + fext4[2]*Si34[3][2];
fext3[4]=fex3[4] + fext4[4]*Si34[1][1] + fext4[5]*Si34[1][2] - ARMLINK2*fext4[1]*Si34[3][1] - ARMLINK2*fext4[2]*Si34[3][2];
fext3[5]=fex3[5] - fext4[6];
fext3[6]=fex3[6] + ARMLINK2*fext4[1]*Si34[1][1] + ARMLINK2*fext4[2]*Si34[1][2] + fext4[4]*Si34[3][1] + fext4[5]*Si34[3][2];

fext2[1]=fex2[1] + fext3[1]*Si23[1][1] + fext3[2]*Si23[1][2];
fext2[2]=fex2[2] - fext3[3];
fext2[3]=fex2[3] + fext3[1]*Si23[3][1] + fext3[2]*Si23[3][2];
fext2[4]=fex2[4] + fext3[4]*Si23[1][1] + fext3[5]*Si23[1][2];
fext2[5]=fex2[5] - fext3[6];
fext2[6]=fex2[6] + fext3[4]*Si23[3][1] + fext3[5]*Si23[3][2];

fext1[1]=fext18[1]*Si118[1][1] + fext18[2]*Si118[1][2] + fext2[1]*Si12[1][1] + fext2[2]*Si12[1][2] + fext9[1]*Si19[1][1] + fext9[2]*Si19[1][2];
fext1[2]=fext2[3] + fext9[3] + fext18[1]*Si118[2][1] + fext18[2]*Si118[2][2];
fext1[3]=fext18[3] + fext2[1]*Si12[3][1] + fext2[2]*Si12[3][2] + fext9[1]*Si19[3][1] + fext9[2]*Si19[3][2];
fext1[4]=fext18[4]*Si118[1][1] + fext18[5]*Si118[1][2] + fext2[4]*Si12[1][1] + fext2[5]*Si12[1][2] - ARMLINK1*fext2[1]*Si12[3][1] - ARMLINK1*fext2[2]*Si12[3][2] + fext9[4]*Si19[1][1] + fext9[5]*Si19[1][2] + ARMLINK1*fext9[1]*Si19[3][1] + ARMLINK1*fext9[2]*Si19[3][2];
fext1[5]=fext2[6] + fext9[6] + fext18[4]*Si118[2][1] + fext18[5]*Si118[2][2];
fext1[6]=fext18[6] + ARMLINK1*fext2[1]*Si12[1][1] + ARMLINK1*fext2[2]*Si12[1][2] + fext2[4]*Si12[3][1] + fext2[5]*Si12[3][2] - ARMLINK1*fext9[1]*Si19[1][1] - ARMLINK1*fext9[2]*Si19[1][2] + fext9[4]*Si19[3][1] + fext9[5]*Si19[3][2];

fext0[1]=fex0[1] + fext1[1] + fext21[1]*Si021[1][1] + fext21[2]*Si021[1][2];
fext0[2]=fex0[2] + fext1[2] - fext21[3];
fext0[3]=fex0[3] + fext1[3] + fext21[1]*Si021[3][1] + fext21[2]*Si021[3][2];
fext0[4]=fex0[4] - BODYLINK1*fext1[2] + fext1[4] + fext21[4]*Si021[1][1] + fext21[5]*Si021[1][2];
fext0[5]=fex0[5] + BODYLINK1*fext1[1] + fext1[5] - fext21[6] - BODYLINK2*fext21[1]*Si021[3][1] - BODYLINK2*fext21[2]*Si021[3][2];
fext0[6]=fex0[6] + fext1[6] - BODYLINK2*fext21[3] + fext21[4]*Si021[3][1] + fext21[5]*Si021[3][2];



}

