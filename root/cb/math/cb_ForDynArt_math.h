/* sine and cosine precomputation */
sstate29th=Sin(state[29].th);
cstate29th=Cos(state[29].th);

sstate30th=Sin(state[30].th);
cstate30th=Cos(state[30].th);

sstate31th=Sin(state[31].th);
cstate31th=Cos(state[31].th);

sstate1th=Sin(state[1].th);
cstate1th=Cos(state[1].th);

sstate2th=Sin(state[2].th);
cstate2th=Cos(state[2].th);

sstate3th=Sin(state[3].th);
cstate3th=Cos(state[3].th);

sstate4th=Sin(state[4].th);
cstate4th=Cos(state[4].th);

sstate5th=Sin(state[5].th);
cstate5th=Cos(state[5].th);

sstate6th=Sin(state[6].th);
cstate6th=Cos(state[6].th);

sstate7th=Sin(state[7].th);
cstate7th=Cos(state[7].th);

sstate8th=Sin(state[8].th);
cstate8th=Cos(state[8].th);

sstate9th=Sin(state[9].th);
cstate9th=Cos(state[9].th);

sstate10th=Sin(state[10].th);
cstate10th=Cos(state[10].th);

sstate11th=Sin(state[11].th);
cstate11th=Cos(state[11].th);

sstate12th=Sin(state[12].th);
cstate12th=Cos(state[12].th);

sstate13th=Sin(state[13].th);
cstate13th=Cos(state[13].th);

sstate14th=Sin(state[14].th);
cstate14th=Cos(state[14].th);

sstate32th=Sin(state[32].th);
cstate32th=Cos(state[32].th);

sstate33th=Sin(state[33].th);
cstate33th=Cos(state[33].th);

sstate34th=Sin(state[34].th);
cstate34th=Cos(state[34].th);

sstate35th=Sin(state[35].th);
cstate35th=Cos(state[35].th);

sstate36th=Sin(state[36].th);
cstate36th=Cos(state[36].th);

sstate37th=Sin(state[37].th);
cstate37th=Cos(state[37].th);

sstate38th=Sin(state[38].th);
cstate38th=Cos(state[38].th);

sstate23th=Sin(state[23].th);
cstate23th=Cos(state[23].th);

sstate22th=Sin(state[22].th);
cstate22th=Cos(state[22].th);

sstate24th=Sin(state[24].th);
cstate24th=Cos(state[24].th);

sstate25th=Sin(state[25].th);
cstate25th=Cos(state[25].th);

sstate26th=Sin(state[26].th);
cstate26th=Cos(state[26].th);

sstate27th=Sin(state[27].th);
cstate27th=Cos(state[27].th);

sstate28th=Sin(state[28].th);
cstate28th=Cos(state[28].th);

sstate16th=Sin(state[16].th);
cstate16th=Cos(state[16].th);

sstate15th=Sin(state[15].th);
cstate15th=Cos(state[15].th);

sstate17th=Sin(state[17].th);
cstate17th=Cos(state[17].th);

sstate18th=Sin(state[18].th);
cstate18th=Cos(state[18].th);

sstate19th=Sin(state[19].th);
cstate19th=Cos(state[19].th);

sstate20th=Sin(state[20].th);
cstate20th=Cos(state[20].th);

sstate21th=Sin(state[21].th);
cstate21th=Cos(state[21].th);


/* rotation matrix sine and cosine precomputation */










rseff2a1=Sin(eff[2].a[1]);
rceff2a1=Cos(eff[2].a[1]);

rseff2a2=Sin(eff[2].a[2]);
rceff2a2=Cos(eff[2].a[2]);

rseff2a3=Sin(eff[2].a[3]);
rceff2a3=Cos(eff[2].a[3]);









rseff1a1=Sin(eff[1].a[1]);
rceff1a1=Cos(eff[1].a[1]);

rseff1a2=Sin(eff[1].a[2]);
rceff1a2=Cos(eff[1].a[2]);

rseff1a3=Sin(eff[1].a[3]);
rceff1a3=Cos(eff[1].a[3]);























rseff3a1=Sin(eff[3].a[1]);
rceff3a1=Cos(eff[3].a[1]);

rseff3a2=Sin(eff[3].a[2]);
rceff3a2=Cos(eff[3].a[2]);

rseff3a3=Sin(eff[3].a[3]);
rceff3a3=Cos(eff[3].a[3]);













rseff4a1=Sin(eff[4].a[1]);
rceff4a1=Cos(eff[4].a[1]);

rseff4a2=Sin(eff[4].a[2]);
rceff4a2=Cos(eff[4].a[2]);

rseff4a3=Sin(eff[4].a[3]);
rceff4a3=Cos(eff[4].a[3]);



cb_ForDynArtfunc1();

cb_ForDynArtfunc2();

cb_ForDynArtfunc3();

cb_ForDynArtfunc4();

cb_ForDynArtfunc5();

cb_ForDynArtfunc6();

cb_ForDynArtfunc7();

cb_ForDynArtfunc8();

cb_ForDynArtfunc9();

cb_ForDynArtfunc10();

cb_ForDynArtfunc11();

cb_ForDynArtfunc12();

cb_ForDynArtfunc13();

cb_ForDynArtfunc14();

cb_ForDynArtfunc15();

cb_ForDynArtfunc16();

cb_ForDynArtfunc17();

cb_ForDynArtfunc18();

cb_ForDynArtfunc19();

cb_ForDynArtfunc20();

cb_ForDynArtfunc21();

cb_ForDynArtfunc22();

cb_ForDynArtfunc23();

cb_ForDynArtfunc24();

cb_ForDynArtfunc25();

cb_ForDynArtfunc26();

cb_ForDynArtfunc27();

cb_ForDynArtfunc28();

cb_ForDynArtfunc29();

cb_ForDynArtfunc30();

cb_ForDynArtfunc31();

cb_ForDynArtfunc32();

cb_ForDynArtfunc33();

cb_ForDynArtfunc34();

cb_ForDynArtfunc35();

cb_ForDynArtfunc36();

cb_ForDynArtfunc37();

cb_ForDynArtfunc38();

cb_ForDynArtfunc39();

cb_ForDynArtfunc40();

cb_ForDynArtfunc41();

cb_ForDynArtfunc42();

cb_ForDynArtfunc43();

cb_ForDynArtfunc44();

cb_ForDynArtfunc45();

cb_ForDynArtfunc46();

cb_ForDynArtfunc47();

cb_ForDynArtfunc48();

cb_ForDynArtfunc49();

cb_ForDynArtfunc50();

cb_ForDynArtfunc51();

cb_ForDynArtfunc52();

cb_ForDynArtfunc53();

cb_ForDynArtfunc54();

cb_ForDynArtfunc55();

cb_ForDynArtfunc56();

cb_ForDynArtfunc57();

cb_ForDynArtfunc58();

cb_ForDynArtfunc59();

cb_ForDynArtfunc60();

cb_ForDynArtfunc61();

/* acceleration vectors and joint accelerations */
/* now solve for base accelerations: -xp[0] = JA[0]*add[0]  */
/* Note: xp and JA are calculated above */
MY_MATRIX(JAmat,1,6,1,6);
for (i=1; i<=6; ++i)
   for (j=1; j<=6; ++j) 
      JAmat[i][j]=JA0[i][j];
my_inv_ludcmp_solve(JAmat,p0,6,a0);

if (freeze_base) for (i=1; i<=6; ++i) a0[i]=0.0;



baseo[0].qdd[1]=(-(baseo[0].ad[1]*baseo[0].qd[2]) - baseo[0].ad[2]*baseo[0].qd[3] - baseo[0].ad[3]*baseo[0].qd[4] - baseo[0].q[2]*(-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3]) - baseo[0].q[3]*(-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3]) - baseo[0].q[4]*(-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3]))/2.;
baseo[0].qdd[2]=(baseo[0].ad[1]*baseo[0].qd[1] - baseo[0].ad[3]*baseo[0].qd[3] + baseo[0].ad[2]*baseo[0].qd[4] + baseo[0].q[1]*(-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3]) + baseo[0].q[4]*(-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3]) - baseo[0].q[3]*(-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3]))/2.;
baseo[0].qdd[3]=(baseo[0].ad[2]*baseo[0].qd[1] + baseo[0].ad[3]*baseo[0].qd[2] - baseo[0].ad[1]*baseo[0].qd[4] - baseo[0].q[4]*(-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3]) + baseo[0].q[1]*(-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3]) + baseo[0].q[2]*(-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3]))/2.;
baseo[0].qdd[4]=(baseo[0].ad[3]*baseo[0].qd[1] - baseo[0].ad[2]*baseo[0].qd[2] + baseo[0].ad[1]*baseo[0].qd[3] + baseo[0].q[3]*(-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3]) - baseo[0].q[2]*(-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3]) + baseo[0].q[1]*(-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3]))/2.;
basec[0].xdd[1]=basec[0].xd[3]*baseo[0].ad[2] - basec[0].xd[2]*baseo[0].ad[3] - a0[4]*Si00[1][1] - a0[5]*Si00[1][2] - a0[6]*Si00[1][3] + basec[0].x[3]*(-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3]) - a0[1]*(-(basec[0].x[3]*Si00[2][1]) + basec[0].x[2]*Si00[3][1]) - a0[2]*(-(basec[0].x[3]*Si00[2][2]) + basec[0].x[2]*Si00[3][2]) - basec[0].x[2]*(-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3]) - a0[3]*(-(basec[0].x[3]*Si00[2][3]) + basec[0].x[2]*Si00[3][3]);
basec[0].xdd[2]=-(basec[0].xd[3]*baseo[0].ad[1]) + basec[0].xd[1]*baseo[0].ad[3] - basec[0].x[3]*(-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3]) - a0[4]*Si00[2][1] - a0[5]*Si00[2][2] - a0[6]*Si00[2][3] - a0[1]*(basec[0].x[3]*Si00[1][1] - basec[0].x[1]*Si00[3][1]) - a0[2]*(basec[0].x[3]*Si00[1][2] - basec[0].x[1]*Si00[3][2]) + basec[0].x[1]*(-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3]) - a0[3]*(basec[0].x[3]*Si00[1][3] - basec[0].x[1]*Si00[3][3]);
basec[0].xdd[3]=basec[0].xd[2]*baseo[0].ad[1] - basec[0].xd[1]*baseo[0].ad[2] + basec[0].x[2]*(-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3]) - a0[1]*(-(basec[0].x[2]*Si00[1][1]) + basec[0].x[1]*Si00[2][1]) - a0[2]*(-(basec[0].x[2]*Si00[1][2]) + basec[0].x[1]*Si00[2][2]) - basec[0].x[1]*(-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3]) - a0[3]*(-(basec[0].x[2]*Si00[1][3]) + basec[0].x[1]*Si00[2][3]) - a0[4]*Si00[3][1] - a0[5]*Si00[3][2] - a0[6]*Si00[3][3];
baseo[0].add[1]=-(a0[1]*Si00[1][1]) - a0[2]*Si00[1][2] - a0[3]*Si00[1][3];
baseo[0].add[2]=-(a0[1]*Si00[2][1]) - a0[2]*Si00[2][2] - a0[3]*Si00[2][3];
baseo[0].add[3]=-(a0[1]*Si00[3][1]) - a0[2]*Si00[3][2] - a0[3]*Si00[3][3];

state[29].thdd=(-(a0[6]*h1[3]) + u[1] + a0[4]*(h1[1]*S10[1][1] + h1[2]*S10[2][1]) + a0[3]*(-h1[6] + PELVISOFFSET*h1[1]*S10[1][1] + PELVISOFFSET*h1[2]*S10[2][1]) + a0[5]*(h1[1]*S10[1][2] + h1[2]*S10[2][2]) + a0[1]*(PELVISOFFSET*h1[3] + h1[4]*S10[1][1] - PELVIS2THORAX*h1[1]*S10[1][2] + h1[5]*S10[2][1] - PELVIS2THORAX*h1[2]*S10[2][2]) + a0[2]*(PELVIS2THORAX*h1[1]*S10[1][1] + h1[4]*S10[1][2] + PELVIS2THORAX*h1[2]*S10[2][1] + h1[5]*S10[2][2]))/d[1];

a1[1]=c1[1] - a0[1]*S10[1][1] - a0[2]*S10[1][2];
a1[2]=c1[2] - a0[1]*S10[2][1] - a0[2]*S10[2][2];
a1[3]=state[29].thdd + a0[3];
a1[4]=c1[4] - PELVIS2THORAX*a0[2]*S10[1][1] - PELVISOFFSET*a0[3]*S10[1][1] - a0[4]*S10[1][1] + PELVIS2THORAX*a0[1]*S10[1][2] - a0[5]*S10[1][2];
a1[5]=c1[5] - PELVIS2THORAX*a0[2]*S10[2][1] - PELVISOFFSET*a0[3]*S10[2][1] - a0[4]*S10[2][1] + PELVIS2THORAX*a0[1]*S10[2][2] - a0[5]*S10[2][2];
a1[6]=-(PELVISOFFSET*a0[1]) + a0[6];

state[30].thdd=(a1[5]*h2[3] + a1[2]*h2[6] + u[2] - a1[4]*(h2[1]*S21[1][1] + h2[2]*S21[2][1]) - a1[1]*(h2[4]*S21[1][1] + h2[5]*S21[2][1]) - a1[6]*(h2[1]*S21[1][3] + h2[2]*S21[2][3]) - a1[3]*(h2[4]*S21[1][3] + h2[5]*S21[2][3]))/d[2];

a2[1]=c2[1] + a1[1]*S21[1][1] + a1[3]*S21[1][3];
a2[2]=c2[2] + a1[1]*S21[2][1] + a1[3]*S21[2][3];
a2[3]=state[30].thdd - a1[2];
a2[4]=c2[4] + a1[4]*S21[1][1] + a1[6]*S21[1][3];
a2[5]=c2[5] + a1[4]*S21[2][1] + a1[6]*S21[2][3];
a2[6]=-a1[5];

state[31].thdd=(-(a2[5]*h3[3]) - a2[2]*h3[6] + u[3] - a2[4]*(h3[1]*S32[1][1] + h3[2]*S32[2][1]) - a2[1]*(h3[4]*S32[1][1] + h3[5]*S32[2][1]) - a2[6]*(h3[1]*S32[1][3] + h3[2]*S32[2][3]) - a2[3]*(h3[4]*S32[1][3] + h3[5]*S32[2][3]))/d[3];

a3[1]=c3[1] + a2[1]*S32[1][1] + a2[3]*S32[1][3];
a3[2]=c3[2] + a2[1]*S32[2][1] + a2[3]*S32[2][3];
a3[3]=state[31].thdd + a2[2];
a3[4]=c3[4] + a2[4]*S32[1][1] + a2[6]*S32[1][3];
a3[5]=c3[5] + a2[4]*S32[2][1] + a2[6]*S32[2][3];
a3[6]=a2[5];

state[1].thdd=(u[4] - a3[4]*(0.7071067811865475*h4[3] + h4[1]*S43[1][1] + h4[2]*S43[2][1]) - a3[1]*(0.7071067811865475*h4[6] + h4[4]*S43[1][1] + h4[5]*S43[2][1]) - a3[5]*(h4[1]*S43[1][2] + h4[2]*S43[2][2]) - a3[6]*(-0.7071067811865475*h4[3] + h4[1]*S43[1][3] + h4[2]*S43[2][3]) - a3[2]*(-0.7071067811865475*THORAX2SHOULDER*h4[3] + h4[4]*S43[1][2] + THORAX2SHOULDER*h4[1]*S43[1][3] + h4[5]*S43[2][2] + THORAX2SHOULDER*h4[2]*S43[2][3]) - a3[3]*(-0.7071067811865475*h4[6] - THORAX2SHOULDER*h4[1]*S43[1][2] + h4[4]*S43[1][3] - THORAX2SHOULDER*h4[2]*S43[2][2] + h4[5]*S43[2][3]))/d[4];

a4[1]=c4[1] + a3[1]*S43[1][1] + a3[2]*S43[1][2] + a3[3]*S43[1][3];
a4[2]=c4[2] + a3[1]*S43[2][1] + a3[2]*S43[2][2] + a3[3]*S43[2][3];
a4[3]=state[1].thdd + 0.7071067811865475*a3[1] - 0.7071067811865475*a3[3];
a4[4]=c4[4] + a3[4]*S43[1][1] - THORAX2SHOULDER*a3[3]*S43[1][2] + a3[5]*S43[1][2] + THORAX2SHOULDER*a3[2]*S43[1][3] + a3[6]*S43[1][3];
a4[5]=c4[5] + a3[4]*S43[2][1] - THORAX2SHOULDER*a3[3]*S43[2][2] + a3[5]*S43[2][2] + THORAX2SHOULDER*a3[2]*S43[2][3] + a3[6]*S43[2][3];
a4[6]=-0.7071067811865475*THORAX2SHOULDER*a3[2] + 0.7071067811865475*a3[4] - 0.7071067811865475*a3[6];

state[2].thdd=(a4[5]*h5[3] + u[5] - a4[4]*(h5[1]*S54[1][1] + h5[2]*S54[2][1]) - a4[2]*(-h5[6] - SHOULDERX*h5[1]*S54[1][1] - SHOULDERX*h5[2]*S54[2][1]) - a4[1]*(-(SHOULDERX*h5[3]) + h5[4]*S54[1][1] + h5[5]*S54[2][1]) - a4[6]*(h5[1]*S54[1][3] + h5[2]*S54[2][3]) - a4[3]*(h5[4]*S54[1][3] + h5[5]*S54[2][3]))/d[5];

a5[1]=c5[1] + a4[1]*S54[1][1] + a4[3]*S54[1][3];
a5[2]=c5[2] + a4[1]*S54[2][1] + a4[3]*S54[2][3];
a5[3]=state[2].thdd - a4[2];
a5[4]=c5[4] - SHOULDERX*a4[2]*S54[1][1] + a4[4]*S54[1][1] + a4[6]*S54[1][3];
a5[5]=c5[5] - SHOULDERX*a4[2]*S54[2][1] + a4[4]*S54[2][1] + a4[6]*S54[2][3];
a5[6]=-(SHOULDERX*a4[1]) - a4[5];

state[3].thdd=(-(a5[5]*h6[3]) + u[6] - a5[4]*(h6[1]*S65[1][1] + h6[2]*S65[2][1]) - a5[1]*(h6[4]*S65[1][1] + h6[5]*S65[2][1]) - a5[6]*(h6[1]*S65[1][3] + h6[2]*S65[2][3]) - a5[2]*(h6[6] + SHOULDERY*h6[1]*S65[1][3] + SHOULDERY*h6[2]*S65[2][3]) - a5[3]*(-(SHOULDERY*h6[3]) + h6[4]*S65[1][3] + h6[5]*S65[2][3]))/d[6];

a6[1]=c6[1] + a5[1]*S65[1][1] + a5[3]*S65[1][3];
a6[2]=c6[2] + a5[1]*S65[2][1] + a5[3]*S65[2][3];
a6[3]=state[3].thdd + a5[2];
a6[4]=c6[4] + a5[4]*S65[1][1] + SHOULDERY*a5[2]*S65[1][3] + a5[6]*S65[1][3];
a6[5]=c6[5] + a5[4]*S65[2][1] + SHOULDERY*a5[2]*S65[2][3] + a5[6]*S65[2][3];
a6[6]=-(SHOULDERY*a5[3]) + a5[5];

state[4].thdd=(-(a6[4]*h7[3]) + u[7] - a6[5]*(h7[1]*S76[1][2] + h7[2]*S76[2][2]) - a6[1]*(h7[6] + UPPERARM*h7[1]*S76[1][2] + UPPERARM*h7[2]*S76[2][2]) - a6[2]*(-(UPPERARM*h7[3]) + h7[4]*S76[1][2] + h7[5]*S76[2][2]) - a6[6]*(h7[1]*S76[1][3] + h7[2]*S76[2][3]) - a6[3]*(h7[4]*S76[1][3] + h7[5]*S76[2][3]))/d[7];

a7[1]=c7[1] + a6[2]*S76[1][2] + a6[3]*S76[1][3];
a7[2]=c7[2] + a6[2]*S76[2][2] + a6[3]*S76[2][3];
a7[3]=state[4].thdd + a6[1];
a7[4]=c7[4] + UPPERARM*a6[1]*S76[1][2] + a6[5]*S76[1][2] + a6[6]*S76[1][3];
a7[5]=c7[5] + UPPERARM*a6[1]*S76[2][2] + a6[5]*S76[2][2] + a6[6]*S76[2][3];
a7[6]=-(UPPERARM*a6[2]) + a6[4];

state[5].thdd=(-(a7[5]*h8[3]) - a7[2]*h8[6] + u[8] - a7[4]*(h8[1]*S87[1][1] + h8[2]*S87[2][1]) - a7[1]*(h8[4]*S87[1][1] + h8[5]*S87[2][1]) - a7[6]*(h8[1]*S87[1][3] + h8[2]*S87[2][3]) - a7[3]*(h8[4]*S87[1][3] + h8[5]*S87[2][3]))/d[8];

a8[1]=c8[1] + a7[1]*S87[1][1] + a7[3]*S87[1][3];
a8[2]=c8[2] + a7[1]*S87[2][1] + a7[3]*S87[2][3];
a8[3]=state[5].thdd + a7[2];
a8[4]=c8[4] + a7[4]*S87[1][1] + a7[6]*S87[1][3];
a8[5]=c8[5] + a7[4]*S87[2][1] + a7[6]*S87[2][3];
a8[6]=a7[5];

state[6].thdd=(-(a8[4]*h9[3]) + u[9] - a8[5]*(h9[1]*S98[1][2] + h9[2]*S98[2][2]) - a8[2]*(-(LOWERARM*h9[3]) + h9[4]*S98[1][2] + h9[5]*S98[2][2]) - a8[6]*(h9[1]*S98[1][3] + h9[2]*S98[2][3]) - a8[3]*(-(WRISTY*h9[3]) + h9[4]*S98[1][3] + h9[5]*S98[2][3]) - a8[1]*(h9[6] + h9[1]*(LOWERARM*S98[1][2] + WRISTY*S98[1][3]) + h9[2]*(LOWERARM*S98[2][2] + WRISTY*S98[2][3])))/d[9];

a9[1]=c9[1] + a8[2]*S98[1][2] + a8[3]*S98[1][3];
a9[2]=c9[2] + a8[2]*S98[2][2] + a8[3]*S98[2][3];
a9[3]=state[6].thdd + a8[1];
a9[4]=c9[4] + a8[5]*S98[1][2] + a8[6]*S98[1][3] + a8[1]*(LOWERARM*S98[1][2] + WRISTY*S98[1][3]);
a9[5]=c9[5] + a8[5]*S98[2][2] + a8[6]*S98[2][3] + a8[1]*(LOWERARM*S98[2][2] + WRISTY*S98[2][3]);
a9[6]=-(LOWERARM*a8[2]) - WRISTY*a8[3] + a8[4];

state[7].thdd=(a9[5]*h10[3] + a9[2]*h10[6] + u[10] - a9[4]*(h10[1]*S109[1][1] + h10[2]*S109[2][1]) - a9[1]*(h10[4]*S109[1][1] + h10[5]*S109[2][1]) - a9[6]*(h10[1]*S109[1][3] + h10[2]*S109[2][3]) - a9[3]*(h10[4]*S109[1][3] + h10[5]*S109[2][3]))/d[10];

a10[1]=c10[1] + a9[1]*S109[1][1] + a9[3]*S109[1][3];
a10[2]=c10[2] + a9[1]*S109[2][1] + a9[3]*S109[2][3];
a10[3]=state[7].thdd - a9[2];
a10[4]=c10[4] + a9[4]*S109[1][1] + a9[6]*S109[1][3];
a10[5]=c10[5] + a9[4]*S109[2][1] + a9[6]*S109[2][3];
a10[6]=-a9[5];

a11[1]=a10[1]*S1110[1][1] + a10[2]*S1110[1][2] + a10[3]*S1110[1][3];
a11[2]=a10[1]*S1110[2][1] + a10[2]*S1110[2][2] + a10[3]*S1110[2][3];
a11[3]=a10[1]*S1110[3][1] + a10[2]*S1110[3][2] + a10[3]*S1110[3][3];
a11[4]=a10[4]*S1110[1][1] + a10[5]*S1110[1][2] + a10[3]*(-(eff[2].x[2]*S1110[1][1]) + eff[2].x[1]*S1110[1][2]) + a10[6]*S1110[1][3] + a10[2]*(eff[2].x[3]*S1110[1][1] - eff[2].x[1]*S1110[1][3]) + a10[1]*(-(eff[2].x[3]*S1110[1][2]) + eff[2].x[2]*S1110[1][3]);
a11[5]=a10[4]*S1110[2][1] + a10[5]*S1110[2][2] + a10[3]*(-(eff[2].x[2]*S1110[2][1]) + eff[2].x[1]*S1110[2][2]) + a10[6]*S1110[2][3] + a10[2]*(eff[2].x[3]*S1110[2][1] - eff[2].x[1]*S1110[2][3]) + a10[1]*(-(eff[2].x[3]*S1110[2][2]) + eff[2].x[2]*S1110[2][3]);
a11[6]=a10[4]*S1110[3][1] + a10[5]*S1110[3][2] + a10[3]*(-(eff[2].x[2]*S1110[3][1]) + eff[2].x[1]*S1110[3][2]) + a10[6]*S1110[3][3] + a10[2]*(eff[2].x[3]*S1110[3][1] - eff[2].x[1]*S1110[3][3]) + a10[1]*(-(eff[2].x[3]*S1110[3][2]) + eff[2].x[2]*S1110[3][3]);

state[8].thdd=(u[12] - a3[4]*(-0.7071067811865475*h12[3] + h12[1]*S123[1][1] + h12[2]*S123[2][1]) - a3[1]*(-0.7071067811865475*h12[6] + h12[4]*S123[1][1] + h12[5]*S123[2][1]) - a3[5]*(h12[1]*S123[1][2] + h12[2]*S123[2][2]) - a3[6]*(-0.7071067811865475*h12[3] + h12[1]*S123[1][3] + h12[2]*S123[2][3]) - a3[2]*(-0.7071067811865475*THORAX2SHOULDER*h12[3] + h12[4]*S123[1][2] + THORAX2SHOULDER*h12[1]*S123[1][3] + h12[5]*S123[2][2] + THORAX2SHOULDER*h12[2]*S123[2][3]) - a3[3]*(-0.7071067811865475*h12[6] - THORAX2SHOULDER*h12[1]*S123[1][2] + h12[4]*S123[1][3] - THORAX2SHOULDER*h12[2]*S123[2][2] + h12[5]*S123[2][3]))/d[12];

a12[1]=c12[1] + a3[1]*S123[1][1] + a3[2]*S123[1][2] + a3[3]*S123[1][3];
a12[2]=c12[2] + a3[1]*S123[2][1] + a3[2]*S123[2][2] + a3[3]*S123[2][3];
a12[3]=state[8].thdd - 0.7071067811865475*a3[1] - 0.7071067811865475*a3[3];
a12[4]=c12[4] + a3[4]*S123[1][1] - THORAX2SHOULDER*a3[3]*S123[1][2] + a3[5]*S123[1][2] + THORAX2SHOULDER*a3[2]*S123[1][3] + a3[6]*S123[1][3];
a12[5]=c12[5] + a3[4]*S123[2][1] - THORAX2SHOULDER*a3[3]*S123[2][2] + a3[5]*S123[2][2] + THORAX2SHOULDER*a3[2]*S123[2][3] + a3[6]*S123[2][3];
a12[6]=-0.7071067811865475*THORAX2SHOULDER*a3[2] - 0.7071067811865475*a3[4] - 0.7071067811865475*a3[6];

state[9].thdd=(-(a12[5]*h13[3]) + u[13] - a12[4]*(h13[1]*S1312[1][1] + h13[2]*S1312[2][1]) - a12[2]*(h13[6] + SHOULDERX*h13[1]*S1312[1][1] + SHOULDERX*h13[2]*S1312[2][1]) - a12[1]*(-(SHOULDERX*h13[3]) + h13[4]*S1312[1][1] + h13[5]*S1312[2][1]) - a12[6]*(h13[1]*S1312[1][3] + h13[2]*S1312[2][3]) - a12[3]*(h13[4]*S1312[1][3] + h13[5]*S1312[2][3]))/d[13];

a13[1]=c13[1] + a12[1]*S1312[1][1] + a12[3]*S1312[1][3];
a13[2]=c13[2] + a12[1]*S1312[2][1] + a12[3]*S1312[2][3];
a13[3]=state[9].thdd + a12[2];
a13[4]=c13[4] + SHOULDERX*a12[2]*S1312[1][1] + a12[4]*S1312[1][1] + a12[6]*S1312[1][3];
a13[5]=c13[5] + SHOULDERX*a12[2]*S1312[2][1] + a12[4]*S1312[2][1] + a12[6]*S1312[2][3];
a13[6]=-(SHOULDERX*a12[1]) + a12[5];

state[10].thdd=(a13[5]*h14[3] + u[14] - a13[4]*(h14[1]*S1413[1][1] + h14[2]*S1413[2][1]) - a13[1]*(h14[4]*S1413[1][1] + h14[5]*S1413[2][1]) - a13[6]*(h14[1]*S1413[1][3] + h14[2]*S1413[2][3]) - a13[2]*(-h14[6] + SHOULDERY*h14[1]*S1413[1][3] + SHOULDERY*h14[2]*S1413[2][3]) - a13[3]*(SHOULDERY*h14[3] + h14[4]*S1413[1][3] + h14[5]*S1413[2][3]))/d[14];

a14[1]=c14[1] + a13[1]*S1413[1][1] + a13[3]*S1413[1][3];
a14[2]=c14[2] + a13[1]*S1413[2][1] + a13[3]*S1413[2][3];
a14[3]=state[10].thdd - a13[2];
a14[4]=c14[4] + a13[4]*S1413[1][1] + SHOULDERY*a13[2]*S1413[1][3] + a13[6]*S1413[1][3];
a14[5]=c14[5] + a13[4]*S1413[2][1] + SHOULDERY*a13[2]*S1413[2][3] + a13[6]*S1413[2][3];
a14[6]=SHOULDERY*a13[3] - a13[5];

state[11].thdd=(a14[4]*h15[3] + u[15] - a14[5]*(h15[1]*S1514[1][2] + h15[2]*S1514[2][2]) - a14[1]*(-h15[6] - UPPERARM*h15[1]*S1514[1][2] - UPPERARM*h15[2]*S1514[2][2]) - a14[2]*(-(UPPERARM*h15[3]) + h15[4]*S1514[1][2] + h15[5]*S1514[2][2]) - a14[6]*(h15[1]*S1514[1][3] + h15[2]*S1514[2][3]) - a14[3]*(h15[4]*S1514[1][3] + h15[5]*S1514[2][3]))/d[15];

a15[1]=c15[1] + a14[2]*S1514[1][2] + a14[3]*S1514[1][3];
a15[2]=c15[2] + a14[2]*S1514[2][2] + a14[3]*S1514[2][3];
a15[3]=state[11].thdd - a14[1];
a15[4]=c15[4] - UPPERARM*a14[1]*S1514[1][2] + a14[5]*S1514[1][2] + a14[6]*S1514[1][3];
a15[5]=c15[5] - UPPERARM*a14[1]*S1514[2][2] + a14[5]*S1514[2][2] + a14[6]*S1514[2][3];
a15[6]=-(UPPERARM*a14[2]) - a14[4];

state[12].thdd=(a15[5]*h16[3] + a15[2]*h16[6] + u[16] - a15[4]*(h16[1]*S1615[1][1] + h16[2]*S1615[2][1]) - a15[1]*(h16[4]*S1615[1][1] + h16[5]*S1615[2][1]) - a15[6]*(h16[1]*S1615[1][3] + h16[2]*S1615[2][3]) - a15[3]*(h16[4]*S1615[1][3] + h16[5]*S1615[2][3]))/d[16];

a16[1]=c16[1] + a15[1]*S1615[1][1] + a15[3]*S1615[1][3];
a16[2]=c16[2] + a15[1]*S1615[2][1] + a15[3]*S1615[2][3];
a16[3]=state[12].thdd - a15[2];
a16[4]=c16[4] + a15[4]*S1615[1][1] + a15[6]*S1615[1][3];
a16[5]=c16[5] + a15[4]*S1615[2][1] + a15[6]*S1615[2][3];
a16[6]=-a15[5];

state[13].thdd=(a16[4]*h17[3] + u[17] - a16[5]*(h17[1]*S1716[1][2] + h17[2]*S1716[2][2]) - a16[2]*(-(LOWERARM*h17[3]) + h17[4]*S1716[1][2] + h17[5]*S1716[2][2]) - a16[6]*(h17[1]*S1716[1][3] + h17[2]*S1716[2][3]) - a16[3]*(WRISTY*h17[3] + h17[4]*S1716[1][3] + h17[5]*S1716[2][3]) - a16[1]*(-h17[6] + h17[1]*(-(LOWERARM*S1716[1][2]) + WRISTY*S1716[1][3]) + h17[2]*(-(LOWERARM*S1716[2][2]) + WRISTY*S1716[2][3])))/d[17];

a17[1]=c17[1] + a16[2]*S1716[1][2] + a16[3]*S1716[1][3];
a17[2]=c17[2] + a16[2]*S1716[2][2] + a16[3]*S1716[2][3];
a17[3]=state[13].thdd - a16[1];
a17[4]=c17[4] + a16[5]*S1716[1][2] + a16[6]*S1716[1][3] + a16[1]*(-(LOWERARM*S1716[1][2]) + WRISTY*S1716[1][3]);
a17[5]=c17[5] + a16[5]*S1716[2][2] + a16[6]*S1716[2][3] + a16[1]*(-(LOWERARM*S1716[2][2]) + WRISTY*S1716[2][3]);
a17[6]=-(LOWERARM*a16[2]) + WRISTY*a16[3] - a16[4];

state[14].thdd=(-(a17[5]*h18[3]) - a17[2]*h18[6] + u[18] - a17[4]*(h18[1]*S1817[1][1] + h18[2]*S1817[2][1]) - a17[1]*(h18[4]*S1817[1][1] + h18[5]*S1817[2][1]) - a17[6]*(h18[1]*S1817[1][3] + h18[2]*S1817[2][3]) - a17[3]*(h18[4]*S1817[1][3] + h18[5]*S1817[2][3]))/d[18];

a18[1]=c18[1] + a17[1]*S1817[1][1] + a17[3]*S1817[1][3];
a18[2]=c18[2] + a17[1]*S1817[2][1] + a17[3]*S1817[2][3];
a18[3]=state[14].thdd + a17[2];
a18[4]=c18[4] + a17[4]*S1817[1][1] + a17[6]*S1817[1][3];
a18[5]=c18[5] + a17[4]*S1817[2][1] + a17[6]*S1817[2][3];
a18[6]=a17[5];

a19[1]=a18[1]*S1918[1][1] + a18[2]*S1918[1][2] + a18[3]*S1918[1][3];
a19[2]=a18[1]*S1918[2][1] + a18[2]*S1918[2][2] + a18[3]*S1918[2][3];
a19[3]=a18[1]*S1918[3][1] + a18[2]*S1918[3][2] + a18[3]*S1918[3][3];
a19[4]=a18[4]*S1918[1][1] + a18[5]*S1918[1][2] + a18[3]*(-(eff[1].x[2]*S1918[1][1]) + eff[1].x[1]*S1918[1][2]) + a18[6]*S1918[1][3] + a18[2]*(eff[1].x[3]*S1918[1][1] - eff[1].x[1]*S1918[1][3]) + a18[1]*(-(eff[1].x[3]*S1918[1][2]) + eff[1].x[2]*S1918[1][3]);
a19[5]=a18[4]*S1918[2][1] + a18[5]*S1918[2][2] + a18[3]*(-(eff[1].x[2]*S1918[2][1]) + eff[1].x[1]*S1918[2][2]) + a18[6]*S1918[2][3] + a18[2]*(eff[1].x[3]*S1918[2][1] - eff[1].x[1]*S1918[2][3]) + a18[1]*(-(eff[1].x[3]*S1918[2][2]) + eff[1].x[2]*S1918[2][3]);
a19[6]=a18[4]*S1918[3][1] + a18[5]*S1918[3][2] + a18[3]*(-(eff[1].x[2]*S1918[3][1]) + eff[1].x[1]*S1918[3][2]) + a18[6]*S1918[3][3] + a18[2]*(eff[1].x[3]*S1918[3][1] - eff[1].x[1]*S1918[3][3]) + a18[1]*(-(eff[1].x[3]*S1918[3][2]) + eff[1].x[2]*S1918[3][3]);

state[32].thdd=(-(a3[6]*h20[3]) + u[20] - a3[4]*(h20[1]*S203[1][1] + h20[2]*S203[2][1]) - a3[1]*(h20[4]*S203[1][1] + h20[5]*S203[2][1]) - a3[5]*(h20[1]*S203[1][2] + h20[2]*S203[2][2]) - a3[3]*(h20[6] - THORAX2NECK*h20[1]*S203[1][2] - THORAX2NECK*h20[2]*S203[2][2]) - a3[2]*(THORAX2NECK*h20[3] + h20[4]*S203[1][2] + h20[5]*S203[2][2]))/d[20];

a20[1]=c20[1] + a3[1]*S203[1][1] + a3[2]*S203[1][2];
a20[2]=c20[2] + a3[1]*S203[2][1] + a3[2]*S203[2][2];
a20[3]=state[32].thdd + a3[3];
a20[4]=c20[4] + a3[4]*S203[1][1] - THORAX2NECK*a3[3]*S203[1][2] + a3[5]*S203[1][2];
a20[5]=c20[5] + a3[4]*S203[2][1] - THORAX2NECK*a3[3]*S203[2][2] + a3[5]*S203[2][2];
a20[6]=THORAX2NECK*a3[2] + a3[6];

state[33].thdd=(-(a20[4]*h21[3]) + u[21] - a20[5]*(h21[1]*S2120[1][2] + h21[2]*S2120[2][2]) - a20[2]*(h21[4]*S2120[1][2] + h21[5]*S2120[2][2]) - a20[6]*(h21[1]*S2120[1][3] + h21[2]*S2120[2][3]) - a20[1]*(h21[6] - CERVICAL*h21[1]*S2120[1][3] - CERVICAL*h21[2]*S2120[2][3]) - a20[3]*(CERVICAL*h21[3] + h21[4]*S2120[1][3] + h21[5]*S2120[2][3]))/d[21];

a21[1]=c21[1] + a20[2]*S2120[1][2] + a20[3]*S2120[1][3];
a21[2]=c21[2] + a20[2]*S2120[2][2] + a20[3]*S2120[2][3];
a21[3]=state[33].thdd + a20[1];
a21[4]=c21[4] + a20[5]*S2120[1][2] - CERVICAL*a20[1]*S2120[1][3] + a20[6]*S2120[1][3];
a21[5]=c21[5] + a20[5]*S2120[2][2] - CERVICAL*a20[1]*S2120[2][3] + a20[6]*S2120[2][3];
a21[6]=CERVICAL*a20[3] + a20[4];

state[34].thdd=(-(a21[5]*h22[3]) - a21[2]*h22[6] + u[22] - a21[4]*(h22[1]*S2221[1][1] + h22[2]*S2221[2][1]) - a21[1]*(h22[4]*S2221[1][1] + h22[5]*S2221[2][1]) - a21[6]*(h22[1]*S2221[1][3] + h22[2]*S2221[2][3]) - a21[3]*(h22[4]*S2221[1][3] + h22[5]*S2221[2][3]))/d[22];

a22[1]=c22[1] + a21[1]*S2221[1][1] + a21[3]*S2221[1][3];
a22[2]=c22[2] + a21[1]*S2221[2][1] + a21[3]*S2221[2][3];
a22[3]=state[34].thdd + a21[2];
a22[4]=c22[4] + a21[4]*S2221[1][1] + a21[6]*S2221[1][3];
a22[5]=c22[5] + a21[4]*S2221[2][1] + a21[6]*S2221[2][3];
a22[6]=a21[5];

state[35].thdd=(-(a22[6]*h23[3]) + u[23] - a22[4]*(h23[1]*S2322[1][1] + h23[2]*S2322[2][1]) - a22[5]*(h23[1]*S2322[1][2] + h23[2]*S2322[2][2]) - a22[1]*(-(EYEYOFF*h23[3]) + h23[4]*S2322[1][1] + HEAD*h23[1]*S2322[1][2] + h23[5]*S2322[2][1] + HEAD*h23[2]*S2322[2][2]) - a22[2]*(-(EYEXOFF*h23[3]) - HEAD*h23[1]*S2322[1][1] + h23[4]*S2322[1][2] - HEAD*h23[2]*S2322[2][1] + h23[5]*S2322[2][2]) - a22[3]*(h23[6] + h23[1]*(EYEYOFF*S2322[1][1] + EYEXOFF*S2322[1][2]) + h23[2]*(EYEYOFF*S2322[2][1] + EYEXOFF*S2322[2][2])))/d[23];

a23[1]=c23[1] + a22[1]*S2322[1][1] + a22[2]*S2322[1][2];
a23[2]=c23[2] + a22[1]*S2322[2][1] + a22[2]*S2322[2][2];
a23[3]=state[35].thdd + a22[3];
a23[4]=c23[4] - HEAD*a22[2]*S2322[1][1] + a22[4]*S2322[1][1] + HEAD*a22[1]*S2322[1][2] + a22[5]*S2322[1][2] + a22[3]*(EYEYOFF*S2322[1][1] + EYEXOFF*S2322[1][2]);
a23[5]=c23[5] - HEAD*a22[2]*S2322[2][1] + a22[4]*S2322[2][1] + HEAD*a22[1]*S2322[2][2] + a22[5]*S2322[2][2] + a22[3]*(EYEYOFF*S2322[2][1] + EYEXOFF*S2322[2][2]);
a23[6]=-(EYEYOFF*a22[1]) - EYEXOFF*a22[2] + a22[6];

state[36].thdd=(a23[1]*h24[6] + u[24] - a23[5]*(h24[1]*S2423[1][2] + h24[2]*S2423[2][2]) - a23[2]*(h24[4]*S2423[1][2] + h24[5]*S2423[2][2]) - a23[6]*(h24[1]*S2423[1][3] + h24[2]*S2423[2][3]) - a23[3]*(h24[4]*S2423[1][3] + h24[5]*S2423[2][3]))/d[24];

a24[1]=c24[1] + a23[2]*S2423[1][2] + a23[3]*S2423[1][3];
a24[2]=c24[2] + a23[2]*S2423[2][2] + a23[3]*S2423[2][3];
a24[3]=state[36].thdd - a23[1];
a24[4]=c24[4] + a23[5]*S2423[1][2] + a23[6]*S2423[1][3];
a24[5]=c24[5] + a23[5]*S2423[2][2] + a23[6]*S2423[2][3];
a24[6]=-a23[4];

a25[1]=-a24[3];
a25[2]=-a24[2];
a25[3]=-a24[1];
a25[4]=EYE*a24[1] - a24[6];
a25[5]=-a24[5];
a25[6]=-(EYE*a24[3]) - a24[4];

state[37].thdd=(-(a22[6]*h26[3]) + u[26] - a22[4]*(h26[1]*S2622[1][1] + h26[2]*S2622[2][1]) - a22[5]*(h26[1]*S2622[1][2] + h26[2]*S2622[2][2]) - a22[1]*(-(EYEYOFF*h26[3]) + h26[4]*S2622[1][1] + HEAD*h26[1]*S2622[1][2] + h26[5]*S2622[2][1] + HEAD*h26[2]*S2622[2][2]) - a22[2]*(EYEXOFF*h26[3] - HEAD*h26[1]*S2622[1][1] + h26[4]*S2622[1][2] - HEAD*h26[2]*S2622[2][1] + h26[5]*S2622[2][2]) - a22[3]*(h26[6] + h26[1]*(EYEYOFF*S2622[1][1] - EYEXOFF*S2622[1][2]) + h26[2]*(EYEYOFF*S2622[2][1] - EYEXOFF*S2622[2][2])))/d[26];

a26[1]=c26[1] + a22[1]*S2622[1][1] + a22[2]*S2622[1][2];
a26[2]=c26[2] + a22[1]*S2622[2][1] + a22[2]*S2622[2][2];
a26[3]=state[37].thdd + a22[3];
a26[4]=c26[4] - HEAD*a22[2]*S2622[1][1] + a22[4]*S2622[1][1] + HEAD*a22[1]*S2622[1][2] + a22[5]*S2622[1][2] + a22[3]*(EYEYOFF*S2622[1][1] - EYEXOFF*S2622[1][2]);
a26[5]=c26[5] - HEAD*a22[2]*S2622[2][1] + a22[4]*S2622[2][1] + HEAD*a22[1]*S2622[2][2] + a22[5]*S2622[2][2] + a22[3]*(EYEYOFF*S2622[2][1] - EYEXOFF*S2622[2][2]);
a26[6]=-(EYEYOFF*a22[1]) + EYEXOFF*a22[2] + a22[6];

state[38].thdd=(a26[1]*h27[6] + u[27] - a26[5]*(h27[1]*S2726[1][2] + h27[2]*S2726[2][2]) - a26[2]*(h27[4]*S2726[1][2] + h27[5]*S2726[2][2]) - a26[6]*(h27[1]*S2726[1][3] + h27[2]*S2726[2][3]) - a26[3]*(h27[4]*S2726[1][3] + h27[5]*S2726[2][3]))/d[27];

a27[1]=c27[1] + a26[2]*S2726[1][2] + a26[3]*S2726[1][3];
a27[2]=c27[2] + a26[2]*S2726[2][2] + a26[3]*S2726[2][3];
a27[3]=state[38].thdd - a26[1];
a27[4]=c27[4] + a26[5]*S2726[1][2] + a26[6]*S2726[1][3];
a27[5]=c27[5] + a26[5]*S2726[2][2] + a26[6]*S2726[2][3];
a27[6]=-a26[4];

a28[1]=-a27[3];
a28[2]=-a27[2];
a28[3]=-a27[1];
a28[4]=EYE*a27[1] - a27[6];
a28[5]=-a27[5];
a28[6]=-(EYE*a27[3]) - a27[4];

a29[1]=a22[1];
a29[2]=-a22[2];
a29[3]=-a22[3];
a29[4]=-(TOPofHEAD*a22[2]) + a22[4];
a29[5]=-(TOPofHEAD*a22[1]) - a22[5];
a29[6]=-a22[6];

state[23].thdd=(a0[5]*h30[3] + u[30] + a0[4]*(h30[1]*S300[1][1] + h30[2]*S300[2][1]) + a0[1]*(h30[4]*S300[1][1] + h30[5]*S300[2][1]) + a0[6]*(h30[1]*S300[1][3] + h30[2]*S300[2][3]) + a0[2]*(h30[6] - XHIP*h30[1]*S300[1][3] - XHIP*h30[2]*S300[2][3]) + a0[3]*(XHIP*h30[3] + h30[4]*S300[1][3] + h30[5]*S300[2][3]))/d[30];

a30[1]=c30[1] - a0[1]*S300[1][1] - a0[3]*S300[1][3];
a30[2]=c30[2] - a0[1]*S300[2][1] - a0[3]*S300[2][3];
a30[3]=state[23].thdd - a0[2];
a30[4]=c30[4] - a0[4]*S300[1][1] + XHIP*a0[2]*S300[1][3] - a0[6]*S300[1][3];
a30[5]=c30[5] - a0[4]*S300[2][1] + XHIP*a0[2]*S300[2][3] - a0[6]*S300[2][3];
a30[6]=-(XHIP*a0[3]) - a0[5];

state[22].thdd=(a30[5]*h31[3] + a30[2]*h31[6] + u[31] - a30[4]*(h31[1]*S3130[1][1] + h31[2]*S3130[2][1]) - a30[1]*(h31[4]*S3130[1][1] + h31[5]*S3130[2][1]) - a30[6]*(h31[1]*S3130[1][3] + h31[2]*S3130[2][3]) - a30[3]*(h31[4]*S3130[1][3] + h31[5]*S3130[2][3]))/d[31];

a31[1]=c31[1] + a30[1]*S3130[1][1] + a30[3]*S3130[1][3];
a31[2]=c31[2] + a30[1]*S3130[2][1] + a30[3]*S3130[2][3];
a31[3]=state[22].thdd - a30[2];
a31[4]=c31[4] + a30[4]*S3130[1][1] + a30[6]*S3130[1][3];
a31[5]=c31[5] + a30[4]*S3130[2][1] + a30[6]*S3130[2][3];
a31[6]=-a30[5];

state[24].thdd=(-(a31[5]*h32[3]) + u[32] - a31[4]*(h32[1]*S3231[1][1] + h32[2]*S3231[2][1]) - a31[1]*(h32[4]*S3231[1][1] + h32[5]*S3231[2][1]) - a31[6]*(h32[1]*S3231[1][3] + h32[2]*S3231[2][3]) - a31[2]*(h32[6] - YHIP*h32[1]*S3231[1][3] - YHIP*h32[2]*S3231[2][3]) - a31[3]*(YHIP*h32[3] + h32[4]*S3231[1][3] + h32[5]*S3231[2][3]))/d[32];

a32[1]=c32[1] + a31[1]*S3231[1][1] + a31[3]*S3231[1][3];
a32[2]=c32[2] + a31[1]*S3231[2][1] + a31[3]*S3231[2][3];
a32[3]=state[24].thdd + a31[2];
a32[4]=c32[4] + a31[4]*S3231[1][1] - YHIP*a31[2]*S3231[1][3] + a31[6]*S3231[1][3];
a32[5]=c32[5] + a31[4]*S3231[2][1] - YHIP*a31[2]*S3231[2][3] + a31[6]*S3231[2][3];
a32[6]=YHIP*a31[3] + a31[5];

state[25].thdd=(-(a32[5]*h33[3]) + u[33] - a32[4]*(h33[1]*S3332[1][1] + h33[2]*S3332[2][1]) - a32[1]*(-(UPPERLEG*h33[3]) + h33[4]*S3332[1][1] + h33[5]*S3332[2][1]) - a32[6]*(h33[1]*S3332[1][3] + h33[2]*S3332[2][3]) - a32[3]*(YKNEE*h33[3] + h33[4]*S3332[1][3] + h33[5]*S3332[2][3]) - a32[2]*(h33[6] + h33[1]*(UPPERLEG*S3332[1][1] - YKNEE*S3332[1][3]) + h33[2]*(UPPERLEG*S3332[2][1] - YKNEE*S3332[2][3])))/d[33];

a33[1]=c33[1] + a32[1]*S3332[1][1] + a32[3]*S3332[1][3];
a33[2]=c33[2] + a32[1]*S3332[2][1] + a32[3]*S3332[2][3];
a33[3]=state[25].thdd + a32[2];
a33[4]=c33[4] + a32[4]*S3332[1][1] + a32[6]*S3332[1][3] + a32[2]*(UPPERLEG*S3332[1][1] - YKNEE*S3332[1][3]);
a33[5]=c33[5] + a32[4]*S3332[2][1] + a32[6]*S3332[2][3] + a32[2]*(UPPERLEG*S3332[2][1] - YKNEE*S3332[2][3]);
a33[6]=-(UPPERLEG*a32[1]) + YKNEE*a32[3] + a32[5];

state[26].thdd=(a33[5]*h34[3] + a33[2]*h34[6] + u[34] - a33[4]*(h34[1]*S3433[1][1] + h34[2]*S3433[2][1]) - a33[1]*(h34[4]*S3433[1][1] + h34[5]*S3433[2][1]) - a33[6]*(h34[1]*S3433[1][3] + h34[2]*S3433[2][3]) - a33[3]*(h34[4]*S3433[1][3] + h34[5]*S3433[2][3]))/d[34];

a34[1]=c34[1] + a33[1]*S3433[1][1] + a33[3]*S3433[1][3];
a34[2]=c34[2] + a33[1]*S3433[2][1] + a33[3]*S3433[2][3];
a34[3]=state[26].thdd - a33[2];
a34[4]=c34[4] + a33[4]*S3433[1][1] + a33[6]*S3433[1][3];
a34[5]=c34[5] + a33[4]*S3433[2][1] + a33[6]*S3433[2][3];
a34[6]=-a33[5];

state[27].thdd=(a34[5]*h35[3] + u[35] - a34[4]*(h35[1]*S3534[1][1] + h35[2]*S3534[2][1]) - a34[2]*(-h35[6] + LOWERLEG*h35[1]*S3534[1][1] + LOWERLEG*h35[2]*S3534[2][1]) - a34[1]*(LOWERLEG*h35[3] + h35[4]*S3534[1][1] + h35[5]*S3534[2][1]) - a34[6]*(h35[1]*S3534[1][3] + h35[2]*S3534[2][3]) - a34[3]*(h35[4]*S3534[1][3] + h35[5]*S3534[2][3]))/d[35];

a35[1]=c35[1] + a34[1]*S3534[1][1] + a34[3]*S3534[1][3];
a35[2]=c35[2] + a34[1]*S3534[2][1] + a34[3]*S3534[2][3];
a35[3]=state[27].thdd - a34[2];
a35[4]=c35[4] + LOWERLEG*a34[2]*S3534[1][1] + a34[4]*S3534[1][1] + a34[6]*S3534[1][3];
a35[5]=c35[5] + LOWERLEG*a34[2]*S3534[2][1] + a34[4]*S3534[2][1] + a34[6]*S3534[2][3];
a35[6]=LOWERLEG*a34[1] - a34[5];

state[28].thdd=(-(a35[5]*h36[3]) - a35[2]*h36[6] + u[36] - a35[4]*(h36[1]*S3635[1][1] + h36[2]*S3635[2][1]) - a35[1]*(h36[4]*S3635[1][1] + h36[5]*S3635[2][1]) - a35[6]*(h36[1]*S3635[1][3] + h36[2]*S3635[2][3]) - a35[3]*(h36[4]*S3635[1][3] + h36[5]*S3635[2][3]))/d[36];

a36[1]=c36[1] + a35[1]*S3635[1][1] + a35[3]*S3635[1][3];
a36[2]=c36[2] + a35[1]*S3635[2][1] + a35[3]*S3635[2][3];
a36[3]=state[28].thdd + a35[2];
a36[4]=c36[4] + a35[4]*S3635[1][1] + a35[6]*S3635[1][3];
a36[5]=c36[5] + a35[4]*S3635[2][1] + a35[6]*S3635[2][3];
a36[6]=a35[5];

a37[1]=a36[1];
a37[2]=a36[2];
a37[3]=a36[3];
a37[4]=YTOE*a36[2] + XTOE*a36[3] + a36[4];
a37[5]=-(YTOE*a36[1]) + ZTOE*a36[3] + a36[5];
a37[6]=-(XTOE*a36[1]) - ZTOE*a36[2] + a36[6];

a38[1]=a36[1];
a38[2]=a36[2];
a38[3]=a36[3];
a38[4]=YTOE*a36[2] - XTOE*a36[3] + a36[4];
a38[5]=-(YTOE*a36[1]) + ZTOE*a36[3] + a36[5];
a38[6]=XTOE*a36[1] - ZTOE*a36[2] + a36[6];

a39[1]=a36[1];
a39[2]=a36[2];
a39[3]=a36[3];
a39[4]=-(YHEEL*a36[2]) + XHEEL*a36[3] + a36[4];
a39[5]=YHEEL*a36[1] + ZHEEL*a36[3] + a36[5];
a39[6]=-(XHEEL*a36[1]) - ZHEEL*a36[2] + a36[6];

a40[1]=a36[1];
a40[2]=a36[2];
a40[3]=a36[3];
a40[4]=-(YHEEL*a36[2]) - XHEEL*a36[3] + a36[4];
a40[5]=YHEEL*a36[1] + ZHEEL*a36[3] + a36[5];
a40[6]=XHEEL*a36[1] - ZHEEL*a36[2] + a36[6];

a41[1]=a36[1]*S4136[1][1] + a36[2]*S4136[1][2] + a36[3]*S4136[1][3];
a41[2]=a36[1]*S4136[2][1] + a36[2]*S4136[2][2] + a36[3]*S4136[2][3];
a41[3]=a36[1]*S4136[3][1] + a36[2]*S4136[3][2] + a36[3]*S4136[3][3];
a41[4]=a36[4]*S4136[1][1] + a36[5]*S4136[1][2] + a36[3]*(-(eff[3].x[2]*S4136[1][1]) + eff[3].x[1]*S4136[1][2]) + a36[6]*S4136[1][3] + a36[2]*(eff[3].x[3]*S4136[1][1] - eff[3].x[1]*S4136[1][3]) + a36[1]*(-(eff[3].x[3]*S4136[1][2]) + eff[3].x[2]*S4136[1][3]);
a41[5]=a36[4]*S4136[2][1] + a36[5]*S4136[2][2] + a36[3]*(-(eff[3].x[2]*S4136[2][1]) + eff[3].x[1]*S4136[2][2]) + a36[6]*S4136[2][3] + a36[2]*(eff[3].x[3]*S4136[2][1] - eff[3].x[1]*S4136[2][3]) + a36[1]*(-(eff[3].x[3]*S4136[2][2]) + eff[3].x[2]*S4136[2][3]);
a41[6]=a36[4]*S4136[3][1] + a36[5]*S4136[3][2] + a36[3]*(-(eff[3].x[2]*S4136[3][1]) + eff[3].x[1]*S4136[3][2]) + a36[6]*S4136[3][3] + a36[2]*(eff[3].x[3]*S4136[3][1] - eff[3].x[1]*S4136[3][3]) + a36[1]*(-(eff[3].x[3]*S4136[3][2]) + eff[3].x[2]*S4136[3][3]);

state[16].thdd=(-(a0[5]*h42[3]) + u[42] + a0[4]*(h42[1]*S420[1][1] + h42[2]*S420[2][1]) + a0[1]*(h42[4]*S420[1][1] + h42[5]*S420[2][1]) + a0[6]*(h42[1]*S420[1][3] + h42[2]*S420[2][3]) + a0[2]*(-h42[6] + XHIP*h42[1]*S420[1][3] + XHIP*h42[2]*S420[2][3]) + a0[3]*(XHIP*h42[3] + h42[4]*S420[1][3] + h42[5]*S420[2][3]))/d[42];

a42[1]=c42[1] - a0[1]*S420[1][1] - a0[3]*S420[1][3];
a42[2]=c42[2] - a0[1]*S420[2][1] - a0[3]*S420[2][3];
a42[3]=state[16].thdd + a0[2];
a42[4]=c42[4] - a0[4]*S420[1][1] - XHIP*a0[2]*S420[1][3] - a0[6]*S420[1][3];
a42[5]=c42[5] - a0[4]*S420[2][1] - XHIP*a0[2]*S420[2][3] - a0[6]*S420[2][3];
a42[6]=-(XHIP*a0[3]) + a0[5];

state[15].thdd=(-(a42[5]*h43[3]) - a42[2]*h43[6] + u[43] - a42[4]*(h43[1]*S4342[1][1] + h43[2]*S4342[2][1]) - a42[1]*(h43[4]*S4342[1][1] + h43[5]*S4342[2][1]) - a42[6]*(h43[1]*S4342[1][3] + h43[2]*S4342[2][3]) - a42[3]*(h43[4]*S4342[1][3] + h43[5]*S4342[2][3]))/d[43];

a43[1]=c43[1] + a42[1]*S4342[1][1] + a42[3]*S4342[1][3];
a43[2]=c43[2] + a42[1]*S4342[2][1] + a42[3]*S4342[2][3];
a43[3]=state[15].thdd + a42[2];
a43[4]=c43[4] + a42[4]*S4342[1][1] + a42[6]*S4342[1][3];
a43[5]=c43[5] + a42[4]*S4342[2][1] + a42[6]*S4342[2][3];
a43[6]=a42[5];

state[17].thdd=(a43[5]*h44[3] + u[44] - a43[4]*(h44[1]*S4443[1][1] + h44[2]*S4443[2][1]) - a43[1]*(h44[4]*S4443[1][1] + h44[5]*S4443[2][1]) - a43[6]*(h44[1]*S4443[1][3] + h44[2]*S4443[2][3]) - a43[2]*(-h44[6] - YHIP*h44[1]*S4443[1][3] - YHIP*h44[2]*S4443[2][3]) - a43[3]*(-(YHIP*h44[3]) + h44[4]*S4443[1][3] + h44[5]*S4443[2][3]))/d[44];

a44[1]=c44[1] + a43[1]*S4443[1][1] + a43[3]*S4443[1][3];
a44[2]=c44[2] + a43[1]*S4443[2][1] + a43[3]*S4443[2][3];
a44[3]=state[17].thdd - a43[2];
a44[4]=c44[4] + a43[4]*S4443[1][1] - YHIP*a43[2]*S4443[1][3] + a43[6]*S4443[1][3];
a44[5]=c44[5] + a43[4]*S4443[2][1] - YHIP*a43[2]*S4443[2][3] + a43[6]*S4443[2][3];
a44[6]=-(YHIP*a43[3]) - a43[5];

state[18].thdd=(a44[5]*h45[3] + u[45] - a44[4]*(h45[1]*S4544[1][1] + h45[2]*S4544[2][1]) - a44[1]*(-(UPPERLEG*h45[3]) + h45[4]*S4544[1][1] + h45[5]*S4544[2][1]) - a44[6]*(h45[1]*S4544[1][3] + h45[2]*S4544[2][3]) - a44[3]*(-(YKNEE*h45[3]) + h45[4]*S4544[1][3] + h45[5]*S4544[2][3]) - a44[2]*(-h45[6] + h45[1]*(-(UPPERLEG*S4544[1][1]) - YKNEE*S4544[1][3]) + h45[2]*(-(UPPERLEG*S4544[2][1]) - YKNEE*S4544[2][3])))/d[45];

a45[1]=c45[1] + a44[1]*S4544[1][1] + a44[3]*S4544[1][3];
a45[2]=c45[2] + a44[1]*S4544[2][1] + a44[3]*S4544[2][3];
a45[3]=state[18].thdd - a44[2];
a45[4]=c45[4] + a44[4]*S4544[1][1] + a44[6]*S4544[1][3] + a44[2]*(-(UPPERLEG*S4544[1][1]) - YKNEE*S4544[1][3]);
a45[5]=c45[5] + a44[4]*S4544[2][1] + a44[6]*S4544[2][3] + a44[2]*(-(UPPERLEG*S4544[2][1]) - YKNEE*S4544[2][3]);
a45[6]=-(UPPERLEG*a44[1]) - YKNEE*a44[3] - a44[5];

state[19].thdd=(-(a45[5]*h46[3]) - a45[2]*h46[6] + u[46] - a45[4]*(h46[1]*S4645[1][1] + h46[2]*S4645[2][1]) - a45[1]*(h46[4]*S4645[1][1] + h46[5]*S4645[2][1]) - a45[6]*(h46[1]*S4645[1][3] + h46[2]*S4645[2][3]) - a45[3]*(h46[4]*S4645[1][3] + h46[5]*S4645[2][3]))/d[46];

a46[1]=c46[1] + a45[1]*S4645[1][1] + a45[3]*S4645[1][3];
a46[2]=c46[2] + a45[1]*S4645[2][1] + a45[3]*S4645[2][3];
a46[3]=state[19].thdd + a45[2];
a46[4]=c46[4] + a45[4]*S4645[1][1] + a45[6]*S4645[1][3];
a46[5]=c46[5] + a45[4]*S4645[2][1] + a45[6]*S4645[2][3];
a46[6]=a45[5];

state[20].thdd=(-(a46[5]*h47[3]) + u[47] - a46[4]*(h47[1]*S4746[1][1] + h47[2]*S4746[2][1]) - a46[2]*(h47[6] - LOWERLEG*h47[1]*S4746[1][1] - LOWERLEG*h47[2]*S4746[2][1]) - a46[1]*(LOWERLEG*h47[3] + h47[4]*S4746[1][1] + h47[5]*S4746[2][1]) - a46[6]*(h47[1]*S4746[1][3] + h47[2]*S4746[2][3]) - a46[3]*(h47[4]*S4746[1][3] + h47[5]*S4746[2][3]))/d[47];

a47[1]=c47[1] + a46[1]*S4746[1][1] + a46[3]*S4746[1][3];
a47[2]=c47[2] + a46[1]*S4746[2][1] + a46[3]*S4746[2][3];
a47[3]=state[20].thdd + a46[2];
a47[4]=c47[4] - LOWERLEG*a46[2]*S4746[1][1] + a46[4]*S4746[1][1] + a46[6]*S4746[1][3];
a47[5]=c47[5] - LOWERLEG*a46[2]*S4746[2][1] + a46[4]*S4746[2][1] + a46[6]*S4746[2][3];
a47[6]=LOWERLEG*a46[1] + a46[5];

state[21].thdd=(a47[5]*h48[3] + a47[2]*h48[6] + u[48] - a47[4]*(h48[1]*S4847[1][1] + h48[2]*S4847[2][1]) - a47[1]*(h48[4]*S4847[1][1] + h48[5]*S4847[2][1]) - a47[6]*(h48[1]*S4847[1][3] + h48[2]*S4847[2][3]) - a47[3]*(h48[4]*S4847[1][3] + h48[5]*S4847[2][3]))/d[48];

a48[1]=c48[1] + a47[1]*S4847[1][1] + a47[3]*S4847[1][3];
a48[2]=c48[2] + a47[1]*S4847[2][1] + a47[3]*S4847[2][3];
a48[3]=state[21].thdd - a47[2];
a48[4]=c48[4] + a47[4]*S4847[1][1] + a47[6]*S4847[1][3];
a48[5]=c48[5] + a47[4]*S4847[2][1] + a47[6]*S4847[2][3];
a48[6]=-a47[5];

a49[1]=a48[1];
a49[2]=a48[2];
a49[3]=a48[3];
a49[4]=-(YTOE*a48[2]) - XTOE*a48[3] + a48[4];
a49[5]=YTOE*a48[1] + ZTOE*a48[3] + a48[5];
a49[6]=XTOE*a48[1] - ZTOE*a48[2] + a48[6];

a50[1]=a48[1];
a50[2]=a48[2];
a50[3]=a48[3];
a50[4]=-(YTOE*a48[2]) + XTOE*a48[3] + a48[4];
a50[5]=YTOE*a48[1] + ZTOE*a48[3] + a48[5];
a50[6]=-(XTOE*a48[1]) - ZTOE*a48[2] + a48[6];

a51[1]=a48[1];
a51[2]=a48[2];
a51[3]=a48[3];
a51[4]=YHEEL*a48[2] - XHEEL*a48[3] + a48[4];
a51[5]=-(YHEEL*a48[1]) + ZHEEL*a48[3] + a48[5];
a51[6]=XHEEL*a48[1] - ZHEEL*a48[2] + a48[6];

a52[1]=a48[1];
a52[2]=a48[2];
a52[3]=a48[3];
a52[4]=YHEEL*a48[2] + XHEEL*a48[3] + a48[4];
a52[5]=-(YHEEL*a48[1]) + ZHEEL*a48[3] + a48[5];
a52[6]=-(XHEEL*a48[1]) - ZHEEL*a48[2] + a48[6];

a53[1]=a48[1]*S5348[1][1] + a48[2]*S5348[1][2] + a48[3]*S5348[1][3];
a53[2]=a48[1]*S5348[2][1] + a48[2]*S5348[2][2] + a48[3]*S5348[2][3];
a53[3]=a48[1]*S5348[3][1] + a48[2]*S5348[3][2] + a48[3]*S5348[3][3];
a53[4]=a48[4]*S5348[1][1] + a48[5]*S5348[1][2] + a48[3]*(-(eff[4].x[2]*S5348[1][1]) + eff[4].x[1]*S5348[1][2]) + a48[6]*S5348[1][3] + a48[2]*(eff[4].x[3]*S5348[1][1] - eff[4].x[1]*S5348[1][3]) + a48[1]*(-(eff[4].x[3]*S5348[1][2]) + eff[4].x[2]*S5348[1][3]);
a53[5]=a48[4]*S5348[2][1] + a48[5]*S5348[2][2] + a48[3]*(-(eff[4].x[2]*S5348[2][1]) + eff[4].x[1]*S5348[2][2]) + a48[6]*S5348[2][3] + a48[2]*(eff[4].x[3]*S5348[2][1] - eff[4].x[1]*S5348[2][3]) + a48[1]*(-(eff[4].x[3]*S5348[2][2]) + eff[4].x[2]*S5348[2][3]);
a53[6]=a48[4]*S5348[3][1] + a48[5]*S5348[3][2] + a48[3]*(-(eff[4].x[2]*S5348[3][1]) + eff[4].x[1]*S5348[3][2]) + a48[6]*S5348[3][3] + a48[2]*(eff[4].x[3]*S5348[3][1] - eff[4].x[1]*S5348[3][3]) + a48[1]*(-(eff[4].x[3]*S5348[3][2]) + eff[4].x[2]*S5348[3][3]);

