
void
hoap3_InvDynNEfunc1(void)
     {
/* rotation matrices */
S00[1][1]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[2],2);
S00[1][2]=2*(baseo[0].q[2]*baseo[0].q[3] + baseo[0].q[1]*baseo[0].q[4]);
S00[1][3]=2*(-(baseo[0].q[1]*baseo[0].q[3]) + baseo[0].q[2]*baseo[0].q[4]);

S00[2][1]=2*(baseo[0].q[2]*baseo[0].q[3] - baseo[0].q[1]*baseo[0].q[4]);
S00[2][2]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[3],2);
S00[2][3]=2*(baseo[0].q[1]*baseo[0].q[2] + baseo[0].q[3]*baseo[0].q[4]);

S00[3][1]=2*(baseo[0].q[1]*baseo[0].q[3] + baseo[0].q[2]*baseo[0].q[4]);
S00[3][2]=2*(-(baseo[0].q[1]*baseo[0].q[2]) + baseo[0].q[3]*baseo[0].q[4]);
S00[3][3]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[4],2);



S20[1][1]=cstate13th;
S20[1][3]=sstate13th;

S20[2][1]=-sstate13th;
S20[2][3]=cstate13th;


S32[1][1]=-sstate1th;
S32[1][3]=-cstate1th;

S32[2][1]=-cstate1th;
S32[2][3]=sstate1th;


S43[1][1]=-sstate2th;
S43[1][3]=cstate2th;

S43[2][1]=-cstate2th;
S43[2][3]=-sstate2th;


S54[1][1]=cstate3th;
S54[1][3]=sstate3th;

S54[2][1]=-sstate3th;
S54[2][3]=cstate3th;


S65[1][1]=cstate4th;
S65[1][2]=sstate4th;

S65[2][1]=-sstate4th;
S65[2][2]=cstate4th;


S76[1][1]=cstate5th;
S76[1][2]=sstate5th;

S76[2][1]=-sstate5th;
S76[2][2]=cstate5th;


S87[1][1]=cstate6th;
S87[1][3]=-sstate6th;

S87[2][1]=-sstate6th;
S87[2][3]=-cstate6th;






S138[1][1]=rceff1a2*rceff1a3;
S138[1][2]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
S138[1][3]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;

S138[2][1]=-(rceff1a2*rseff1a3);
S138[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
S138[2][3]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;

S138[3][1]=rseff1a2;
S138[3][2]=-(rceff1a2*rseff1a1);
S138[3][3]=rceff1a1*rceff1a2;


S142[1][1]=-sstate7th;
S142[1][3]=-cstate7th;

S142[2][1]=-cstate7th;
S142[2][3]=sstate7th;


S1514[1][1]=-sstate8th;
S1514[1][3]=cstate8th;

S1514[2][1]=-cstate8th;
S1514[2][3]=-sstate8th;


S1615[1][1]=cstate9th;
S1615[1][3]=sstate9th;

S1615[2][1]=-sstate9th;
S1615[2][3]=cstate9th;


S1716[1][1]=cstate10th;
S1716[1][2]=sstate10th;

S1716[2][1]=-sstate10th;
S1716[2][2]=cstate10th;


S1817[1][1]=cstate11th;
S1817[1][2]=sstate11th;

S1817[2][1]=-sstate11th;
S1817[2][2]=cstate11th;


S1918[1][1]=cstate12th;
S1918[1][3]=-sstate12th;

S1918[2][1]=-sstate12th;
S1918[2][3]=-cstate12th;






S2419[1][1]=rceff2a2*rceff2a3;
S2419[1][2]=rceff2a3*rseff2a1*rseff2a2 + rceff2a1*rseff2a3;
S2419[1][3]=-(rceff2a1*rceff2a3*rseff2a2) + rseff2a1*rseff2a3;

S2419[2][1]=-(rceff2a2*rseff2a3);
S2419[2][2]=rceff2a1*rceff2a3 - rseff2a1*rseff2a2*rseff2a3;
S2419[2][3]=rceff2a3*rseff2a1 + rceff2a1*rseff2a2*rseff2a3;

S2419[3][1]=rseff2a2;
S2419[3][2]=-(rceff2a2*rseff2a1);
S2419[3][3]=rceff2a1*rceff2a2;




}


void
hoap3_InvDynNEfunc2(void)
     {
/* inverse rotation matrices */
Si00[1][1]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[2],2);
Si00[1][2]=2*(baseo[0].q[2]*baseo[0].q[3] - baseo[0].q[1]*baseo[0].q[4]);
Si00[1][3]=2*(baseo[0].q[1]*baseo[0].q[3] + baseo[0].q[2]*baseo[0].q[4]);

Si00[2][1]=2*(baseo[0].q[2]*baseo[0].q[3] + baseo[0].q[1]*baseo[0].q[4]);
Si00[2][2]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[3],2);
Si00[2][3]=2*(-(baseo[0].q[1]*baseo[0].q[2]) + baseo[0].q[3]*baseo[0].q[4]);

Si00[3][1]=2*(-(baseo[0].q[1]*baseo[0].q[3]) + baseo[0].q[2]*baseo[0].q[4]);
Si00[3][2]=2*(baseo[0].q[1]*baseo[0].q[2] + baseo[0].q[3]*baseo[0].q[4]);
Si00[3][3]=-1 + 2*Power(baseo[0].q[1],2) + 2*Power(baseo[0].q[4],2);



Si02[1][1]=cstate13th;
Si02[1][2]=-sstate13th;

Si02[3][1]=sstate13th;
Si02[3][2]=cstate13th;


Si23[1][1]=-sstate1th;
Si23[1][2]=-cstate1th;

Si23[3][1]=-cstate1th;
Si23[3][2]=sstate1th;


Si34[1][1]=-sstate2th;
Si34[1][2]=-cstate2th;

Si34[3][1]=cstate2th;
Si34[3][2]=-sstate2th;


Si45[1][1]=cstate3th;
Si45[1][2]=-sstate3th;

Si45[3][1]=sstate3th;
Si45[3][2]=cstate3th;


Si56[1][1]=cstate4th;
Si56[1][2]=-sstate4th;

Si56[2][1]=sstate4th;
Si56[2][2]=cstate4th;


Si67[1][1]=cstate5th;
Si67[1][2]=-sstate5th;

Si67[2][1]=sstate5th;
Si67[2][2]=cstate5th;


Si78[1][1]=cstate6th;
Si78[1][2]=-sstate6th;

Si78[3][1]=-sstate6th;
Si78[3][2]=-cstate6th;






Si813[1][1]=rceff1a2*rceff1a3;
Si813[1][2]=-(rceff1a2*rseff1a3);
Si813[1][3]=rseff1a2;

Si813[2][1]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
Si813[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
Si813[2][3]=-(rceff1a2*rseff1a1);

Si813[3][1]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;
Si813[3][2]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;
Si813[3][3]=rceff1a1*rceff1a2;


Si214[1][1]=-sstate7th;
Si214[1][2]=-cstate7th;

Si214[3][1]=-cstate7th;
Si214[3][2]=sstate7th;


Si1415[1][1]=-sstate8th;
Si1415[1][2]=-cstate8th;

Si1415[3][1]=cstate8th;
Si1415[3][2]=-sstate8th;


Si1516[1][1]=cstate9th;
Si1516[1][2]=-sstate9th;

Si1516[3][1]=sstate9th;
Si1516[3][2]=cstate9th;


Si1617[1][1]=cstate10th;
Si1617[1][2]=-sstate10th;

Si1617[2][1]=sstate10th;
Si1617[2][2]=cstate10th;


Si1718[1][1]=cstate11th;
Si1718[1][2]=-sstate11th;

Si1718[2][1]=sstate11th;
Si1718[2][2]=cstate11th;


Si1819[1][1]=cstate12th;
Si1819[1][2]=-sstate12th;

Si1819[3][1]=-sstate12th;
Si1819[3][2]=-cstate12th;






Si1924[1][1]=rceff2a2*rceff2a3;
Si1924[1][2]=-(rceff2a2*rseff2a3);
Si1924[1][3]=rseff2a2;

Si1924[2][1]=rceff2a3*rseff2a1*rseff2a2 + rceff2a1*rseff2a3;
Si1924[2][2]=rceff2a1*rceff2a3 - rseff2a1*rseff2a2*rseff2a3;
Si1924[2][3]=-(rceff2a2*rseff2a1);

Si1924[3][1]=-(rceff2a1*rceff2a3*rseff2a2) + rseff2a1*rseff2a3;
Si1924[3][2]=rceff2a3*rseff2a1 + rceff2a1*rseff2a2*rseff2a3;
Si1924[3][3]=rceff2a1*rceff2a2;




}


void
hoap3_InvDynNEfunc3(void)
     {
/* rotation matrices from global to link coordinates */
SG10[1][1]=S00[1][1];
SG10[1][2]=S00[1][2];
SG10[1][3]=S00[1][3];

SG10[2][1]=S00[2][1];
SG10[2][2]=S00[2][2];
SG10[2][3]=S00[2][3];

SG10[3][1]=S00[3][1];
SG10[3][2]=S00[3][2];
SG10[3][3]=S00[3][3];


SG20[1][1]=S00[1][1]*S20[1][1] + S00[3][1]*S20[1][3];
SG20[1][2]=S00[1][2]*S20[1][1] + S00[3][2]*S20[1][3];
SG20[1][3]=S00[1][3]*S20[1][1] + S00[3][3]*S20[1][3];

SG20[2][1]=S00[1][1]*S20[2][1] + S00[3][1]*S20[2][3];
SG20[2][2]=S00[1][2]*S20[2][1] + S00[3][2]*S20[2][3];
SG20[2][3]=S00[1][3]*S20[2][1] + S00[3][3]*S20[2][3];

SG20[3][1]=-S00[2][1];
SG20[3][2]=-S00[2][2];
SG20[3][3]=-S00[2][3];


SG30[1][1]=S32[1][1]*SG20[1][1] + S32[1][3]*SG20[3][1];
SG30[1][2]=S32[1][1]*SG20[1][2] + S32[1][3]*SG20[3][2];
SG30[1][3]=S32[1][1]*SG20[1][3] + S32[1][3]*SG20[3][3];

SG30[2][1]=S32[2][1]*SG20[1][1] + S32[2][3]*SG20[3][1];
SG30[2][2]=S32[2][1]*SG20[1][2] + S32[2][3]*SG20[3][2];
SG30[2][3]=S32[2][1]*SG20[1][3] + S32[2][3]*SG20[3][3];

SG30[3][1]=SG20[2][1];
SG30[3][2]=SG20[2][2];
SG30[3][3]=SG20[2][3];


SG40[1][1]=S43[1][1]*SG30[1][1] + S43[1][3]*SG30[3][1];
SG40[1][2]=S43[1][1]*SG30[1][2] + S43[1][3]*SG30[3][2];
SG40[1][3]=S43[1][1]*SG30[1][3] + S43[1][3]*SG30[3][3];

SG40[2][1]=S43[2][1]*SG30[1][1] + S43[2][3]*SG30[3][1];
SG40[2][2]=S43[2][1]*SG30[1][2] + S43[2][3]*SG30[3][2];
SG40[2][3]=S43[2][1]*SG30[1][3] + S43[2][3]*SG30[3][3];

SG40[3][1]=-SG30[2][1];
SG40[3][2]=-SG30[2][2];
SG40[3][3]=-SG30[2][3];


SG50[1][1]=S54[1][1]*SG40[1][1] + S54[1][3]*SG40[3][1];
SG50[1][2]=S54[1][1]*SG40[1][2] + S54[1][3]*SG40[3][2];
SG50[1][3]=S54[1][1]*SG40[1][3] + S54[1][3]*SG40[3][3];

SG50[2][1]=S54[2][1]*SG40[1][1] + S54[2][3]*SG40[3][1];
SG50[2][2]=S54[2][1]*SG40[1][2] + S54[2][3]*SG40[3][2];
SG50[2][3]=S54[2][1]*SG40[1][3] + S54[2][3]*SG40[3][3];

SG50[3][1]=-SG40[2][1];
SG50[3][2]=-SG40[2][2];
SG50[3][3]=-SG40[2][3];


SG60[1][1]=S65[1][1]*SG50[1][1] + S65[1][2]*SG50[2][1];
SG60[1][2]=S65[1][1]*SG50[1][2] + S65[1][2]*SG50[2][2];
SG60[1][3]=S65[1][1]*SG50[1][3] + S65[1][2]*SG50[2][3];

SG60[2][1]=S65[2][1]*SG50[1][1] + S65[2][2]*SG50[2][1];
SG60[2][2]=S65[2][1]*SG50[1][2] + S65[2][2]*SG50[2][2];
SG60[2][3]=S65[2][1]*SG50[1][3] + S65[2][2]*SG50[2][3];

SG60[3][1]=SG50[3][1];
SG60[3][2]=SG50[3][2];
SG60[3][3]=SG50[3][3];


SG70[1][1]=S76[1][1]*SG60[1][1] + S76[1][2]*SG60[2][1];
SG70[1][2]=S76[1][1]*SG60[1][2] + S76[1][2]*SG60[2][2];
SG70[1][3]=S76[1][1]*SG60[1][3] + S76[1][2]*SG60[2][3];

SG70[2][1]=S76[2][1]*SG60[1][1] + S76[2][2]*SG60[2][1];
SG70[2][2]=S76[2][1]*SG60[1][2] + S76[2][2]*SG60[2][2];
SG70[2][3]=S76[2][1]*SG60[1][3] + S76[2][2]*SG60[2][3];

SG70[3][1]=SG60[3][1];
SG70[3][2]=SG60[3][2];
SG70[3][3]=SG60[3][3];


SG80[1][1]=S87[1][1]*SG70[1][1] + S87[1][3]*SG70[3][1];
SG80[1][2]=S87[1][1]*SG70[1][2] + S87[1][3]*SG70[3][2];
SG80[1][3]=S87[1][1]*SG70[1][3] + S87[1][3]*SG70[3][3];

SG80[2][1]=S87[2][1]*SG70[1][1] + S87[2][3]*SG70[3][1];
SG80[2][2]=S87[2][1]*SG70[1][2] + S87[2][3]*SG70[3][2];
SG80[2][3]=S87[2][1]*SG70[1][3] + S87[2][3]*SG70[3][3];

SG80[3][1]=SG70[2][1];
SG80[3][2]=SG70[2][2];
SG80[3][3]=SG70[2][3];


SG90[1][1]=SG80[1][1];
SG90[1][2]=SG80[1][2];
SG90[1][3]=SG80[1][3];

SG90[2][1]=SG80[2][1];
SG90[2][2]=SG80[2][2];
SG90[2][3]=SG80[2][3];

SG90[3][1]=SG80[3][1];
SG90[3][2]=SG80[3][2];
SG90[3][3]=SG80[3][3];


SG100[1][1]=SG80[1][1];
SG100[1][2]=SG80[1][2];
SG100[1][3]=SG80[1][3];

SG100[2][1]=SG80[2][1];
SG100[2][2]=SG80[2][2];
SG100[2][3]=SG80[2][3];

SG100[3][1]=SG80[3][1];
SG100[3][2]=SG80[3][2];
SG100[3][3]=SG80[3][3];


SG110[1][1]=SG80[1][1];
SG110[1][2]=SG80[1][2];
SG110[1][3]=SG80[1][3];

SG110[2][1]=SG80[2][1];
SG110[2][2]=SG80[2][2];
SG110[2][3]=SG80[2][3];

SG110[3][1]=SG80[3][1];
SG110[3][2]=SG80[3][2];
SG110[3][3]=SG80[3][3];


SG120[1][1]=SG80[1][1];
SG120[1][2]=SG80[1][2];
SG120[1][3]=SG80[1][3];

SG120[2][1]=SG80[2][1];
SG120[2][2]=SG80[2][2];
SG120[2][3]=SG80[2][3];

SG120[3][1]=SG80[3][1];
SG120[3][2]=SG80[3][2];
SG120[3][3]=SG80[3][3];


SG130[1][1]=S138[1][1]*SG80[1][1] + S138[1][2]*SG80[2][1] + S138[1][3]*SG80[3][1];
SG130[1][2]=S138[1][1]*SG80[1][2] + S138[1][2]*SG80[2][2] + S138[1][3]*SG80[3][2];
SG130[1][3]=S138[1][1]*SG80[1][3] + S138[1][2]*SG80[2][3] + S138[1][3]*SG80[3][3];

SG130[2][1]=S138[2][1]*SG80[1][1] + S138[2][2]*SG80[2][1] + S138[2][3]*SG80[3][1];
SG130[2][2]=S138[2][1]*SG80[1][2] + S138[2][2]*SG80[2][2] + S138[2][3]*SG80[3][2];
SG130[2][3]=S138[2][1]*SG80[1][3] + S138[2][2]*SG80[2][3] + S138[2][3]*SG80[3][3];

SG130[3][1]=S138[3][1]*SG80[1][1] + S138[3][2]*SG80[2][1] + S138[3][3]*SG80[3][1];
SG130[3][2]=S138[3][1]*SG80[1][2] + S138[3][2]*SG80[2][2] + S138[3][3]*SG80[3][2];
SG130[3][3]=S138[3][1]*SG80[1][3] + S138[3][2]*SG80[2][3] + S138[3][3]*SG80[3][3];


SG140[1][1]=S142[1][1]*SG20[1][1] + S142[1][3]*SG20[3][1];
SG140[1][2]=S142[1][1]*SG20[1][2] + S142[1][3]*SG20[3][2];
SG140[1][3]=S142[1][1]*SG20[1][3] + S142[1][3]*SG20[3][3];

SG140[2][1]=S142[2][1]*SG20[1][1] + S142[2][3]*SG20[3][1];
SG140[2][2]=S142[2][1]*SG20[1][2] + S142[2][3]*SG20[3][2];
SG140[2][3]=S142[2][1]*SG20[1][3] + S142[2][3]*SG20[3][3];

SG140[3][1]=SG20[2][1];
SG140[3][2]=SG20[2][2];
SG140[3][3]=SG20[2][3];


SG150[1][1]=S1514[1][1]*SG140[1][1] + S1514[1][3]*SG140[3][1];
SG150[1][2]=S1514[1][1]*SG140[1][2] + S1514[1][3]*SG140[3][2];
SG150[1][3]=S1514[1][1]*SG140[1][3] + S1514[1][3]*SG140[3][3];

SG150[2][1]=S1514[2][1]*SG140[1][1] + S1514[2][3]*SG140[3][1];
SG150[2][2]=S1514[2][1]*SG140[1][2] + S1514[2][3]*SG140[3][2];
SG150[2][3]=S1514[2][1]*SG140[1][3] + S1514[2][3]*SG140[3][3];

SG150[3][1]=-SG140[2][1];
SG150[3][2]=-SG140[2][2];
SG150[3][3]=-SG140[2][3];


SG160[1][1]=S1615[1][1]*SG150[1][1] + S1615[1][3]*SG150[3][1];
SG160[1][2]=S1615[1][1]*SG150[1][2] + S1615[1][3]*SG150[3][2];
SG160[1][3]=S1615[1][1]*SG150[1][3] + S1615[1][3]*SG150[3][3];

SG160[2][1]=S1615[2][1]*SG150[1][1] + S1615[2][3]*SG150[3][1];
SG160[2][2]=S1615[2][1]*SG150[1][2] + S1615[2][3]*SG150[3][2];
SG160[2][3]=S1615[2][1]*SG150[1][3] + S1615[2][3]*SG150[3][3];

SG160[3][1]=-SG150[2][1];
SG160[3][2]=-SG150[2][2];
SG160[3][3]=-SG150[2][3];


SG170[1][1]=S1716[1][1]*SG160[1][1] + S1716[1][2]*SG160[2][1];
SG170[1][2]=S1716[1][1]*SG160[1][2] + S1716[1][2]*SG160[2][2];
SG170[1][3]=S1716[1][1]*SG160[1][3] + S1716[1][2]*SG160[2][3];

SG170[2][1]=S1716[2][1]*SG160[1][1] + S1716[2][2]*SG160[2][1];
SG170[2][2]=S1716[2][1]*SG160[1][2] + S1716[2][2]*SG160[2][2];
SG170[2][3]=S1716[2][1]*SG160[1][3] + S1716[2][2]*SG160[2][3];

SG170[3][1]=SG160[3][1];
SG170[3][2]=SG160[3][2];
SG170[3][3]=SG160[3][3];


SG180[1][1]=S1817[1][1]*SG170[1][1] + S1817[1][2]*SG170[2][1];
SG180[1][2]=S1817[1][1]*SG170[1][2] + S1817[1][2]*SG170[2][2];
SG180[1][3]=S1817[1][1]*SG170[1][3] + S1817[1][2]*SG170[2][3];

SG180[2][1]=S1817[2][1]*SG170[1][1] + S1817[2][2]*SG170[2][1];
SG180[2][2]=S1817[2][1]*SG170[1][2] + S1817[2][2]*SG170[2][2];
SG180[2][3]=S1817[2][1]*SG170[1][3] + S1817[2][2]*SG170[2][3];

SG180[3][1]=SG170[3][1];
SG180[3][2]=SG170[3][2];
SG180[3][3]=SG170[3][3];


SG190[1][1]=S1918[1][1]*SG180[1][1] + S1918[1][3]*SG180[3][1];
SG190[1][2]=S1918[1][1]*SG180[1][2] + S1918[1][3]*SG180[3][2];
SG190[1][3]=S1918[1][1]*SG180[1][3] + S1918[1][3]*SG180[3][3];

SG190[2][1]=S1918[2][1]*SG180[1][1] + S1918[2][3]*SG180[3][1];
SG190[2][2]=S1918[2][1]*SG180[1][2] + S1918[2][3]*SG180[3][2];
SG190[2][3]=S1918[2][1]*SG180[1][3] + S1918[2][3]*SG180[3][3];

SG190[3][1]=SG180[2][1];
SG190[3][2]=SG180[2][2];
SG190[3][3]=SG180[2][3];


SG200[1][1]=SG190[1][1];
SG200[1][2]=SG190[1][2];
SG200[1][3]=SG190[1][3];

SG200[2][1]=SG190[2][1];
SG200[2][2]=SG190[2][2];
SG200[2][3]=SG190[2][3];

SG200[3][1]=SG190[3][1];
SG200[3][2]=SG190[3][2];
SG200[3][3]=SG190[3][3];


SG210[1][1]=SG190[1][1];
SG210[1][2]=SG190[1][2];
SG210[1][3]=SG190[1][3];

SG210[2][1]=SG190[2][1];
SG210[2][2]=SG190[2][2];
SG210[2][3]=SG190[2][3];

SG210[3][1]=SG190[3][1];
SG210[3][2]=SG190[3][2];
SG210[3][3]=SG190[3][3];


SG220[1][1]=SG190[1][1];
SG220[1][2]=SG190[1][2];
SG220[1][3]=SG190[1][3];

SG220[2][1]=SG190[2][1];
SG220[2][2]=SG190[2][2];
SG220[2][3]=SG190[2][3];

SG220[3][1]=SG190[3][1];
SG220[3][2]=SG190[3][2];
SG220[3][3]=SG190[3][3];


SG230[1][1]=SG190[1][1];
SG230[1][2]=SG190[1][2];
SG230[1][3]=SG190[1][3];

SG230[2][1]=SG190[2][1];
SG230[2][2]=SG190[2][2];
SG230[2][3]=SG190[2][3];

SG230[3][1]=SG190[3][1];
SG230[3][2]=SG190[3][2];
SG230[3][3]=SG190[3][3];


SG240[1][1]=S2419[1][1]*SG190[1][1] + S2419[1][2]*SG190[2][1] + S2419[1][3]*SG190[3][1];
SG240[1][2]=S2419[1][1]*SG190[1][2] + S2419[1][2]*SG190[2][2] + S2419[1][3]*SG190[3][2];
SG240[1][3]=S2419[1][1]*SG190[1][3] + S2419[1][2]*SG190[2][3] + S2419[1][3]*SG190[3][3];

SG240[2][1]=S2419[2][1]*SG190[1][1] + S2419[2][2]*SG190[2][1] + S2419[2][3]*SG190[3][1];
SG240[2][2]=S2419[2][1]*SG190[1][2] + S2419[2][2]*SG190[2][2] + S2419[2][3]*SG190[3][2];
SG240[2][3]=S2419[2][1]*SG190[1][3] + S2419[2][2]*SG190[2][3] + S2419[2][3]*SG190[3][3];

SG240[3][1]=S2419[3][1]*SG190[1][1] + S2419[3][2]*SG190[2][1] + S2419[3][3]*SG190[3][1];
SG240[3][2]=S2419[3][1]*SG190[1][2] + S2419[3][2]*SG190[2][2] + S2419[3][3]*SG190[3][2];
SG240[3][3]=S2419[3][1]*SG190[1][3] + S2419[3][2]*SG190[2][3] + S2419[3][3]*SG190[3][3];




}


void
hoap3_InvDynNEfunc4(void)
     {
/* velocity vectors */
v0[1]=baseo[0].ad[1]*S00[1][1] + baseo[0].ad[2]*S00[1][2] + baseo[0].ad[3]*S00[1][3];
v0[2]=baseo[0].ad[1]*S00[2][1] + baseo[0].ad[2]*S00[2][2] + baseo[0].ad[3]*S00[2][3];
v0[3]=baseo[0].ad[1]*S00[3][1] + baseo[0].ad[2]*S00[3][2] + baseo[0].ad[3]*S00[3][3];
v0[4]=basec[0].xd[1]*S00[1][1] + basec[0].xd[2]*S00[1][2] + basec[0].xd[3]*S00[1][3];
v0[5]=basec[0].xd[1]*S00[2][1] + basec[0].xd[2]*S00[2][2] + basec[0].xd[3]*S00[2][3];
v0[6]=basec[0].xd[1]*S00[3][1] + basec[0].xd[2]*S00[3][2] + basec[0].xd[3]*S00[3][3];

v1[1]=v0[1];
v1[2]=v0[2];
v1[3]=v0[3];
v1[4]=BODYLINK1*v0[2] + v0[4];
v1[5]=-(BODYLINK1*v0[1]) + v0[5];
v1[6]=v0[6];

v2[1]=v0[1]*S20[1][1] + v0[3]*S20[1][3];
v2[2]=v0[1]*S20[2][1] + v0[3]*S20[2][3];
v2[3]=state[13].thd - v0[2];
v2[4]=v0[4]*S20[1][1] - BODYLINK2*v0[2]*S20[1][3] + v0[6]*S20[1][3];
v2[5]=v0[4]*S20[2][1] - BODYLINK2*v0[2]*S20[2][3] + v0[6]*S20[2][3];
v2[6]=-(BODYLINK2*v0[3]) - v0[5];

v3[1]=v2[1]*S32[1][1] + v2[3]*S32[1][3];
v3[2]=v2[1]*S32[2][1] + v2[3]*S32[2][3];
v3[3]=state[1].thd + v2[2];
v3[4]=WAISTLINK1*v2[3]*S32[1][1] + v2[4]*S32[1][1] - WAISTLINK1*v2[1]*S32[1][3] + v2[6]*S32[1][3] + v2[2]*(LEGLINK1*S32[1][1] + WAISTLINK2*S32[1][3]);
v3[5]=WAISTLINK1*v2[3]*S32[2][1] + v2[4]*S32[2][1] - WAISTLINK1*v2[1]*S32[2][3] + v2[6]*S32[2][3] + v2[2]*(LEGLINK1*S32[2][1] + WAISTLINK2*S32[2][3]);
v3[6]=-(LEGLINK1*v2[1]) - WAISTLINK2*v2[3] + v2[5];

v4[1]=v3[1]*S43[1][1] + v3[3]*S43[1][3];
v4[2]=v3[1]*S43[2][1] + v3[3]*S43[2][3];
v4[3]=state[2].thd - v3[2];
v4[4]=v3[4]*S43[1][1] + v3[6]*S43[1][3];
v4[5]=v3[4]*S43[2][1] + v3[6]*S43[2][3];
v4[6]=-v3[5];

v5[1]=v4[1]*S54[1][1] + v4[3]*S54[1][3];
v5[2]=v4[1]*S54[2][1] + v4[3]*S54[2][3];
v5[3]=state[3].thd - v4[2];
v5[4]=v4[4]*S54[1][1] + v4[6]*S54[1][3];
v5[5]=v4[4]*S54[2][1] + v4[6]*S54[2][3];
v5[6]=-v4[5];

v6[1]=v5[1]*S65[1][1] + v5[2]*S65[1][2];
v6[2]=v5[1]*S65[2][1] + v5[2]*S65[2][2];
v6[3]=state[4].thd + v5[3];
v6[4]=v5[4]*S65[1][1] - LEGLINK2*v5[3]*S65[1][2] + v5[5]*S65[1][2];
v6[5]=v5[4]*S65[2][1] - LEGLINK2*v5[3]*S65[2][2] + v5[5]*S65[2][2];
v6[6]=LEGLINK2*v5[2] + v5[6];

v7[1]=v6[1]*S76[1][1] + v6[2]*S76[1][2];
v7[2]=v6[1]*S76[2][1] + v6[2]*S76[2][2];
v7[3]=state[5].thd + v6[3];
v7[4]=v6[4]*S76[1][1] - LEGLINK3*v6[3]*S76[1][2] + v6[5]*S76[1][2];
v7[5]=v6[4]*S76[2][1] - LEGLINK3*v6[3]*S76[2][2] + v6[5]*S76[2][2];
v7[6]=LEGLINK3*v6[2] + v6[6];

v8[1]=v7[1]*S87[1][1] + v7[3]*S87[1][3];
v8[2]=v7[1]*S87[2][1] + v7[3]*S87[2][3];
v8[3]=state[6].thd + v7[2];
v8[4]=v7[4]*S87[1][1] + v7[6]*S87[1][3];
v8[5]=v7[4]*S87[2][1] + v7[6]*S87[2][3];
v8[6]=v7[5];

v9[1]=v8[1];
v9[2]=v8[2];
v9[3]=v8[3];
v9[4]=FOOTLLENGLONG*v8[2] + FOOTWIDLONG*v8[3] + v8[4];
v9[5]=-(FOOTLLENGLONG*v8[1]) - LEGLINK4*v8[3] + v8[5];
v9[6]=-(FOOTWIDLONG*v8[1]) + LEGLINK4*v8[2] + v8[6];

v10[1]=v8[1];
v10[2]=v8[2];
v10[3]=v8[3];
v10[4]=FOOTLLENGLONG*v8[2] - FOOTWIDSHORT*v8[3] + v8[4];
v10[5]=-(FOOTLLENGLONG*v8[1]) - LEGLINK4*v8[3] + v8[5];
v10[6]=FOOTWIDSHORT*v8[1] + LEGLINK4*v8[2] + v8[6];

v11[1]=v8[1];
v11[2]=v8[2];
v11[3]=v8[3];
v11[4]=-(FOOTLENGSHORT*v8[2]) - FOOTWIDSHORT*v8[3] + v8[4];
v11[5]=FOOTLENGSHORT*v8[1] - LEGLINK4*v8[3] + v8[5];
v11[6]=FOOTWIDSHORT*v8[1] + LEGLINK4*v8[2] + v8[6];

v12[1]=v8[1];
v12[2]=v8[2];
v12[3]=v8[3];
v12[4]=-(FOOTLENGSHORT*v8[2]) + FOOTWIDLONG*v8[3] + v8[4];
v12[5]=FOOTLENGSHORT*v8[1] - LEGLINK4*v8[3] + v8[5];
v12[6]=-(FOOTWIDLONG*v8[1]) + LEGLINK4*v8[2] + v8[6];

v13[1]=v8[1]*S138[1][1] + v8[2]*S138[1][2] + v8[3]*S138[1][3];
v13[2]=v8[1]*S138[2][1] + v8[2]*S138[2][2] + v8[3]*S138[2][3];
v13[3]=v8[1]*S138[3][1] + v8[2]*S138[3][2] + v8[3]*S138[3][3];
v13[4]=v8[4]*S138[1][1] + v8[5]*S138[1][2] + v8[3]*(-(eff[1].x[2]*S138[1][1]) + eff[1].x[1]*S138[1][2]) + v8[6]*S138[1][3] + v8[2]*(eff[1].x[3]*S138[1][1] - eff[1].x[1]*S138[1][3]) + v8[1]*(-(eff[1].x[3]*S138[1][2]) + eff[1].x[2]*S138[1][3]);
v13[5]=v8[4]*S138[2][1] + v8[5]*S138[2][2] + v8[3]*(-(eff[1].x[2]*S138[2][1]) + eff[1].x[1]*S138[2][2]) + v8[6]*S138[2][3] + v8[2]*(eff[1].x[3]*S138[2][1] - eff[1].x[1]*S138[2][3]) + v8[1]*(-(eff[1].x[3]*S138[2][2]) + eff[1].x[2]*S138[2][3]);
v13[6]=v8[4]*S138[3][1] + v8[5]*S138[3][2] + v8[3]*(-(eff[1].x[2]*S138[3][1]) + eff[1].x[1]*S138[3][2]) + v8[6]*S138[3][3] + v8[2]*(eff[1].x[3]*S138[3][1] - eff[1].x[1]*S138[3][3]) + v8[1]*(-(eff[1].x[3]*S138[3][2]) + eff[1].x[2]*S138[3][3]);

v14[1]=v2[1]*S142[1][1] + v2[3]*S142[1][3];
v14[2]=v2[1]*S142[2][1] + v2[3]*S142[2][3];
v14[3]=state[7].thd + v2[2];
v14[4]=WAISTLINK1*v2[3]*S142[1][1] + v2[4]*S142[1][1] - WAISTLINK1*v2[1]*S142[1][3] + v2[6]*S142[1][3] + v2[2]*(-(LEGLINK1*S142[1][1]) + WAISTLINK2*S142[1][3]);
v14[5]=WAISTLINK1*v2[3]*S142[2][1] + v2[4]*S142[2][1] - WAISTLINK1*v2[1]*S142[2][3] + v2[6]*S142[2][3] + v2[2]*(-(LEGLINK1*S142[2][1]) + WAISTLINK2*S142[2][3]);
v14[6]=LEGLINK1*v2[1] - WAISTLINK2*v2[3] + v2[5];

v15[1]=v14[1]*S1514[1][1] + v14[3]*S1514[1][3];
v15[2]=v14[1]*S1514[2][1] + v14[3]*S1514[2][3];
v15[3]=state[8].thd - v14[2];
v15[4]=v14[4]*S1514[1][1] + v14[6]*S1514[1][3];
v15[5]=v14[4]*S1514[2][1] + v14[6]*S1514[2][3];
v15[6]=-v14[5];

v16[1]=v15[1]*S1615[1][1] + v15[3]*S1615[1][3];
v16[2]=v15[1]*S1615[2][1] + v15[3]*S1615[2][3];
v16[3]=state[9].thd - v15[2];
v16[4]=v15[4]*S1615[1][1] + v15[6]*S1615[1][3];
v16[5]=v15[4]*S1615[2][1] + v15[6]*S1615[2][3];
v16[6]=-v15[5];

v17[1]=v16[1]*S1716[1][1] + v16[2]*S1716[1][2];
v17[2]=v16[1]*S1716[2][1] + v16[2]*S1716[2][2];
v17[3]=state[10].thd + v16[3];
v17[4]=v16[4]*S1716[1][1] - LEGLINK2*v16[3]*S1716[1][2] + v16[5]*S1716[1][2];
v17[5]=v16[4]*S1716[2][1] - LEGLINK2*v16[3]*S1716[2][2] + v16[5]*S1716[2][2];
v17[6]=LEGLINK2*v16[2] + v16[6];

v18[1]=v17[1]*S1817[1][1] + v17[2]*S1817[1][2];
v18[2]=v17[1]*S1817[2][1] + v17[2]*S1817[2][2];
v18[3]=state[11].thd + v17[3];
v18[4]=v17[4]*S1817[1][1] - LEGLINK3*v17[3]*S1817[1][2] + v17[5]*S1817[1][2];
v18[5]=v17[4]*S1817[2][1] - LEGLINK3*v17[3]*S1817[2][2] + v17[5]*S1817[2][2];
v18[6]=LEGLINK3*v17[2] + v17[6];

v19[1]=v18[1]*S1918[1][1] + v18[3]*S1918[1][3];
v19[2]=v18[1]*S1918[2][1] + v18[3]*S1918[2][3];
v19[3]=state[12].thd + v18[2];
v19[4]=v18[4]*S1918[1][1] + v18[6]*S1918[1][3];
v19[5]=v18[4]*S1918[2][1] + v18[6]*S1918[2][3];
v19[6]=v18[5];

v20[1]=v19[1];
v20[2]=v19[2];
v20[3]=v19[3];
v20[4]=FOOTLLENGLONG*v19[2] - FOOTWIDLONG*v19[3] + v19[4];
v20[5]=-(FOOTLLENGLONG*v19[1]) - LEGLINK4*v19[3] + v19[5];
v20[6]=FOOTWIDLONG*v19[1] + LEGLINK4*v19[2] + v19[6];

v21[1]=v19[1];
v21[2]=v19[2];
v21[3]=v19[3];
v21[4]=FOOTLLENGLONG*v19[2] + FOOTWIDSHORT*v19[3] + v19[4];
v21[5]=-(FOOTLLENGLONG*v19[1]) - LEGLINK4*v19[3] + v19[5];
v21[6]=-(FOOTWIDSHORT*v19[1]) + LEGLINK4*v19[2] + v19[6];

v22[1]=v19[1];
v22[2]=v19[2];
v22[3]=v19[3];
v22[4]=-(FOOTLENGSHORT*v19[2]) + FOOTWIDSHORT*v19[3] + v19[4];
v22[5]=FOOTLENGSHORT*v19[1] - LEGLINK4*v19[3] + v19[5];
v22[6]=-(FOOTWIDSHORT*v19[1]) + LEGLINK4*v19[2] + v19[6];

v23[1]=v19[1];
v23[2]=v19[2];
v23[3]=v19[3];
v23[4]=-(FOOTLENGSHORT*v19[2]) - FOOTWIDLONG*v19[3] + v19[4];
v23[5]=FOOTLENGSHORT*v19[1] - LEGLINK4*v19[3] + v19[5];
v23[6]=FOOTWIDLONG*v19[1] + LEGLINK4*v19[2] + v19[6];

v24[1]=v19[1]*S2419[1][1] + v19[2]*S2419[1][2] + v19[3]*S2419[1][3];
v24[2]=v19[1]*S2419[2][1] + v19[2]*S2419[2][2] + v19[3]*S2419[2][3];
v24[3]=v19[1]*S2419[3][1] + v19[2]*S2419[3][2] + v19[3]*S2419[3][3];
v24[4]=v19[4]*S2419[1][1] + v19[5]*S2419[1][2] + v19[3]*(-(eff[2].x[2]*S2419[1][1]) + eff[2].x[1]*S2419[1][2]) + v19[6]*S2419[1][3] + v19[2]*(eff[2].x[3]*S2419[1][1] - eff[2].x[1]*S2419[1][3]) + v19[1]*(-(eff[2].x[3]*S2419[1][2]) + eff[2].x[2]*S2419[1][3]);
v24[5]=v19[4]*S2419[2][1] + v19[5]*S2419[2][2] + v19[3]*(-(eff[2].x[2]*S2419[2][1]) + eff[2].x[1]*S2419[2][2]) + v19[6]*S2419[2][3] + v19[2]*(eff[2].x[3]*S2419[2][1] - eff[2].x[1]*S2419[2][3]) + v19[1]*(-(eff[2].x[3]*S2419[2][2]) + eff[2].x[2]*S2419[2][3]);
v24[6]=v19[4]*S2419[3][1] + v19[5]*S2419[3][2] + v19[3]*(-(eff[2].x[2]*S2419[3][1]) + eff[2].x[1]*S2419[3][2]) + v19[6]*S2419[3][3] + v19[2]*(eff[2].x[3]*S2419[3][1] - eff[2].x[1]*S2419[3][3]) + v19[1]*(-(eff[2].x[3]*S2419[3][2]) + eff[2].x[2]*S2419[3][3]);



}


void
hoap3_InvDynNEfunc5(void)
     {
/* acceleration vectors */
a0[1]=baseo[0].add[1]*S00[1][1] + baseo[0].add[2]*S00[1][2] + baseo[0].add[3]*S00[1][3];
a0[2]=baseo[0].add[1]*S00[2][1] + baseo[0].add[2]*S00[2][2] + baseo[0].add[3]*S00[2][3];
a0[3]=baseo[0].add[1]*S00[3][1] + baseo[0].add[2]*S00[3][2] + baseo[0].add[3]*S00[3][3];
a0[4]=basec[0].xdd[1]*S00[1][1] + basec[0].xdd[2]*S00[1][2] + (gravity + basec[0].xdd[3])*S00[1][3];
a0[5]=basec[0].xdd[1]*S00[2][1] + basec[0].xdd[2]*S00[2][2] + (gravity + basec[0].xdd[3])*S00[2][3];
a0[6]=basec[0].xdd[1]*S00[3][1] + basec[0].xdd[2]*S00[3][2] + (gravity + basec[0].xdd[3])*S00[3][3];

a1[1]=a0[1];
a1[2]=a0[2];
a1[3]=a0[3];
a1[4]=BODYLINK1*a0[2] + a0[4];
a1[5]=-(BODYLINK1*a0[1]) + a0[5];
a1[6]=a0[6];

a2[1]=state[13].thd*v2[2] + a0[1]*S20[1][1] + a0[3]*S20[1][3];
a2[2]=-(state[13].thd*v2[1]) + a0[1]*S20[2][1] + a0[3]*S20[2][3];
a2[3]=state[13].thdd - a0[2];
a2[4]=state[13].thd*v2[5] + a0[4]*S20[1][1] - BODYLINK2*a0[2]*S20[1][3] + a0[6]*S20[1][3];
a2[5]=-(state[13].thd*v2[4]) + a0[4]*S20[2][1] - BODYLINK2*a0[2]*S20[2][3] + a0[6]*S20[2][3];
a2[6]=-(BODYLINK2*a0[3]) - a0[5];

a3[1]=state[1].thd*v3[2] + a2[1]*S32[1][1] + a2[3]*S32[1][3];
a3[2]=-(state[1].thd*v3[1]) + a2[1]*S32[2][1] + a2[3]*S32[2][3];
a3[3]=state[1].thdd + a2[2];
a3[4]=state[1].thd*v3[5] + WAISTLINK1*a2[3]*S32[1][1] + a2[4]*S32[1][1] - WAISTLINK1*a2[1]*S32[1][3] + a2[6]*S32[1][3] + a2[2]*(LEGLINK1*S32[1][1] + WAISTLINK2*S32[1][3]);
a3[5]=-(state[1].thd*v3[4]) + WAISTLINK1*a2[3]*S32[2][1] + a2[4]*S32[2][1] - WAISTLINK1*a2[1]*S32[2][3] + a2[6]*S32[2][3] + a2[2]*(LEGLINK1*S32[2][1] + WAISTLINK2*S32[2][3]);
a3[6]=-(LEGLINK1*a2[1]) - WAISTLINK2*a2[3] + a2[5];

a4[1]=state[2].thd*v4[2] + a3[1]*S43[1][1] + a3[3]*S43[1][3];
a4[2]=-(state[2].thd*v4[1]) + a3[1]*S43[2][1] + a3[3]*S43[2][3];
a4[3]=state[2].thdd - a3[2];
a4[4]=state[2].thd*v4[5] + a3[4]*S43[1][1] + a3[6]*S43[1][3];
a4[5]=-(state[2].thd*v4[4]) + a3[4]*S43[2][1] + a3[6]*S43[2][3];
a4[6]=-a3[5];

a5[1]=state[3].thd*v5[2] + a4[1]*S54[1][1] + a4[3]*S54[1][3];
a5[2]=-(state[3].thd*v5[1]) + a4[1]*S54[2][1] + a4[3]*S54[2][3];
a5[3]=state[3].thdd - a4[2];
a5[4]=state[3].thd*v5[5] + a4[4]*S54[1][1] + a4[6]*S54[1][3];
a5[5]=-(state[3].thd*v5[4]) + a4[4]*S54[2][1] + a4[6]*S54[2][3];
a5[6]=-a4[5];

a6[1]=state[4].thd*v6[2] + a5[1]*S65[1][1] + a5[2]*S65[1][2];
a6[2]=-(state[4].thd*v6[1]) + a5[1]*S65[2][1] + a5[2]*S65[2][2];
a6[3]=state[4].thdd + a5[3];
a6[4]=state[4].thd*v6[5] + a5[4]*S65[1][1] - LEGLINK2*a5[3]*S65[1][2] + a5[5]*S65[1][2];
a6[5]=-(state[4].thd*v6[4]) + a5[4]*S65[2][1] - LEGLINK2*a5[3]*S65[2][2] + a5[5]*S65[2][2];
a6[6]=LEGLINK2*a5[2] + a5[6];

a7[1]=state[5].thd*v7[2] + a6[1]*S76[1][1] + a6[2]*S76[1][2];
a7[2]=-(state[5].thd*v7[1]) + a6[1]*S76[2][1] + a6[2]*S76[2][2];
a7[3]=state[5].thdd + a6[3];
a7[4]=state[5].thd*v7[5] + a6[4]*S76[1][1] - LEGLINK3*a6[3]*S76[1][2] + a6[5]*S76[1][2];
a7[5]=-(state[5].thd*v7[4]) + a6[4]*S76[2][1] - LEGLINK3*a6[3]*S76[2][2] + a6[5]*S76[2][2];
a7[6]=LEGLINK3*a6[2] + a6[6];

a8[1]=state[6].thd*v8[2] + a7[1]*S87[1][1] + a7[3]*S87[1][3];
a8[2]=-(state[6].thd*v8[1]) + a7[1]*S87[2][1] + a7[3]*S87[2][3];
a8[3]=state[6].thdd + a7[2];
a8[4]=state[6].thd*v8[5] + a7[4]*S87[1][1] + a7[6]*S87[1][3];
a8[5]=-(state[6].thd*v8[4]) + a7[4]*S87[2][1] + a7[6]*S87[2][3];
a8[6]=a7[5];

a9[1]=a8[1];
a9[2]=a8[2];
a9[3]=a8[3];
a9[4]=FOOTLLENGLONG*a8[2] + FOOTWIDLONG*a8[3] + a8[4];
a9[5]=-(FOOTLLENGLONG*a8[1]) - LEGLINK4*a8[3] + a8[5];
a9[6]=-(FOOTWIDLONG*a8[1]) + LEGLINK4*a8[2] + a8[6];

a10[1]=a8[1];
a10[2]=a8[2];
a10[3]=a8[3];
a10[4]=FOOTLLENGLONG*a8[2] - FOOTWIDSHORT*a8[3] + a8[4];
a10[5]=-(FOOTLLENGLONG*a8[1]) - LEGLINK4*a8[3] + a8[5];
a10[6]=FOOTWIDSHORT*a8[1] + LEGLINK4*a8[2] + a8[6];

a11[1]=a8[1];
a11[2]=a8[2];
a11[3]=a8[3];
a11[4]=-(FOOTLENGSHORT*a8[2]) - FOOTWIDSHORT*a8[3] + a8[4];
a11[5]=FOOTLENGSHORT*a8[1] - LEGLINK4*a8[3] + a8[5];
a11[6]=FOOTWIDSHORT*a8[1] + LEGLINK4*a8[2] + a8[6];

a12[1]=a8[1];
a12[2]=a8[2];
a12[3]=a8[3];
a12[4]=-(FOOTLENGSHORT*a8[2]) + FOOTWIDLONG*a8[3] + a8[4];
a12[5]=FOOTLENGSHORT*a8[1] - LEGLINK4*a8[3] + a8[5];
a12[6]=-(FOOTWIDLONG*a8[1]) + LEGLINK4*a8[2] + a8[6];

a13[1]=a8[1]*S138[1][1] + a8[2]*S138[1][2] + a8[3]*S138[1][3];
a13[2]=a8[1]*S138[2][1] + a8[2]*S138[2][2] + a8[3]*S138[2][3];
a13[3]=a8[1]*S138[3][1] + a8[2]*S138[3][2] + a8[3]*S138[3][3];
a13[4]=a8[4]*S138[1][1] + a8[5]*S138[1][2] + a8[3]*(-(eff[1].x[2]*S138[1][1]) + eff[1].x[1]*S138[1][2]) + a8[6]*S138[1][3] + a8[2]*(eff[1].x[3]*S138[1][1] - eff[1].x[1]*S138[1][3]) + a8[1]*(-(eff[1].x[3]*S138[1][2]) + eff[1].x[2]*S138[1][3]);
a13[5]=a8[4]*S138[2][1] + a8[5]*S138[2][2] + a8[3]*(-(eff[1].x[2]*S138[2][1]) + eff[1].x[1]*S138[2][2]) + a8[6]*S138[2][3] + a8[2]*(eff[1].x[3]*S138[2][1] - eff[1].x[1]*S138[2][3]) + a8[1]*(-(eff[1].x[3]*S138[2][2]) + eff[1].x[2]*S138[2][3]);
a13[6]=a8[4]*S138[3][1] + a8[5]*S138[3][2] + a8[3]*(-(eff[1].x[2]*S138[3][1]) + eff[1].x[1]*S138[3][2]) + a8[6]*S138[3][3] + a8[2]*(eff[1].x[3]*S138[3][1] - eff[1].x[1]*S138[3][3]) + a8[1]*(-(eff[1].x[3]*S138[3][2]) + eff[1].x[2]*S138[3][3]);

a14[1]=state[7].thd*v14[2] + a2[1]*S142[1][1] + a2[3]*S142[1][3];
a14[2]=-(state[7].thd*v14[1]) + a2[1]*S142[2][1] + a2[3]*S142[2][3];
a14[3]=state[7].thdd + a2[2];
a14[4]=state[7].thd*v14[5] + WAISTLINK1*a2[3]*S142[1][1] + a2[4]*S142[1][1] - WAISTLINK1*a2[1]*S142[1][3] + a2[6]*S142[1][3] + a2[2]*(-(LEGLINK1*S142[1][1]) + WAISTLINK2*S142[1][3]);
a14[5]=-(state[7].thd*v14[4]) + WAISTLINK1*a2[3]*S142[2][1] + a2[4]*S142[2][1] - WAISTLINK1*a2[1]*S142[2][3] + a2[6]*S142[2][3] + a2[2]*(-(LEGLINK1*S142[2][1]) + WAISTLINK2*S142[2][3]);
a14[6]=LEGLINK1*a2[1] - WAISTLINK2*a2[3] + a2[5];

a15[1]=state[8].thd*v15[2] + a14[1]*S1514[1][1] + a14[3]*S1514[1][3];
a15[2]=-(state[8].thd*v15[1]) + a14[1]*S1514[2][1] + a14[3]*S1514[2][3];
a15[3]=state[8].thdd - a14[2];
a15[4]=state[8].thd*v15[5] + a14[4]*S1514[1][1] + a14[6]*S1514[1][3];
a15[5]=-(state[8].thd*v15[4]) + a14[4]*S1514[2][1] + a14[6]*S1514[2][3];
a15[6]=-a14[5];

a16[1]=state[9].thd*v16[2] + a15[1]*S1615[1][1] + a15[3]*S1615[1][3];
a16[2]=-(state[9].thd*v16[1]) + a15[1]*S1615[2][1] + a15[3]*S1615[2][3];
a16[3]=state[9].thdd - a15[2];
a16[4]=state[9].thd*v16[5] + a15[4]*S1615[1][1] + a15[6]*S1615[1][3];
a16[5]=-(state[9].thd*v16[4]) + a15[4]*S1615[2][1] + a15[6]*S1615[2][3];
a16[6]=-a15[5];

a17[1]=state[10].thd*v17[2] + a16[1]*S1716[1][1] + a16[2]*S1716[1][2];
a17[2]=-(state[10].thd*v17[1]) + a16[1]*S1716[2][1] + a16[2]*S1716[2][2];
a17[3]=state[10].thdd + a16[3];
a17[4]=state[10].thd*v17[5] + a16[4]*S1716[1][1] - LEGLINK2*a16[3]*S1716[1][2] + a16[5]*S1716[1][2];
a17[5]=-(state[10].thd*v17[4]) + a16[4]*S1716[2][1] - LEGLINK2*a16[3]*S1716[2][2] + a16[5]*S1716[2][2];
a17[6]=LEGLINK2*a16[2] + a16[6];

a18[1]=state[11].thd*v18[2] + a17[1]*S1817[1][1] + a17[2]*S1817[1][2];
a18[2]=-(state[11].thd*v18[1]) + a17[1]*S1817[2][1] + a17[2]*S1817[2][2];
a18[3]=state[11].thdd + a17[3];
a18[4]=state[11].thd*v18[5] + a17[4]*S1817[1][1] - LEGLINK3*a17[3]*S1817[1][2] + a17[5]*S1817[1][2];
a18[5]=-(state[11].thd*v18[4]) + a17[4]*S1817[2][1] - LEGLINK3*a17[3]*S1817[2][2] + a17[5]*S1817[2][2];
a18[6]=LEGLINK3*a17[2] + a17[6];

a19[1]=state[12].thd*v19[2] + a18[1]*S1918[1][1] + a18[3]*S1918[1][3];
a19[2]=-(state[12].thd*v19[1]) + a18[1]*S1918[2][1] + a18[3]*S1918[2][3];
a19[3]=state[12].thdd + a18[2];
a19[4]=state[12].thd*v19[5] + a18[4]*S1918[1][1] + a18[6]*S1918[1][3];
a19[5]=-(state[12].thd*v19[4]) + a18[4]*S1918[2][1] + a18[6]*S1918[2][3];
a19[6]=a18[5];

a20[1]=a19[1];
a20[2]=a19[2];
a20[3]=a19[3];
a20[4]=FOOTLLENGLONG*a19[2] - FOOTWIDLONG*a19[3] + a19[4];
a20[5]=-(FOOTLLENGLONG*a19[1]) - LEGLINK4*a19[3] + a19[5];
a20[6]=FOOTWIDLONG*a19[1] + LEGLINK4*a19[2] + a19[6];

a21[1]=a19[1];
a21[2]=a19[2];
a21[3]=a19[3];
a21[4]=FOOTLLENGLONG*a19[2] + FOOTWIDSHORT*a19[3] + a19[4];
a21[5]=-(FOOTLLENGLONG*a19[1]) - LEGLINK4*a19[3] + a19[5];
a21[6]=-(FOOTWIDSHORT*a19[1]) + LEGLINK4*a19[2] + a19[6];

a22[1]=a19[1];
a22[2]=a19[2];
a22[3]=a19[3];
a22[4]=-(FOOTLENGSHORT*a19[2]) + FOOTWIDSHORT*a19[3] + a19[4];
a22[5]=FOOTLENGSHORT*a19[1] - LEGLINK4*a19[3] + a19[5];
a22[6]=-(FOOTWIDSHORT*a19[1]) + LEGLINK4*a19[2] + a19[6];

a23[1]=a19[1];
a23[2]=a19[2];
a23[3]=a19[3];
a23[4]=-(FOOTLENGSHORT*a19[2]) - FOOTWIDLONG*a19[3] + a19[4];
a23[5]=FOOTLENGSHORT*a19[1] - LEGLINK4*a19[3] + a19[5];
a23[6]=FOOTWIDLONG*a19[1] + LEGLINK4*a19[2] + a19[6];

a24[1]=a19[1]*S2419[1][1] + a19[2]*S2419[1][2] + a19[3]*S2419[1][3];
a24[2]=a19[1]*S2419[2][1] + a19[2]*S2419[2][2] + a19[3]*S2419[2][3];
a24[3]=a19[1]*S2419[3][1] + a19[2]*S2419[3][2] + a19[3]*S2419[3][3];
a24[4]=a19[4]*S2419[1][1] + a19[5]*S2419[1][2] + a19[3]*(-(eff[2].x[2]*S2419[1][1]) + eff[2].x[1]*S2419[1][2]) + a19[6]*S2419[1][3] + a19[2]*(eff[2].x[3]*S2419[1][1] - eff[2].x[1]*S2419[1][3]) + a19[1]*(-(eff[2].x[3]*S2419[1][2]) + eff[2].x[2]*S2419[1][3]);
a24[5]=a19[4]*S2419[2][1] + a19[5]*S2419[2][2] + a19[3]*(-(eff[2].x[2]*S2419[2][1]) + eff[2].x[1]*S2419[2][2]) + a19[6]*S2419[2][3] + a19[2]*(eff[2].x[3]*S2419[2][1] - eff[2].x[1]*S2419[2][3]) + a19[1]*(-(eff[2].x[3]*S2419[2][2]) + eff[2].x[2]*S2419[2][3]);
a24[6]=a19[4]*S2419[3][1] + a19[5]*S2419[3][2] + a19[3]*(-(eff[2].x[2]*S2419[3][1]) + eff[2].x[1]*S2419[3][2]) + a19[6]*S2419[3][3] + a19[2]*(eff[2].x[3]*S2419[3][1] - eff[2].x[1]*S2419[3][3]) + a19[1]*(-(eff[2].x[3]*S2419[3][2]) + eff[2].x[2]*S2419[3][3]);



}


void
hoap3_InvDynNEfunc6(void)
     {
/* net forces and external forces for each joint */
fnet0[1]=links[0].m*a0[4] - a0[3]*links[0].mcm[2] + a0[2]*links[0].mcm[3] - links[0].mcm[1]*Power(v0[2],2) - links[0].mcm[1]*Power(v0[3],2) + v0[1]*(links[0].mcm[2]*v0[2] + links[0].mcm[3]*v0[3]) - links[0].m*v0[3]*v0[5] + links[0].m*v0[2]*v0[6];
fnet0[2]=links[0].m*a0[5] + a0[3]*links[0].mcm[1] - a0[1]*links[0].mcm[3] - links[0].mcm[2]*Power(v0[1],2) - links[0].mcm[2]*Power(v0[3],2) + v0[2]*(links[0].mcm[1]*v0[1] + links[0].mcm[3]*v0[3]) + links[0].m*v0[3]*v0[4] - links[0].m*v0[1]*v0[6];
fnet0[3]=links[0].m*a0[6] - a0[2]*links[0].mcm[1] + a0[1]*links[0].mcm[2] - links[0].mcm[3]*Power(v0[1],2) - links[0].mcm[3]*Power(v0[2],2) + (links[0].mcm[1]*v0[1] + links[0].mcm[2]*v0[2])*v0[3] - links[0].m*v0[2]*v0[4] + links[0].m*v0[1]*v0[5];
fnet0[4]=a0[6]*links[0].mcm[2] - a0[5]*links[0].mcm[3] + (-(links[0].mcm[2]*v0[2]) - links[0].mcm[3]*v0[3])*v0[4] + (links[0].mcm[1]*v0[3] + links[0].m*v0[5])*v0[6] + v0[5]*(links[0].mcm[1]*v0[2] - links[0].m*v0[6]) + a0[1]*links[0].inertia[1][1] + a0[2]*links[0].inertia[1][2] + a0[3]*links[0].inertia[1][3] + v0[1]*(links[0].mcm[2]*v0[5] + links[0].mcm[3]*v0[6] - v0[3]*links[0].inertia[1][2] + v0[2]*links[0].inertia[1][3]) + v0[2]*(-(links[0].mcm[1]*v0[5]) - v0[3]*links[0].inertia[2][2] + v0[2]*links[0].inertia[2][3]) + v0[3]*(-(links[0].mcm[1]*v0[6]) - v0[3]*links[0].inertia[2][3] + v0[2]*links[0].inertia[3][3]);
fnet0[5]=-(a0[6]*links[0].mcm[1]) + a0[4]*links[0].mcm[3] + (-(links[0].mcm[1]*v0[1]) - links[0].mcm[3]*v0[3])*v0[5] + (links[0].mcm[2]*v0[3] - links[0].m*v0[4])*v0[6] + v0[4]*(links[0].mcm[2]*v0[1] + links[0].m*v0[6]) + a0[1]*links[0].inertia[1][2] + v0[1]*(-(links[0].mcm[2]*v0[4]) + v0[3]*links[0].inertia[1][1] - v0[1]*links[0].inertia[1][3]) + a0[2]*links[0].inertia[2][2] + a0[3]*links[0].inertia[2][3] + v0[2]*(links[0].mcm[1]*v0[4] + links[0].mcm[3]*v0[6] + v0[3]*links[0].inertia[1][2] - v0[1]*links[0].inertia[2][3]) + v0[3]*(-(links[0].mcm[2]*v0[6]) + v0[3]*links[0].inertia[1][3] - v0[1]*links[0].inertia[3][3]);
fnet0[6]=a0[5]*links[0].mcm[1] - a0[4]*links[0].mcm[2] + (links[0].mcm[3]*v0[2] + links[0].m*v0[4])*v0[5] + v0[4]*(links[0].mcm[3]*v0[1] - links[0].m*v0[5]) + (-(links[0].mcm[1]*v0[1]) - links[0].mcm[2]*v0[2])*v0[6] + v0[1]*(-(links[0].mcm[3]*v0[4]) - v0[2]*links[0].inertia[1][1] + v0[1]*links[0].inertia[1][2]) + a0[1]*links[0].inertia[1][3] + v0[2]*(-(links[0].mcm[3]*v0[5]) - v0[2]*links[0].inertia[1][2] + v0[1]*links[0].inertia[2][2]) + a0[2]*links[0].inertia[2][3] + v0[3]*(links[0].mcm[1]*v0[4] + links[0].mcm[2]*v0[5] - v0[2]*links[0].inertia[1][3] + v0[1]*links[0].inertia[2][3]) + a0[3]*links[0].inertia[3][3];

fnet2[1]=links[13].m*a2[4] - a2[3]*links[13].mcm[2] + a2[2]*links[13].mcm[3] - links[13].mcm[1]*Power(v2[2],2) - links[13].mcm[1]*Power(v2[3],2) + v2[1]*(links[13].mcm[2]*v2[2] + links[13].mcm[3]*v2[3]) - links[13].m*v2[3]*v2[5] + links[13].m*v2[2]*v2[6];
fnet2[2]=links[13].m*a2[5] + a2[3]*links[13].mcm[1] - a2[1]*links[13].mcm[3] - links[13].mcm[2]*Power(v2[1],2) - links[13].mcm[2]*Power(v2[3],2) + v2[2]*(links[13].mcm[1]*v2[1] + links[13].mcm[3]*v2[3]) + links[13].m*v2[3]*v2[4] - links[13].m*v2[1]*v2[6];
fnet2[3]=links[13].m*a2[6] - a2[2]*links[13].mcm[1] + a2[1]*links[13].mcm[2] - links[13].mcm[3]*Power(v2[1],2) - links[13].mcm[3]*Power(v2[2],2) + (links[13].mcm[1]*v2[1] + links[13].mcm[2]*v2[2])*v2[3] - links[13].m*v2[2]*v2[4] + links[13].m*v2[1]*v2[5];
fnet2[4]=a2[6]*links[13].mcm[2] - a2[5]*links[13].mcm[3] + (-(links[13].mcm[2]*v2[2]) - links[13].mcm[3]*v2[3])*v2[4] + (links[13].mcm[1]*v2[3] + links[13].m*v2[5])*v2[6] + v2[5]*(links[13].mcm[1]*v2[2] - links[13].m*v2[6]) + a2[1]*links[13].inertia[1][1] + a2[2]*links[13].inertia[1][2] + a2[3]*links[13].inertia[1][3] + v2[1]*(links[13].mcm[2]*v2[5] + links[13].mcm[3]*v2[6] - v2[3]*links[13].inertia[1][2] + v2[2]*links[13].inertia[1][3]) + v2[2]*(-(links[13].mcm[1]*v2[5]) - v2[3]*links[13].inertia[2][2] + v2[2]*links[13].inertia[2][3]) + v2[3]*(-(links[13].mcm[1]*v2[6]) - v2[3]*links[13].inertia[2][3] + v2[2]*links[13].inertia[3][3]);
fnet2[5]=-(a2[6]*links[13].mcm[1]) + a2[4]*links[13].mcm[3] + (-(links[13].mcm[1]*v2[1]) - links[13].mcm[3]*v2[3])*v2[5] + (links[13].mcm[2]*v2[3] - links[13].m*v2[4])*v2[6] + v2[4]*(links[13].mcm[2]*v2[1] + links[13].m*v2[6]) + a2[1]*links[13].inertia[1][2] + v2[1]*(-(links[13].mcm[2]*v2[4]) + v2[3]*links[13].inertia[1][1] - v2[1]*links[13].inertia[1][3]) + a2[2]*links[13].inertia[2][2] + a2[3]*links[13].inertia[2][3] + v2[2]*(links[13].mcm[1]*v2[4] + links[13].mcm[3]*v2[6] + v2[3]*links[13].inertia[1][2] - v2[1]*links[13].inertia[2][3]) + v2[3]*(-(links[13].mcm[2]*v2[6]) + v2[3]*links[13].inertia[1][3] - v2[1]*links[13].inertia[3][3]);
fnet2[6]=a2[5]*links[13].mcm[1] - a2[4]*links[13].mcm[2] + (links[13].mcm[3]*v2[2] + links[13].m*v2[4])*v2[5] + v2[4]*(links[13].mcm[3]*v2[1] - links[13].m*v2[5]) + (-(links[13].mcm[1]*v2[1]) - links[13].mcm[2]*v2[2])*v2[6] + v2[1]*(-(links[13].mcm[3]*v2[4]) - v2[2]*links[13].inertia[1][1] + v2[1]*links[13].inertia[1][2]) + a2[1]*links[13].inertia[1][3] + v2[2]*(-(links[13].mcm[3]*v2[5]) - v2[2]*links[13].inertia[1][2] + v2[1]*links[13].inertia[2][2]) + a2[2]*links[13].inertia[2][3] + v2[3]*(links[13].mcm[1]*v2[4] + links[13].mcm[2]*v2[5] - v2[2]*links[13].inertia[1][3] + v2[1]*links[13].inertia[2][3]) + a2[3]*links[13].inertia[3][3];

fnet3[1]=links[1].m*a3[4] - a3[3]*links[1].mcm[2] + a3[2]*links[1].mcm[3] - links[1].mcm[1]*Power(v3[2],2) - links[1].mcm[1]*Power(v3[3],2) + v3[1]*(links[1].mcm[2]*v3[2] + links[1].mcm[3]*v3[3]) - links[1].m*v3[3]*v3[5] + links[1].m*v3[2]*v3[6];
fnet3[2]=links[1].m*a3[5] + a3[3]*links[1].mcm[1] - a3[1]*links[1].mcm[3] - links[1].mcm[2]*Power(v3[1],2) - links[1].mcm[2]*Power(v3[3],2) + v3[2]*(links[1].mcm[1]*v3[1] + links[1].mcm[3]*v3[3]) + links[1].m*v3[3]*v3[4] - links[1].m*v3[1]*v3[6];
fnet3[3]=links[1].m*a3[6] - a3[2]*links[1].mcm[1] + a3[1]*links[1].mcm[2] - links[1].mcm[3]*Power(v3[1],2) - links[1].mcm[3]*Power(v3[2],2) + (links[1].mcm[1]*v3[1] + links[1].mcm[2]*v3[2])*v3[3] - links[1].m*v3[2]*v3[4] + links[1].m*v3[1]*v3[5];
fnet3[4]=a3[6]*links[1].mcm[2] - a3[5]*links[1].mcm[3] + (-(links[1].mcm[2]*v3[2]) - links[1].mcm[3]*v3[3])*v3[4] + (links[1].mcm[1]*v3[3] + links[1].m*v3[5])*v3[6] + v3[5]*(links[1].mcm[1]*v3[2] - links[1].m*v3[6]) + a3[1]*links[1].inertia[1][1] + a3[2]*links[1].inertia[1][2] + a3[3]*links[1].inertia[1][3] + v3[1]*(links[1].mcm[2]*v3[5] + links[1].mcm[3]*v3[6] - v3[3]*links[1].inertia[1][2] + v3[2]*links[1].inertia[1][3]) + v3[2]*(-(links[1].mcm[1]*v3[5]) - v3[3]*links[1].inertia[2][2] + v3[2]*links[1].inertia[2][3]) + v3[3]*(-(links[1].mcm[1]*v3[6]) - v3[3]*links[1].inertia[2][3] + v3[2]*links[1].inertia[3][3]);
fnet3[5]=-(a3[6]*links[1].mcm[1]) + a3[4]*links[1].mcm[3] + (-(links[1].mcm[1]*v3[1]) - links[1].mcm[3]*v3[3])*v3[5] + (links[1].mcm[2]*v3[3] - links[1].m*v3[4])*v3[6] + v3[4]*(links[1].mcm[2]*v3[1] + links[1].m*v3[6]) + a3[1]*links[1].inertia[1][2] + v3[1]*(-(links[1].mcm[2]*v3[4]) + v3[3]*links[1].inertia[1][1] - v3[1]*links[1].inertia[1][3]) + a3[2]*links[1].inertia[2][2] + a3[3]*links[1].inertia[2][3] + v3[2]*(links[1].mcm[1]*v3[4] + links[1].mcm[3]*v3[6] + v3[3]*links[1].inertia[1][2] - v3[1]*links[1].inertia[2][3]) + v3[3]*(-(links[1].mcm[2]*v3[6]) + v3[3]*links[1].inertia[1][3] - v3[1]*links[1].inertia[3][3]);
fnet3[6]=a3[5]*links[1].mcm[1] - a3[4]*links[1].mcm[2] + (links[1].mcm[3]*v3[2] + links[1].m*v3[4])*v3[5] + v3[4]*(links[1].mcm[3]*v3[1] - links[1].m*v3[5]) + (-(links[1].mcm[1]*v3[1]) - links[1].mcm[2]*v3[2])*v3[6] + v3[1]*(-(links[1].mcm[3]*v3[4]) - v3[2]*links[1].inertia[1][1] + v3[1]*links[1].inertia[1][2]) + a3[1]*links[1].inertia[1][3] + v3[2]*(-(links[1].mcm[3]*v3[5]) - v3[2]*links[1].inertia[1][2] + v3[1]*links[1].inertia[2][2]) + a3[2]*links[1].inertia[2][3] + v3[3]*(links[1].mcm[1]*v3[4] + links[1].mcm[2]*v3[5] - v3[2]*links[1].inertia[1][3] + v3[1]*links[1].inertia[2][3]) + a3[3]*links[1].inertia[3][3];

fnet4[1]=links[2].m*a4[4] - a4[3]*links[2].mcm[2] + a4[2]*links[2].mcm[3] - links[2].mcm[1]*Power(v4[2],2) - links[2].mcm[1]*Power(v4[3],2) + v4[1]*(links[2].mcm[2]*v4[2] + links[2].mcm[3]*v4[3]) - links[2].m*v4[3]*v4[5] + links[2].m*v4[2]*v4[6];
fnet4[2]=links[2].m*a4[5] + a4[3]*links[2].mcm[1] - a4[1]*links[2].mcm[3] - links[2].mcm[2]*Power(v4[1],2) - links[2].mcm[2]*Power(v4[3],2) + v4[2]*(links[2].mcm[1]*v4[1] + links[2].mcm[3]*v4[3]) + links[2].m*v4[3]*v4[4] - links[2].m*v4[1]*v4[6];
fnet4[3]=links[2].m*a4[6] - a4[2]*links[2].mcm[1] + a4[1]*links[2].mcm[2] - links[2].mcm[3]*Power(v4[1],2) - links[2].mcm[3]*Power(v4[2],2) + (links[2].mcm[1]*v4[1] + links[2].mcm[2]*v4[2])*v4[3] - links[2].m*v4[2]*v4[4] + links[2].m*v4[1]*v4[5];
fnet4[4]=a4[6]*links[2].mcm[2] - a4[5]*links[2].mcm[3] + (-(links[2].mcm[2]*v4[2]) - links[2].mcm[3]*v4[3])*v4[4] + (links[2].mcm[1]*v4[3] + links[2].m*v4[5])*v4[6] + v4[5]*(links[2].mcm[1]*v4[2] - links[2].m*v4[6]) + a4[1]*links[2].inertia[1][1] + a4[2]*links[2].inertia[1][2] + a4[3]*links[2].inertia[1][3] + v4[1]*(links[2].mcm[2]*v4[5] + links[2].mcm[3]*v4[6] - v4[3]*links[2].inertia[1][2] + v4[2]*links[2].inertia[1][3]) + v4[2]*(-(links[2].mcm[1]*v4[5]) - v4[3]*links[2].inertia[2][2] + v4[2]*links[2].inertia[2][3]) + v4[3]*(-(links[2].mcm[1]*v4[6]) - v4[3]*links[2].inertia[2][3] + v4[2]*links[2].inertia[3][3]);
fnet4[5]=-(a4[6]*links[2].mcm[1]) + a4[4]*links[2].mcm[3] + (-(links[2].mcm[1]*v4[1]) - links[2].mcm[3]*v4[3])*v4[5] + (links[2].mcm[2]*v4[3] - links[2].m*v4[4])*v4[6] + v4[4]*(links[2].mcm[2]*v4[1] + links[2].m*v4[6]) + a4[1]*links[2].inertia[1][2] + v4[1]*(-(links[2].mcm[2]*v4[4]) + v4[3]*links[2].inertia[1][1] - v4[1]*links[2].inertia[1][3]) + a4[2]*links[2].inertia[2][2] + a4[3]*links[2].inertia[2][3] + v4[2]*(links[2].mcm[1]*v4[4] + links[2].mcm[3]*v4[6] + v4[3]*links[2].inertia[1][2] - v4[1]*links[2].inertia[2][3]) + v4[3]*(-(links[2].mcm[2]*v4[6]) + v4[3]*links[2].inertia[1][3] - v4[1]*links[2].inertia[3][3]);
fnet4[6]=a4[5]*links[2].mcm[1] - a4[4]*links[2].mcm[2] + (links[2].mcm[3]*v4[2] + links[2].m*v4[4])*v4[5] + v4[4]*(links[2].mcm[3]*v4[1] - links[2].m*v4[5]) + (-(links[2].mcm[1]*v4[1]) - links[2].mcm[2]*v4[2])*v4[6] + v4[1]*(-(links[2].mcm[3]*v4[4]) - v4[2]*links[2].inertia[1][1] + v4[1]*links[2].inertia[1][2]) + a4[1]*links[2].inertia[1][3] + v4[2]*(-(links[2].mcm[3]*v4[5]) - v4[2]*links[2].inertia[1][2] + v4[1]*links[2].inertia[2][2]) + a4[2]*links[2].inertia[2][3] + v4[3]*(links[2].mcm[1]*v4[4] + links[2].mcm[2]*v4[5] - v4[2]*links[2].inertia[1][3] + v4[1]*links[2].inertia[2][3]) + a4[3]*links[2].inertia[3][3];

fnet5[1]=links[3].m*a5[4] - a5[3]*links[3].mcm[2] + a5[2]*links[3].mcm[3] - links[3].mcm[1]*Power(v5[2],2) - links[3].mcm[1]*Power(v5[3],2) + v5[1]*(links[3].mcm[2]*v5[2] + links[3].mcm[3]*v5[3]) - links[3].m*v5[3]*v5[5] + links[3].m*v5[2]*v5[6];
fnet5[2]=links[3].m*a5[5] + a5[3]*links[3].mcm[1] - a5[1]*links[3].mcm[3] - links[3].mcm[2]*Power(v5[1],2) - links[3].mcm[2]*Power(v5[3],2) + v5[2]*(links[3].mcm[1]*v5[1] + links[3].mcm[3]*v5[3]) + links[3].m*v5[3]*v5[4] - links[3].m*v5[1]*v5[6];
fnet5[3]=links[3].m*a5[6] - a5[2]*links[3].mcm[1] + a5[1]*links[3].mcm[2] - links[3].mcm[3]*Power(v5[1],2) - links[3].mcm[3]*Power(v5[2],2) + (links[3].mcm[1]*v5[1] + links[3].mcm[2]*v5[2])*v5[3] - links[3].m*v5[2]*v5[4] + links[3].m*v5[1]*v5[5];
fnet5[4]=a5[6]*links[3].mcm[2] - a5[5]*links[3].mcm[3] + (-(links[3].mcm[2]*v5[2]) - links[3].mcm[3]*v5[3])*v5[4] + (links[3].mcm[1]*v5[3] + links[3].m*v5[5])*v5[6] + v5[5]*(links[3].mcm[1]*v5[2] - links[3].m*v5[6]) + a5[1]*links[3].inertia[1][1] + a5[2]*links[3].inertia[1][2] + a5[3]*links[3].inertia[1][3] + v5[1]*(links[3].mcm[2]*v5[5] + links[3].mcm[3]*v5[6] - v5[3]*links[3].inertia[1][2] + v5[2]*links[3].inertia[1][3]) + v5[2]*(-(links[3].mcm[1]*v5[5]) - v5[3]*links[3].inertia[2][2] + v5[2]*links[3].inertia[2][3]) + v5[3]*(-(links[3].mcm[1]*v5[6]) - v5[3]*links[3].inertia[2][3] + v5[2]*links[3].inertia[3][3]);
fnet5[5]=-(a5[6]*links[3].mcm[1]) + a5[4]*links[3].mcm[3] + (-(links[3].mcm[1]*v5[1]) - links[3].mcm[3]*v5[3])*v5[5] + (links[3].mcm[2]*v5[3] - links[3].m*v5[4])*v5[6] + v5[4]*(links[3].mcm[2]*v5[1] + links[3].m*v5[6]) + a5[1]*links[3].inertia[1][2] + v5[1]*(-(links[3].mcm[2]*v5[4]) + v5[3]*links[3].inertia[1][1] - v5[1]*links[3].inertia[1][3]) + a5[2]*links[3].inertia[2][2] + a5[3]*links[3].inertia[2][3] + v5[2]*(links[3].mcm[1]*v5[4] + links[3].mcm[3]*v5[6] + v5[3]*links[3].inertia[1][2] - v5[1]*links[3].inertia[2][3]) + v5[3]*(-(links[3].mcm[2]*v5[6]) + v5[3]*links[3].inertia[1][3] - v5[1]*links[3].inertia[3][3]);
fnet5[6]=a5[5]*links[3].mcm[1] - a5[4]*links[3].mcm[2] + (links[3].mcm[3]*v5[2] + links[3].m*v5[4])*v5[5] + v5[4]*(links[3].mcm[3]*v5[1] - links[3].m*v5[5]) + (-(links[3].mcm[1]*v5[1]) - links[3].mcm[2]*v5[2])*v5[6] + v5[1]*(-(links[3].mcm[3]*v5[4]) - v5[2]*links[3].inertia[1][1] + v5[1]*links[3].inertia[1][2]) + a5[1]*links[3].inertia[1][3] + v5[2]*(-(links[3].mcm[3]*v5[5]) - v5[2]*links[3].inertia[1][2] + v5[1]*links[3].inertia[2][2]) + a5[2]*links[3].inertia[2][3] + v5[3]*(links[3].mcm[1]*v5[4] + links[3].mcm[2]*v5[5] - v5[2]*links[3].inertia[1][3] + v5[1]*links[3].inertia[2][3]) + a5[3]*links[3].inertia[3][3];

fnet6[1]=links[4].m*a6[4] - a6[3]*links[4].mcm[2] + a6[2]*links[4].mcm[3] - links[4].mcm[1]*Power(v6[2],2) - links[4].mcm[1]*Power(v6[3],2) + v6[1]*(links[4].mcm[2]*v6[2] + links[4].mcm[3]*v6[3]) - links[4].m*v6[3]*v6[5] + links[4].m*v6[2]*v6[6];
fnet6[2]=links[4].m*a6[5] + a6[3]*links[4].mcm[1] - a6[1]*links[4].mcm[3] - links[4].mcm[2]*Power(v6[1],2) - links[4].mcm[2]*Power(v6[3],2) + v6[2]*(links[4].mcm[1]*v6[1] + links[4].mcm[3]*v6[3]) + links[4].m*v6[3]*v6[4] - links[4].m*v6[1]*v6[6];
fnet6[3]=links[4].m*a6[6] - a6[2]*links[4].mcm[1] + a6[1]*links[4].mcm[2] - links[4].mcm[3]*Power(v6[1],2) - links[4].mcm[3]*Power(v6[2],2) + (links[4].mcm[1]*v6[1] + links[4].mcm[2]*v6[2])*v6[3] - links[4].m*v6[2]*v6[4] + links[4].m*v6[1]*v6[5];
fnet6[4]=a6[6]*links[4].mcm[2] - a6[5]*links[4].mcm[3] + (-(links[4].mcm[2]*v6[2]) - links[4].mcm[3]*v6[3])*v6[4] + (links[4].mcm[1]*v6[3] + links[4].m*v6[5])*v6[6] + v6[5]*(links[4].mcm[1]*v6[2] - links[4].m*v6[6]) + a6[1]*links[4].inertia[1][1] + a6[2]*links[4].inertia[1][2] + a6[3]*links[4].inertia[1][3] + v6[1]*(links[4].mcm[2]*v6[5] + links[4].mcm[3]*v6[6] - v6[3]*links[4].inertia[1][2] + v6[2]*links[4].inertia[1][3]) + v6[2]*(-(links[4].mcm[1]*v6[5]) - v6[3]*links[4].inertia[2][2] + v6[2]*links[4].inertia[2][3]) + v6[3]*(-(links[4].mcm[1]*v6[6]) - v6[3]*links[4].inertia[2][3] + v6[2]*links[4].inertia[3][3]);
fnet6[5]=-(a6[6]*links[4].mcm[1]) + a6[4]*links[4].mcm[3] + (-(links[4].mcm[1]*v6[1]) - links[4].mcm[3]*v6[3])*v6[5] + (links[4].mcm[2]*v6[3] - links[4].m*v6[4])*v6[6] + v6[4]*(links[4].mcm[2]*v6[1] + links[4].m*v6[6]) + a6[1]*links[4].inertia[1][2] + v6[1]*(-(links[4].mcm[2]*v6[4]) + v6[3]*links[4].inertia[1][1] - v6[1]*links[4].inertia[1][3]) + a6[2]*links[4].inertia[2][2] + a6[3]*links[4].inertia[2][3] + v6[2]*(links[4].mcm[1]*v6[4] + links[4].mcm[3]*v6[6] + v6[3]*links[4].inertia[1][2] - v6[1]*links[4].inertia[2][3]) + v6[3]*(-(links[4].mcm[2]*v6[6]) + v6[3]*links[4].inertia[1][3] - v6[1]*links[4].inertia[3][3]);
fnet6[6]=a6[5]*links[4].mcm[1] - a6[4]*links[4].mcm[2] + (links[4].mcm[3]*v6[2] + links[4].m*v6[4])*v6[5] + v6[4]*(links[4].mcm[3]*v6[1] - links[4].m*v6[5]) + (-(links[4].mcm[1]*v6[1]) - links[4].mcm[2]*v6[2])*v6[6] + v6[1]*(-(links[4].mcm[3]*v6[4]) - v6[2]*links[4].inertia[1][1] + v6[1]*links[4].inertia[1][2]) + a6[1]*links[4].inertia[1][3] + v6[2]*(-(links[4].mcm[3]*v6[5]) - v6[2]*links[4].inertia[1][2] + v6[1]*links[4].inertia[2][2]) + a6[2]*links[4].inertia[2][3] + v6[3]*(links[4].mcm[1]*v6[4] + links[4].mcm[2]*v6[5] - v6[2]*links[4].inertia[1][3] + v6[1]*links[4].inertia[2][3]) + a6[3]*links[4].inertia[3][3];

fnet7[1]=links[5].m*a7[4] - a7[3]*links[5].mcm[2] + a7[2]*links[5].mcm[3] - links[5].mcm[1]*Power(v7[2],2) - links[5].mcm[1]*Power(v7[3],2) + v7[1]*(links[5].mcm[2]*v7[2] + links[5].mcm[3]*v7[3]) - links[5].m*v7[3]*v7[5] + links[5].m*v7[2]*v7[6];
fnet7[2]=links[5].m*a7[5] + a7[3]*links[5].mcm[1] - a7[1]*links[5].mcm[3] - links[5].mcm[2]*Power(v7[1],2) - links[5].mcm[2]*Power(v7[3],2) + v7[2]*(links[5].mcm[1]*v7[1] + links[5].mcm[3]*v7[3]) + links[5].m*v7[3]*v7[4] - links[5].m*v7[1]*v7[6];
fnet7[3]=links[5].m*a7[6] - a7[2]*links[5].mcm[1] + a7[1]*links[5].mcm[2] - links[5].mcm[3]*Power(v7[1],2) - links[5].mcm[3]*Power(v7[2],2) + (links[5].mcm[1]*v7[1] + links[5].mcm[2]*v7[2])*v7[3] - links[5].m*v7[2]*v7[4] + links[5].m*v7[1]*v7[5];
fnet7[4]=a7[6]*links[5].mcm[2] - a7[5]*links[5].mcm[3] + (-(links[5].mcm[2]*v7[2]) - links[5].mcm[3]*v7[3])*v7[4] + (links[5].mcm[1]*v7[3] + links[5].m*v7[5])*v7[6] + v7[5]*(links[5].mcm[1]*v7[2] - links[5].m*v7[6]) + a7[1]*links[5].inertia[1][1] + a7[2]*links[5].inertia[1][2] + a7[3]*links[5].inertia[1][3] + v7[1]*(links[5].mcm[2]*v7[5] + links[5].mcm[3]*v7[6] - v7[3]*links[5].inertia[1][2] + v7[2]*links[5].inertia[1][3]) + v7[2]*(-(links[5].mcm[1]*v7[5]) - v7[3]*links[5].inertia[2][2] + v7[2]*links[5].inertia[2][3]) + v7[3]*(-(links[5].mcm[1]*v7[6]) - v7[3]*links[5].inertia[2][3] + v7[2]*links[5].inertia[3][3]);
fnet7[5]=-(a7[6]*links[5].mcm[1]) + a7[4]*links[5].mcm[3] + (-(links[5].mcm[1]*v7[1]) - links[5].mcm[3]*v7[3])*v7[5] + (links[5].mcm[2]*v7[3] - links[5].m*v7[4])*v7[6] + v7[4]*(links[5].mcm[2]*v7[1] + links[5].m*v7[6]) + a7[1]*links[5].inertia[1][2] + v7[1]*(-(links[5].mcm[2]*v7[4]) + v7[3]*links[5].inertia[1][1] - v7[1]*links[5].inertia[1][3]) + a7[2]*links[5].inertia[2][2] + a7[3]*links[5].inertia[2][3] + v7[2]*(links[5].mcm[1]*v7[4] + links[5].mcm[3]*v7[6] + v7[3]*links[5].inertia[1][2] - v7[1]*links[5].inertia[2][3]) + v7[3]*(-(links[5].mcm[2]*v7[6]) + v7[3]*links[5].inertia[1][3] - v7[1]*links[5].inertia[3][3]);
fnet7[6]=a7[5]*links[5].mcm[1] - a7[4]*links[5].mcm[2] + (links[5].mcm[3]*v7[2] + links[5].m*v7[4])*v7[5] + v7[4]*(links[5].mcm[3]*v7[1] - links[5].m*v7[5]) + (-(links[5].mcm[1]*v7[1]) - links[5].mcm[2]*v7[2])*v7[6] + v7[1]*(-(links[5].mcm[3]*v7[4]) - v7[2]*links[5].inertia[1][1] + v7[1]*links[5].inertia[1][2]) + a7[1]*links[5].inertia[1][3] + v7[2]*(-(links[5].mcm[3]*v7[5]) - v7[2]*links[5].inertia[1][2] + v7[1]*links[5].inertia[2][2]) + a7[2]*links[5].inertia[2][3] + v7[3]*(links[5].mcm[1]*v7[4] + links[5].mcm[2]*v7[5] - v7[2]*links[5].inertia[1][3] + v7[1]*links[5].inertia[2][3]) + a7[3]*links[5].inertia[3][3];

fnet8[1]=links[6].m*a8[4] - a8[3]*links[6].mcm[2] + a8[2]*links[6].mcm[3] - links[6].mcm[1]*Power(v8[2],2) - links[6].mcm[1]*Power(v8[3],2) + v8[1]*(links[6].mcm[2]*v8[2] + links[6].mcm[3]*v8[3]) - links[6].m*v8[3]*v8[5] + links[6].m*v8[2]*v8[6];
fnet8[2]=links[6].m*a8[5] + a8[3]*links[6].mcm[1] - a8[1]*links[6].mcm[3] - links[6].mcm[2]*Power(v8[1],2) - links[6].mcm[2]*Power(v8[3],2) + v8[2]*(links[6].mcm[1]*v8[1] + links[6].mcm[3]*v8[3]) + links[6].m*v8[3]*v8[4] - links[6].m*v8[1]*v8[6];
fnet8[3]=links[6].m*a8[6] - a8[2]*links[6].mcm[1] + a8[1]*links[6].mcm[2] - links[6].mcm[3]*Power(v8[1],2) - links[6].mcm[3]*Power(v8[2],2) + (links[6].mcm[1]*v8[1] + links[6].mcm[2]*v8[2])*v8[3] - links[6].m*v8[2]*v8[4] + links[6].m*v8[1]*v8[5];
fnet8[4]=a8[6]*links[6].mcm[2] - a8[5]*links[6].mcm[3] + (-(links[6].mcm[2]*v8[2]) - links[6].mcm[3]*v8[3])*v8[4] + (links[6].mcm[1]*v8[3] + links[6].m*v8[5])*v8[6] + v8[5]*(links[6].mcm[1]*v8[2] - links[6].m*v8[6]) + a8[1]*links[6].inertia[1][1] + a8[2]*links[6].inertia[1][2] + a8[3]*links[6].inertia[1][3] + v8[1]*(links[6].mcm[2]*v8[5] + links[6].mcm[3]*v8[6] - v8[3]*links[6].inertia[1][2] + v8[2]*links[6].inertia[1][3]) + v8[2]*(-(links[6].mcm[1]*v8[5]) - v8[3]*links[6].inertia[2][2] + v8[2]*links[6].inertia[2][3]) + v8[3]*(-(links[6].mcm[1]*v8[6]) - v8[3]*links[6].inertia[2][3] + v8[2]*links[6].inertia[3][3]);
fnet8[5]=-(a8[6]*links[6].mcm[1]) + a8[4]*links[6].mcm[3] + (-(links[6].mcm[1]*v8[1]) - links[6].mcm[3]*v8[3])*v8[5] + (links[6].mcm[2]*v8[3] - links[6].m*v8[4])*v8[6] + v8[4]*(links[6].mcm[2]*v8[1] + links[6].m*v8[6]) + a8[1]*links[6].inertia[1][2] + v8[1]*(-(links[6].mcm[2]*v8[4]) + v8[3]*links[6].inertia[1][1] - v8[1]*links[6].inertia[1][3]) + a8[2]*links[6].inertia[2][2] + a8[3]*links[6].inertia[2][3] + v8[2]*(links[6].mcm[1]*v8[4] + links[6].mcm[3]*v8[6] + v8[3]*links[6].inertia[1][2] - v8[1]*links[6].inertia[2][3]) + v8[3]*(-(links[6].mcm[2]*v8[6]) + v8[3]*links[6].inertia[1][3] - v8[1]*links[6].inertia[3][3]);
fnet8[6]=a8[5]*links[6].mcm[1] - a8[4]*links[6].mcm[2] + (links[6].mcm[3]*v8[2] + links[6].m*v8[4])*v8[5] + v8[4]*(links[6].mcm[3]*v8[1] - links[6].m*v8[5]) + (-(links[6].mcm[1]*v8[1]) - links[6].mcm[2]*v8[2])*v8[6] + v8[1]*(-(links[6].mcm[3]*v8[4]) - v8[2]*links[6].inertia[1][1] + v8[1]*links[6].inertia[1][2]) + a8[1]*links[6].inertia[1][3] + v8[2]*(-(links[6].mcm[3]*v8[5]) - v8[2]*links[6].inertia[1][2] + v8[1]*links[6].inertia[2][2]) + a8[2]*links[6].inertia[2][3] + v8[3]*(links[6].mcm[1]*v8[4] + links[6].mcm[2]*v8[5] - v8[2]*links[6].inertia[1][3] + v8[1]*links[6].inertia[2][3]) + a8[3]*links[6].inertia[3][3];

fnet13[1]=eff[1].m*a13[4] - a13[3]*eff[1].mcm[2] + a13[2]*eff[1].mcm[3] - eff[1].mcm[1]*Power(v13[2],2) - eff[1].mcm[1]*Power(v13[3],2) + v13[1]*(eff[1].mcm[2]*v13[2] + eff[1].mcm[3]*v13[3]) - eff[1].m*v13[3]*v13[5] + eff[1].m*v13[2]*v13[6];
fnet13[2]=eff[1].m*a13[5] + a13[3]*eff[1].mcm[1] - a13[1]*eff[1].mcm[3] - eff[1].mcm[2]*Power(v13[1],2) - eff[1].mcm[2]*Power(v13[3],2) + v13[2]*(eff[1].mcm[1]*v13[1] + eff[1].mcm[3]*v13[3]) + eff[1].m*v13[3]*v13[4] - eff[1].m*v13[1]*v13[6];
fnet13[3]=eff[1].m*a13[6] - a13[2]*eff[1].mcm[1] + a13[1]*eff[1].mcm[2] - eff[1].mcm[3]*Power(v13[1],2) - eff[1].mcm[3]*Power(v13[2],2) + (eff[1].mcm[1]*v13[1] + eff[1].mcm[2]*v13[2])*v13[3] - eff[1].m*v13[2]*v13[4] + eff[1].m*v13[1]*v13[5];
fnet13[4]=a13[6]*eff[1].mcm[2] - a13[5]*eff[1].mcm[3] + (-(eff[1].mcm[2]*v13[2]) - eff[1].mcm[3]*v13[3])*v13[4] - eff[1].mcm[1]*v13[2]*v13[5] - eff[1].mcm[1]*v13[3]*v13[6] + (eff[1].mcm[1]*v13[3] + eff[1].m*v13[5])*v13[6] + v13[5]*(eff[1].mcm[1]*v13[2] - eff[1].m*v13[6]) + v13[1]*(eff[1].mcm[2]*v13[5] + eff[1].mcm[3]*v13[6]);
fnet13[5]=-(a13[6]*eff[1].mcm[1]) + a13[4]*eff[1].mcm[3] - eff[1].mcm[2]*v13[1]*v13[4] + (-(eff[1].mcm[1]*v13[1]) - eff[1].mcm[3]*v13[3])*v13[5] - eff[1].mcm[2]*v13[3]*v13[6] + (eff[1].mcm[2]*v13[3] - eff[1].m*v13[4])*v13[6] + v13[4]*(eff[1].mcm[2]*v13[1] + eff[1].m*v13[6]) + v13[2]*(eff[1].mcm[1]*v13[4] + eff[1].mcm[3]*v13[6]);
fnet13[6]=a13[5]*eff[1].mcm[1] - a13[4]*eff[1].mcm[2] - eff[1].mcm[3]*v13[1]*v13[4] - eff[1].mcm[3]*v13[2]*v13[5] + (eff[1].mcm[3]*v13[2] + eff[1].m*v13[4])*v13[5] + v13[4]*(eff[1].mcm[3]*v13[1] - eff[1].m*v13[5]) + v13[3]*(eff[1].mcm[1]*v13[4] + eff[1].mcm[2]*v13[5]) + (-(eff[1].mcm[1]*v13[1]) - eff[1].mcm[2]*v13[2])*v13[6];

fnet14[1]=links[7].m*a14[4] - a14[3]*links[7].mcm[2] + a14[2]*links[7].mcm[3] - links[7].mcm[1]*Power(v14[2],2) - links[7].mcm[1]*Power(v14[3],2) + v14[1]*(links[7].mcm[2]*v14[2] + links[7].mcm[3]*v14[3]) - links[7].m*v14[3]*v14[5] + links[7].m*v14[2]*v14[6];
fnet14[2]=links[7].m*a14[5] + a14[3]*links[7].mcm[1] - a14[1]*links[7].mcm[3] - links[7].mcm[2]*Power(v14[1],2) - links[7].mcm[2]*Power(v14[3],2) + v14[2]*(links[7].mcm[1]*v14[1] + links[7].mcm[3]*v14[3]) + links[7].m*v14[3]*v14[4] - links[7].m*v14[1]*v14[6];
fnet14[3]=links[7].m*a14[6] - a14[2]*links[7].mcm[1] + a14[1]*links[7].mcm[2] - links[7].mcm[3]*Power(v14[1],2) - links[7].mcm[3]*Power(v14[2],2) + (links[7].mcm[1]*v14[1] + links[7].mcm[2]*v14[2])*v14[3] - links[7].m*v14[2]*v14[4] + links[7].m*v14[1]*v14[5];
fnet14[4]=a14[6]*links[7].mcm[2] - a14[5]*links[7].mcm[3] + (-(links[7].mcm[2]*v14[2]) - links[7].mcm[3]*v14[3])*v14[4] + (links[7].mcm[1]*v14[3] + links[7].m*v14[5])*v14[6] + v14[5]*(links[7].mcm[1]*v14[2] - links[7].m*v14[6]) + a14[1]*links[7].inertia[1][1] + a14[2]*links[7].inertia[1][2] + a14[3]*links[7].inertia[1][3] + v14[1]*(links[7].mcm[2]*v14[5] + links[7].mcm[3]*v14[6] - v14[3]*links[7].inertia[1][2] + v14[2]*links[7].inertia[1][3]) + v14[2]*(-(links[7].mcm[1]*v14[5]) - v14[3]*links[7].inertia[2][2] + v14[2]*links[7].inertia[2][3]) + v14[3]*(-(links[7].mcm[1]*v14[6]) - v14[3]*links[7].inertia[2][3] + v14[2]*links[7].inertia[3][3]);
fnet14[5]=-(a14[6]*links[7].mcm[1]) + a14[4]*links[7].mcm[3] + (-(links[7].mcm[1]*v14[1]) - links[7].mcm[3]*v14[3])*v14[5] + (links[7].mcm[2]*v14[3] - links[7].m*v14[4])*v14[6] + v14[4]*(links[7].mcm[2]*v14[1] + links[7].m*v14[6]) + a14[1]*links[7].inertia[1][2] + v14[1]*(-(links[7].mcm[2]*v14[4]) + v14[3]*links[7].inertia[1][1] - v14[1]*links[7].inertia[1][3]) + a14[2]*links[7].inertia[2][2] + a14[3]*links[7].inertia[2][3] + v14[2]*(links[7].mcm[1]*v14[4] + links[7].mcm[3]*v14[6] + v14[3]*links[7].inertia[1][2] - v14[1]*links[7].inertia[2][3]) + v14[3]*(-(links[7].mcm[2]*v14[6]) + v14[3]*links[7].inertia[1][3] - v14[1]*links[7].inertia[3][3]);
fnet14[6]=a14[5]*links[7].mcm[1] - a14[4]*links[7].mcm[2] + (links[7].mcm[3]*v14[2] + links[7].m*v14[4])*v14[5] + v14[4]*(links[7].mcm[3]*v14[1] - links[7].m*v14[5]) + (-(links[7].mcm[1]*v14[1]) - links[7].mcm[2]*v14[2])*v14[6] + v14[1]*(-(links[7].mcm[3]*v14[4]) - v14[2]*links[7].inertia[1][1] + v14[1]*links[7].inertia[1][2]) + a14[1]*links[7].inertia[1][3] + v14[2]*(-(links[7].mcm[3]*v14[5]) - v14[2]*links[7].inertia[1][2] + v14[1]*links[7].inertia[2][2]) + a14[2]*links[7].inertia[2][3] + v14[3]*(links[7].mcm[1]*v14[4] + links[7].mcm[2]*v14[5] - v14[2]*links[7].inertia[1][3] + v14[1]*links[7].inertia[2][3]) + a14[3]*links[7].inertia[3][3];

fnet15[1]=links[8].m*a15[4] - a15[3]*links[8].mcm[2] + a15[2]*links[8].mcm[3] - links[8].mcm[1]*Power(v15[2],2) - links[8].mcm[1]*Power(v15[3],2) + v15[1]*(links[8].mcm[2]*v15[2] + links[8].mcm[3]*v15[3]) - links[8].m*v15[3]*v15[5] + links[8].m*v15[2]*v15[6];
fnet15[2]=links[8].m*a15[5] + a15[3]*links[8].mcm[1] - a15[1]*links[8].mcm[3] - links[8].mcm[2]*Power(v15[1],2) - links[8].mcm[2]*Power(v15[3],2) + v15[2]*(links[8].mcm[1]*v15[1] + links[8].mcm[3]*v15[3]) + links[8].m*v15[3]*v15[4] - links[8].m*v15[1]*v15[6];
fnet15[3]=links[8].m*a15[6] - a15[2]*links[8].mcm[1] + a15[1]*links[8].mcm[2] - links[8].mcm[3]*Power(v15[1],2) - links[8].mcm[3]*Power(v15[2],2) + (links[8].mcm[1]*v15[1] + links[8].mcm[2]*v15[2])*v15[3] - links[8].m*v15[2]*v15[4] + links[8].m*v15[1]*v15[5];
fnet15[4]=a15[6]*links[8].mcm[2] - a15[5]*links[8].mcm[3] + (-(links[8].mcm[2]*v15[2]) - links[8].mcm[3]*v15[3])*v15[4] + (links[8].mcm[1]*v15[3] + links[8].m*v15[5])*v15[6] + v15[5]*(links[8].mcm[1]*v15[2] - links[8].m*v15[6]) + a15[1]*links[8].inertia[1][1] + a15[2]*links[8].inertia[1][2] + a15[3]*links[8].inertia[1][3] + v15[1]*(links[8].mcm[2]*v15[5] + links[8].mcm[3]*v15[6] - v15[3]*links[8].inertia[1][2] + v15[2]*links[8].inertia[1][3]) + v15[2]*(-(links[8].mcm[1]*v15[5]) - v15[3]*links[8].inertia[2][2] + v15[2]*links[8].inertia[2][3]) + v15[3]*(-(links[8].mcm[1]*v15[6]) - v15[3]*links[8].inertia[2][3] + v15[2]*links[8].inertia[3][3]);
fnet15[5]=-(a15[6]*links[8].mcm[1]) + a15[4]*links[8].mcm[3] + (-(links[8].mcm[1]*v15[1]) - links[8].mcm[3]*v15[3])*v15[5] + (links[8].mcm[2]*v15[3] - links[8].m*v15[4])*v15[6] + v15[4]*(links[8].mcm[2]*v15[1] + links[8].m*v15[6]) + a15[1]*links[8].inertia[1][2] + v15[1]*(-(links[8].mcm[2]*v15[4]) + v15[3]*links[8].inertia[1][1] - v15[1]*links[8].inertia[1][3]) + a15[2]*links[8].inertia[2][2] + a15[3]*links[8].inertia[2][3] + v15[2]*(links[8].mcm[1]*v15[4] + links[8].mcm[3]*v15[6] + v15[3]*links[8].inertia[1][2] - v15[1]*links[8].inertia[2][3]) + v15[3]*(-(links[8].mcm[2]*v15[6]) + v15[3]*links[8].inertia[1][3] - v15[1]*links[8].inertia[3][3]);
fnet15[6]=a15[5]*links[8].mcm[1] - a15[4]*links[8].mcm[2] + (links[8].mcm[3]*v15[2] + links[8].m*v15[4])*v15[5] + v15[4]*(links[8].mcm[3]*v15[1] - links[8].m*v15[5]) + (-(links[8].mcm[1]*v15[1]) - links[8].mcm[2]*v15[2])*v15[6] + v15[1]*(-(links[8].mcm[3]*v15[4]) - v15[2]*links[8].inertia[1][1] + v15[1]*links[8].inertia[1][2]) + a15[1]*links[8].inertia[1][3] + v15[2]*(-(links[8].mcm[3]*v15[5]) - v15[2]*links[8].inertia[1][2] + v15[1]*links[8].inertia[2][2]) + a15[2]*links[8].inertia[2][3] + v15[3]*(links[8].mcm[1]*v15[4] + links[8].mcm[2]*v15[5] - v15[2]*links[8].inertia[1][3] + v15[1]*links[8].inertia[2][3]) + a15[3]*links[8].inertia[3][3];

fnet16[1]=links[9].m*a16[4] - a16[3]*links[9].mcm[2] + a16[2]*links[9].mcm[3] - links[9].mcm[1]*Power(v16[2],2) - links[9].mcm[1]*Power(v16[3],2) + v16[1]*(links[9].mcm[2]*v16[2] + links[9].mcm[3]*v16[3]) - links[9].m*v16[3]*v16[5] + links[9].m*v16[2]*v16[6];
fnet16[2]=links[9].m*a16[5] + a16[3]*links[9].mcm[1] - a16[1]*links[9].mcm[3] - links[9].mcm[2]*Power(v16[1],2) - links[9].mcm[2]*Power(v16[3],2) + v16[2]*(links[9].mcm[1]*v16[1] + links[9].mcm[3]*v16[3]) + links[9].m*v16[3]*v16[4] - links[9].m*v16[1]*v16[6];
fnet16[3]=links[9].m*a16[6] - a16[2]*links[9].mcm[1] + a16[1]*links[9].mcm[2] - links[9].mcm[3]*Power(v16[1],2) - links[9].mcm[3]*Power(v16[2],2) + (links[9].mcm[1]*v16[1] + links[9].mcm[2]*v16[2])*v16[3] - links[9].m*v16[2]*v16[4] + links[9].m*v16[1]*v16[5];
fnet16[4]=a16[6]*links[9].mcm[2] - a16[5]*links[9].mcm[3] + (-(links[9].mcm[2]*v16[2]) - links[9].mcm[3]*v16[3])*v16[4] + (links[9].mcm[1]*v16[3] + links[9].m*v16[5])*v16[6] + v16[5]*(links[9].mcm[1]*v16[2] - links[9].m*v16[6]) + a16[1]*links[9].inertia[1][1] + a16[2]*links[9].inertia[1][2] + a16[3]*links[9].inertia[1][3] + v16[1]*(links[9].mcm[2]*v16[5] + links[9].mcm[3]*v16[6] - v16[3]*links[9].inertia[1][2] + v16[2]*links[9].inertia[1][3]) + v16[2]*(-(links[9].mcm[1]*v16[5]) - v16[3]*links[9].inertia[2][2] + v16[2]*links[9].inertia[2][3]) + v16[3]*(-(links[9].mcm[1]*v16[6]) - v16[3]*links[9].inertia[2][3] + v16[2]*links[9].inertia[3][3]);
fnet16[5]=-(a16[6]*links[9].mcm[1]) + a16[4]*links[9].mcm[3] + (-(links[9].mcm[1]*v16[1]) - links[9].mcm[3]*v16[3])*v16[5] + (links[9].mcm[2]*v16[3] - links[9].m*v16[4])*v16[6] + v16[4]*(links[9].mcm[2]*v16[1] + links[9].m*v16[6]) + a16[1]*links[9].inertia[1][2] + v16[1]*(-(links[9].mcm[2]*v16[4]) + v16[3]*links[9].inertia[1][1] - v16[1]*links[9].inertia[1][3]) + a16[2]*links[9].inertia[2][2] + a16[3]*links[9].inertia[2][3] + v16[2]*(links[9].mcm[1]*v16[4] + links[9].mcm[3]*v16[6] + v16[3]*links[9].inertia[1][2] - v16[1]*links[9].inertia[2][3]) + v16[3]*(-(links[9].mcm[2]*v16[6]) + v16[3]*links[9].inertia[1][3] - v16[1]*links[9].inertia[3][3]);
fnet16[6]=a16[5]*links[9].mcm[1] - a16[4]*links[9].mcm[2] + (links[9].mcm[3]*v16[2] + links[9].m*v16[4])*v16[5] + v16[4]*(links[9].mcm[3]*v16[1] - links[9].m*v16[5]) + (-(links[9].mcm[1]*v16[1]) - links[9].mcm[2]*v16[2])*v16[6] + v16[1]*(-(links[9].mcm[3]*v16[4]) - v16[2]*links[9].inertia[1][1] + v16[1]*links[9].inertia[1][2]) + a16[1]*links[9].inertia[1][3] + v16[2]*(-(links[9].mcm[3]*v16[5]) - v16[2]*links[9].inertia[1][2] + v16[1]*links[9].inertia[2][2]) + a16[2]*links[9].inertia[2][3] + v16[3]*(links[9].mcm[1]*v16[4] + links[9].mcm[2]*v16[5] - v16[2]*links[9].inertia[1][3] + v16[1]*links[9].inertia[2][3]) + a16[3]*links[9].inertia[3][3];

fnet17[1]=links[10].m*a17[4] - a17[3]*links[10].mcm[2] + a17[2]*links[10].mcm[3] - links[10].mcm[1]*Power(v17[2],2) - links[10].mcm[1]*Power(v17[3],2) + v17[1]*(links[10].mcm[2]*v17[2] + links[10].mcm[3]*v17[3]) - links[10].m*v17[3]*v17[5] + links[10].m*v17[2]*v17[6];
fnet17[2]=links[10].m*a17[5] + a17[3]*links[10].mcm[1] - a17[1]*links[10].mcm[3] - links[10].mcm[2]*Power(v17[1],2) - links[10].mcm[2]*Power(v17[3],2) + v17[2]*(links[10].mcm[1]*v17[1] + links[10].mcm[3]*v17[3]) + links[10].m*v17[3]*v17[4] - links[10].m*v17[1]*v17[6];
fnet17[3]=links[10].m*a17[6] - a17[2]*links[10].mcm[1] + a17[1]*links[10].mcm[2] - links[10].mcm[3]*Power(v17[1],2) - links[10].mcm[3]*Power(v17[2],2) + (links[10].mcm[1]*v17[1] + links[10].mcm[2]*v17[2])*v17[3] - links[10].m*v17[2]*v17[4] + links[10].m*v17[1]*v17[5];
fnet17[4]=a17[6]*links[10].mcm[2] - a17[5]*links[10].mcm[3] + (-(links[10].mcm[2]*v17[2]) - links[10].mcm[3]*v17[3])*v17[4] + (links[10].mcm[1]*v17[3] + links[10].m*v17[5])*v17[6] + v17[5]*(links[10].mcm[1]*v17[2] - links[10].m*v17[6]) + a17[1]*links[10].inertia[1][1] + a17[2]*links[10].inertia[1][2] + a17[3]*links[10].inertia[1][3] + v17[1]*(links[10].mcm[2]*v17[5] + links[10].mcm[3]*v17[6] - v17[3]*links[10].inertia[1][2] + v17[2]*links[10].inertia[1][3]) + v17[2]*(-(links[10].mcm[1]*v17[5]) - v17[3]*links[10].inertia[2][2] + v17[2]*links[10].inertia[2][3]) + v17[3]*(-(links[10].mcm[1]*v17[6]) - v17[3]*links[10].inertia[2][3] + v17[2]*links[10].inertia[3][3]);
fnet17[5]=-(a17[6]*links[10].mcm[1]) + a17[4]*links[10].mcm[3] + (-(links[10].mcm[1]*v17[1]) - links[10].mcm[3]*v17[3])*v17[5] + (links[10].mcm[2]*v17[3] - links[10].m*v17[4])*v17[6] + v17[4]*(links[10].mcm[2]*v17[1] + links[10].m*v17[6]) + a17[1]*links[10].inertia[1][2] + v17[1]*(-(links[10].mcm[2]*v17[4]) + v17[3]*links[10].inertia[1][1] - v17[1]*links[10].inertia[1][3]) + a17[2]*links[10].inertia[2][2] + a17[3]*links[10].inertia[2][3] + v17[2]*(links[10].mcm[1]*v17[4] + links[10].mcm[3]*v17[6] + v17[3]*links[10].inertia[1][2] - v17[1]*links[10].inertia[2][3]) + v17[3]*(-(links[10].mcm[2]*v17[6]) + v17[3]*links[10].inertia[1][3] - v17[1]*links[10].inertia[3][3]);
fnet17[6]=a17[5]*links[10].mcm[1] - a17[4]*links[10].mcm[2] + (links[10].mcm[3]*v17[2] + links[10].m*v17[4])*v17[5] + v17[4]*(links[10].mcm[3]*v17[1] - links[10].m*v17[5]) + (-(links[10].mcm[1]*v17[1]) - links[10].mcm[2]*v17[2])*v17[6] + v17[1]*(-(links[10].mcm[3]*v17[4]) - v17[2]*links[10].inertia[1][1] + v17[1]*links[10].inertia[1][2]) + a17[1]*links[10].inertia[1][3] + v17[2]*(-(links[10].mcm[3]*v17[5]) - v17[2]*links[10].inertia[1][2] + v17[1]*links[10].inertia[2][2]) + a17[2]*links[10].inertia[2][3] + v17[3]*(links[10].mcm[1]*v17[4] + links[10].mcm[2]*v17[5] - v17[2]*links[10].inertia[1][3] + v17[1]*links[10].inertia[2][3]) + a17[3]*links[10].inertia[3][3];

fnet18[1]=links[11].m*a18[4] - a18[3]*links[11].mcm[2] + a18[2]*links[11].mcm[3] - links[11].mcm[1]*Power(v18[2],2) - links[11].mcm[1]*Power(v18[3],2) + v18[1]*(links[11].mcm[2]*v18[2] + links[11].mcm[3]*v18[3]) - links[11].m*v18[3]*v18[5] + links[11].m*v18[2]*v18[6];
fnet18[2]=links[11].m*a18[5] + a18[3]*links[11].mcm[1] - a18[1]*links[11].mcm[3] - links[11].mcm[2]*Power(v18[1],2) - links[11].mcm[2]*Power(v18[3],2) + v18[2]*(links[11].mcm[1]*v18[1] + links[11].mcm[3]*v18[3]) + links[11].m*v18[3]*v18[4] - links[11].m*v18[1]*v18[6];
fnet18[3]=links[11].m*a18[6] - a18[2]*links[11].mcm[1] + a18[1]*links[11].mcm[2] - links[11].mcm[3]*Power(v18[1],2) - links[11].mcm[3]*Power(v18[2],2) + (links[11].mcm[1]*v18[1] + links[11].mcm[2]*v18[2])*v18[3] - links[11].m*v18[2]*v18[4] + links[11].m*v18[1]*v18[5];
fnet18[4]=a18[6]*links[11].mcm[2] - a18[5]*links[11].mcm[3] + (-(links[11].mcm[2]*v18[2]) - links[11].mcm[3]*v18[3])*v18[4] + (links[11].mcm[1]*v18[3] + links[11].m*v18[5])*v18[6] + v18[5]*(links[11].mcm[1]*v18[2] - links[11].m*v18[6]) + a18[1]*links[11].inertia[1][1] + a18[2]*links[11].inertia[1][2] + a18[3]*links[11].inertia[1][3] + v18[1]*(links[11].mcm[2]*v18[5] + links[11].mcm[3]*v18[6] - v18[3]*links[11].inertia[1][2] + v18[2]*links[11].inertia[1][3]) + v18[2]*(-(links[11].mcm[1]*v18[5]) - v18[3]*links[11].inertia[2][2] + v18[2]*links[11].inertia[2][3]) + v18[3]*(-(links[11].mcm[1]*v18[6]) - v18[3]*links[11].inertia[2][3] + v18[2]*links[11].inertia[3][3]);
fnet18[5]=-(a18[6]*links[11].mcm[1]) + a18[4]*links[11].mcm[3] + (-(links[11].mcm[1]*v18[1]) - links[11].mcm[3]*v18[3])*v18[5] + (links[11].mcm[2]*v18[3] - links[11].m*v18[4])*v18[6] + v18[4]*(links[11].mcm[2]*v18[1] + links[11].m*v18[6]) + a18[1]*links[11].inertia[1][2] + v18[1]*(-(links[11].mcm[2]*v18[4]) + v18[3]*links[11].inertia[1][1] - v18[1]*links[11].inertia[1][3]) + a18[2]*links[11].inertia[2][2] + a18[3]*links[11].inertia[2][3] + v18[2]*(links[11].mcm[1]*v18[4] + links[11].mcm[3]*v18[6] + v18[3]*links[11].inertia[1][2] - v18[1]*links[11].inertia[2][3]) + v18[3]*(-(links[11].mcm[2]*v18[6]) + v18[3]*links[11].inertia[1][3] - v18[1]*links[11].inertia[3][3]);
fnet18[6]=a18[5]*links[11].mcm[1] - a18[4]*links[11].mcm[2] + (links[11].mcm[3]*v18[2] + links[11].m*v18[4])*v18[5] + v18[4]*(links[11].mcm[3]*v18[1] - links[11].m*v18[5]) + (-(links[11].mcm[1]*v18[1]) - links[11].mcm[2]*v18[2])*v18[6] + v18[1]*(-(links[11].mcm[3]*v18[4]) - v18[2]*links[11].inertia[1][1] + v18[1]*links[11].inertia[1][2]) + a18[1]*links[11].inertia[1][3] + v18[2]*(-(links[11].mcm[3]*v18[5]) - v18[2]*links[11].inertia[1][2] + v18[1]*links[11].inertia[2][2]) + a18[2]*links[11].inertia[2][3] + v18[3]*(links[11].mcm[1]*v18[4] + links[11].mcm[2]*v18[5] - v18[2]*links[11].inertia[1][3] + v18[1]*links[11].inertia[2][3]) + a18[3]*links[11].inertia[3][3];

fnet19[1]=links[12].m*a19[4] - a19[3]*links[12].mcm[2] + a19[2]*links[12].mcm[3] - links[12].mcm[1]*Power(v19[2],2) - links[12].mcm[1]*Power(v19[3],2) + v19[1]*(links[12].mcm[2]*v19[2] + links[12].mcm[3]*v19[3]) - links[12].m*v19[3]*v19[5] + links[12].m*v19[2]*v19[6];
fnet19[2]=links[12].m*a19[5] + a19[3]*links[12].mcm[1] - a19[1]*links[12].mcm[3] - links[12].mcm[2]*Power(v19[1],2) - links[12].mcm[2]*Power(v19[3],2) + v19[2]*(links[12].mcm[1]*v19[1] + links[12].mcm[3]*v19[3]) + links[12].m*v19[3]*v19[4] - links[12].m*v19[1]*v19[6];
fnet19[3]=links[12].m*a19[6] - a19[2]*links[12].mcm[1] + a19[1]*links[12].mcm[2] - links[12].mcm[3]*Power(v19[1],2) - links[12].mcm[3]*Power(v19[2],2) + (links[12].mcm[1]*v19[1] + links[12].mcm[2]*v19[2])*v19[3] - links[12].m*v19[2]*v19[4] + links[12].m*v19[1]*v19[5];
fnet19[4]=a19[6]*links[12].mcm[2] - a19[5]*links[12].mcm[3] + (-(links[12].mcm[2]*v19[2]) - links[12].mcm[3]*v19[3])*v19[4] + (links[12].mcm[1]*v19[3] + links[12].m*v19[5])*v19[6] + v19[5]*(links[12].mcm[1]*v19[2] - links[12].m*v19[6]) + a19[1]*links[12].inertia[1][1] + a19[2]*links[12].inertia[1][2] + a19[3]*links[12].inertia[1][3] + v19[1]*(links[12].mcm[2]*v19[5] + links[12].mcm[3]*v19[6] - v19[3]*links[12].inertia[1][2] + v19[2]*links[12].inertia[1][3]) + v19[2]*(-(links[12].mcm[1]*v19[5]) - v19[3]*links[12].inertia[2][2] + v19[2]*links[12].inertia[2][3]) + v19[3]*(-(links[12].mcm[1]*v19[6]) - v19[3]*links[12].inertia[2][3] + v19[2]*links[12].inertia[3][3]);
fnet19[5]=-(a19[6]*links[12].mcm[1]) + a19[4]*links[12].mcm[3] + (-(links[12].mcm[1]*v19[1]) - links[12].mcm[3]*v19[3])*v19[5] + (links[12].mcm[2]*v19[3] - links[12].m*v19[4])*v19[6] + v19[4]*(links[12].mcm[2]*v19[1] + links[12].m*v19[6]) + a19[1]*links[12].inertia[1][2] + v19[1]*(-(links[12].mcm[2]*v19[4]) + v19[3]*links[12].inertia[1][1] - v19[1]*links[12].inertia[1][3]) + a19[2]*links[12].inertia[2][2] + a19[3]*links[12].inertia[2][3] + v19[2]*(links[12].mcm[1]*v19[4] + links[12].mcm[3]*v19[6] + v19[3]*links[12].inertia[1][2] - v19[1]*links[12].inertia[2][3]) + v19[3]*(-(links[12].mcm[2]*v19[6]) + v19[3]*links[12].inertia[1][3] - v19[1]*links[12].inertia[3][3]);
fnet19[6]=a19[5]*links[12].mcm[1] - a19[4]*links[12].mcm[2] + (links[12].mcm[3]*v19[2] + links[12].m*v19[4])*v19[5] + v19[4]*(links[12].mcm[3]*v19[1] - links[12].m*v19[5]) + (-(links[12].mcm[1]*v19[1]) - links[12].mcm[2]*v19[2])*v19[6] + v19[1]*(-(links[12].mcm[3]*v19[4]) - v19[2]*links[12].inertia[1][1] + v19[1]*links[12].inertia[1][2]) + a19[1]*links[12].inertia[1][3] + v19[2]*(-(links[12].mcm[3]*v19[5]) - v19[2]*links[12].inertia[1][2] + v19[1]*links[12].inertia[2][2]) + a19[2]*links[12].inertia[2][3] + v19[3]*(links[12].mcm[1]*v19[4] + links[12].mcm[2]*v19[5] - v19[2]*links[12].inertia[1][3] + v19[1]*links[12].inertia[2][3]) + a19[3]*links[12].inertia[3][3];

fnet24[1]=eff[2].m*a24[4] - a24[3]*eff[2].mcm[2] + a24[2]*eff[2].mcm[3] - eff[2].mcm[1]*Power(v24[2],2) - eff[2].mcm[1]*Power(v24[3],2) + v24[1]*(eff[2].mcm[2]*v24[2] + eff[2].mcm[3]*v24[3]) - eff[2].m*v24[3]*v24[5] + eff[2].m*v24[2]*v24[6];
fnet24[2]=eff[2].m*a24[5] + a24[3]*eff[2].mcm[1] - a24[1]*eff[2].mcm[3] - eff[2].mcm[2]*Power(v24[1],2) - eff[2].mcm[2]*Power(v24[3],2) + v24[2]*(eff[2].mcm[1]*v24[1] + eff[2].mcm[3]*v24[3]) + eff[2].m*v24[3]*v24[4] - eff[2].m*v24[1]*v24[6];
fnet24[3]=eff[2].m*a24[6] - a24[2]*eff[2].mcm[1] + a24[1]*eff[2].mcm[2] - eff[2].mcm[3]*Power(v24[1],2) - eff[2].mcm[3]*Power(v24[2],2) + (eff[2].mcm[1]*v24[1] + eff[2].mcm[2]*v24[2])*v24[3] - eff[2].m*v24[2]*v24[4] + eff[2].m*v24[1]*v24[5];
fnet24[4]=a24[6]*eff[2].mcm[2] - a24[5]*eff[2].mcm[3] + (-(eff[2].mcm[2]*v24[2]) - eff[2].mcm[3]*v24[3])*v24[4] - eff[2].mcm[1]*v24[2]*v24[5] - eff[2].mcm[1]*v24[3]*v24[6] + (eff[2].mcm[1]*v24[3] + eff[2].m*v24[5])*v24[6] + v24[5]*(eff[2].mcm[1]*v24[2] - eff[2].m*v24[6]) + v24[1]*(eff[2].mcm[2]*v24[5] + eff[2].mcm[3]*v24[6]);
fnet24[5]=-(a24[6]*eff[2].mcm[1]) + a24[4]*eff[2].mcm[3] - eff[2].mcm[2]*v24[1]*v24[4] + (-(eff[2].mcm[1]*v24[1]) - eff[2].mcm[3]*v24[3])*v24[5] - eff[2].mcm[2]*v24[3]*v24[6] + (eff[2].mcm[2]*v24[3] - eff[2].m*v24[4])*v24[6] + v24[4]*(eff[2].mcm[2]*v24[1] + eff[2].m*v24[6]) + v24[2]*(eff[2].mcm[1]*v24[4] + eff[2].mcm[3]*v24[6]);
fnet24[6]=a24[5]*eff[2].mcm[1] - a24[4]*eff[2].mcm[2] - eff[2].mcm[3]*v24[1]*v24[4] - eff[2].mcm[3]*v24[2]*v24[5] + (eff[2].mcm[3]*v24[2] + eff[2].m*v24[4])*v24[5] + v24[4]*(eff[2].mcm[3]*v24[1] - eff[2].m*v24[5]) + v24[3]*(eff[2].mcm[1]*v24[4] + eff[2].mcm[2]*v24[5]) + (-(eff[2].mcm[1]*v24[1]) - eff[2].mcm[2]*v24[2])*v24[6];


fex0[1]=-(uex[0].f[1]*S00[1][1]) - uex[0].f[2]*S00[1][2] - uex[0].f[3]*S00[1][3];
fex0[2]=-(uex[0].f[1]*S00[2][1]) - uex[0].f[2]*S00[2][2] - uex[0].f[3]*S00[2][3];
fex0[3]=-(uex[0].f[1]*S00[3][1]) - uex[0].f[2]*S00[3][2] - uex[0].f[3]*S00[3][3];
fex0[4]=-(uex[0].t[1]*S00[1][1]) - uex[0].t[2]*S00[1][2] - uex[0].t[3]*S00[1][3];
fex0[5]=-(uex[0].t[1]*S00[2][1]) - uex[0].t[2]*S00[2][2] - uex[0].t[3]*S00[2][3];
fex0[6]=-(uex[0].t[1]*S00[3][1]) - uex[0].t[2]*S00[3][2] - uex[0].t[3]*S00[3][3];

fex2[1]=-(uex[13].f[1]*SG20[1][1]) - uex[13].f[2]*SG20[1][2] - uex[13].f[3]*SG20[1][3];
fex2[2]=-(uex[13].f[1]*SG20[2][1]) - uex[13].f[2]*SG20[2][2] - uex[13].f[3]*SG20[2][3];
fex2[3]=-(uex[13].f[1]*SG20[3][1]) - uex[13].f[2]*SG20[3][2] - uex[13].f[3]*SG20[3][3];
fex2[4]=-(uex[13].t[1]*SG20[1][1]) - uex[13].t[2]*SG20[1][2] - uex[13].t[3]*SG20[1][3];
fex2[5]=-(uex[13].t[1]*SG20[2][1]) - uex[13].t[2]*SG20[2][2] - uex[13].t[3]*SG20[2][3];
fex2[6]=-(uex[13].t[1]*SG20[3][1]) - uex[13].t[2]*SG20[3][2] - uex[13].t[3]*SG20[3][3];

fex3[1]=-(uex[1].f[1]*SG30[1][1]) - uex[1].f[2]*SG30[1][2] - uex[1].f[3]*SG30[1][3];
fex3[2]=-(uex[1].f[1]*SG30[2][1]) - uex[1].f[2]*SG30[2][2] - uex[1].f[3]*SG30[2][3];
fex3[3]=-(uex[1].f[1]*SG30[3][1]) - uex[1].f[2]*SG30[3][2] - uex[1].f[3]*SG30[3][3];
fex3[4]=-(uex[1].t[1]*SG30[1][1]) - uex[1].t[2]*SG30[1][2] - uex[1].t[3]*SG30[1][3];
fex3[5]=-(uex[1].t[1]*SG30[2][1]) - uex[1].t[2]*SG30[2][2] - uex[1].t[3]*SG30[2][3];
fex3[6]=-(uex[1].t[1]*SG30[3][1]) - uex[1].t[2]*SG30[3][2] - uex[1].t[3]*SG30[3][3];

fex4[1]=-(uex[2].f[1]*SG40[1][1]) - uex[2].f[2]*SG40[1][2] - uex[2].f[3]*SG40[1][3];
fex4[2]=-(uex[2].f[1]*SG40[2][1]) - uex[2].f[2]*SG40[2][2] - uex[2].f[3]*SG40[2][3];
fex4[3]=-(uex[2].f[1]*SG40[3][1]) - uex[2].f[2]*SG40[3][2] - uex[2].f[3]*SG40[3][3];
fex4[4]=-(uex[2].t[1]*SG40[1][1]) - uex[2].t[2]*SG40[1][2] - uex[2].t[3]*SG40[1][3];
fex4[5]=-(uex[2].t[1]*SG40[2][1]) - uex[2].t[2]*SG40[2][2] - uex[2].t[3]*SG40[2][3];
fex4[6]=-(uex[2].t[1]*SG40[3][1]) - uex[2].t[2]*SG40[3][2] - uex[2].t[3]*SG40[3][3];

fex5[1]=-(uex[3].f[1]*SG50[1][1]) - uex[3].f[2]*SG50[1][2] - uex[3].f[3]*SG50[1][3];
fex5[2]=-(uex[3].f[1]*SG50[2][1]) - uex[3].f[2]*SG50[2][2] - uex[3].f[3]*SG50[2][3];
fex5[3]=-(uex[3].f[1]*SG50[3][1]) - uex[3].f[2]*SG50[3][2] - uex[3].f[3]*SG50[3][3];
fex5[4]=-(uex[3].t[1]*SG50[1][1]) - uex[3].t[2]*SG50[1][2] - uex[3].t[3]*SG50[1][3];
fex5[5]=-(uex[3].t[1]*SG50[2][1]) - uex[3].t[2]*SG50[2][2] - uex[3].t[3]*SG50[2][3];
fex5[6]=-(uex[3].t[1]*SG50[3][1]) - uex[3].t[2]*SG50[3][2] - uex[3].t[3]*SG50[3][3];

fex6[1]=-(uex[4].f[1]*SG60[1][1]) - uex[4].f[2]*SG60[1][2] - uex[4].f[3]*SG60[1][3];
fex6[2]=-(uex[4].f[1]*SG60[2][1]) - uex[4].f[2]*SG60[2][2] - uex[4].f[3]*SG60[2][3];
fex6[3]=-(uex[4].f[1]*SG60[3][1]) - uex[4].f[2]*SG60[3][2] - uex[4].f[3]*SG60[3][3];
fex6[4]=-(uex[4].t[1]*SG60[1][1]) - uex[4].t[2]*SG60[1][2] - uex[4].t[3]*SG60[1][3];
fex6[5]=-(uex[4].t[1]*SG60[2][1]) - uex[4].t[2]*SG60[2][2] - uex[4].t[3]*SG60[2][3];
fex6[6]=-(uex[4].t[1]*SG60[3][1]) - uex[4].t[2]*SG60[3][2] - uex[4].t[3]*SG60[3][3];

fex7[1]=-(uex[5].f[1]*SG70[1][1]) - uex[5].f[2]*SG70[1][2] - uex[5].f[3]*SG70[1][3];
fex7[2]=-(uex[5].f[1]*SG70[2][1]) - uex[5].f[2]*SG70[2][2] - uex[5].f[3]*SG70[2][3];
fex7[3]=-(uex[5].f[1]*SG70[3][1]) - uex[5].f[2]*SG70[3][2] - uex[5].f[3]*SG70[3][3];
fex7[4]=-(uex[5].t[1]*SG70[1][1]) - uex[5].t[2]*SG70[1][2] - uex[5].t[3]*SG70[1][3];
fex7[5]=-(uex[5].t[1]*SG70[2][1]) - uex[5].t[2]*SG70[2][2] - uex[5].t[3]*SG70[2][3];
fex7[6]=-(uex[5].t[1]*SG70[3][1]) - uex[5].t[2]*SG70[3][2] - uex[5].t[3]*SG70[3][3];

fex8[1]=-(uex[6].f[1]*SG80[1][1]) - uex[6].f[2]*SG80[1][2] - uex[6].f[3]*SG80[1][3];
fex8[2]=-(uex[6].f[1]*SG80[2][1]) - uex[6].f[2]*SG80[2][2] - uex[6].f[3]*SG80[2][3];
fex8[3]=-(uex[6].f[1]*SG80[3][1]) - uex[6].f[2]*SG80[3][2] - uex[6].f[3]*SG80[3][3];
fex8[4]=-(uex[6].t[1]*SG80[1][1]) - uex[6].t[2]*SG80[1][2] - uex[6].t[3]*SG80[1][3];
fex8[5]=-(uex[6].t[1]*SG80[2][1]) - uex[6].t[2]*SG80[2][2] - uex[6].t[3]*SG80[2][3];
fex8[6]=-(uex[6].t[1]*SG80[3][1]) - uex[6].t[2]*SG80[3][2] - uex[6].t[3]*SG80[3][3];

fex14[1]=-(uex[7].f[1]*SG140[1][1]) - uex[7].f[2]*SG140[1][2] - uex[7].f[3]*SG140[1][3];
fex14[2]=-(uex[7].f[1]*SG140[2][1]) - uex[7].f[2]*SG140[2][2] - uex[7].f[3]*SG140[2][3];
fex14[3]=-(uex[7].f[1]*SG140[3][1]) - uex[7].f[2]*SG140[3][2] - uex[7].f[3]*SG140[3][3];
fex14[4]=-(uex[7].t[1]*SG140[1][1]) - uex[7].t[2]*SG140[1][2] - uex[7].t[3]*SG140[1][3];
fex14[5]=-(uex[7].t[1]*SG140[2][1]) - uex[7].t[2]*SG140[2][2] - uex[7].t[3]*SG140[2][3];
fex14[6]=-(uex[7].t[1]*SG140[3][1]) - uex[7].t[2]*SG140[3][2] - uex[7].t[3]*SG140[3][3];

fex15[1]=-(uex[8].f[1]*SG150[1][1]) - uex[8].f[2]*SG150[1][2] - uex[8].f[3]*SG150[1][3];
fex15[2]=-(uex[8].f[1]*SG150[2][1]) - uex[8].f[2]*SG150[2][2] - uex[8].f[3]*SG150[2][3];
fex15[3]=-(uex[8].f[1]*SG150[3][1]) - uex[8].f[2]*SG150[3][2] - uex[8].f[3]*SG150[3][3];
fex15[4]=-(uex[8].t[1]*SG150[1][1]) - uex[8].t[2]*SG150[1][2] - uex[8].t[3]*SG150[1][3];
fex15[5]=-(uex[8].t[1]*SG150[2][1]) - uex[8].t[2]*SG150[2][2] - uex[8].t[3]*SG150[2][3];
fex15[6]=-(uex[8].t[1]*SG150[3][1]) - uex[8].t[2]*SG150[3][2] - uex[8].t[3]*SG150[3][3];

fex17[1]=-(uex[10].f[1]*SG170[1][1]) - uex[10].f[2]*SG170[1][2] - uex[10].f[3]*SG170[1][3];
fex17[2]=-(uex[10].f[1]*SG170[2][1]) - uex[10].f[2]*SG170[2][2] - uex[10].f[3]*SG170[2][3];
fex17[3]=-(uex[10].f[1]*SG170[3][1]) - uex[10].f[2]*SG170[3][2] - uex[10].f[3]*SG170[3][3];
fex17[4]=-(uex[10].t[1]*SG170[1][1]) - uex[10].t[2]*SG170[1][2] - uex[10].t[3]*SG170[1][3];
fex17[5]=-(uex[10].t[1]*SG170[2][1]) - uex[10].t[2]*SG170[2][2] - uex[10].t[3]*SG170[2][3];
fex17[6]=-(uex[10].t[1]*SG170[3][1]) - uex[10].t[2]*SG170[3][2] - uex[10].t[3]*SG170[3][3];

fex18[1]=-(uex[11].f[1]*SG180[1][1]) - uex[11].f[2]*SG180[1][2] - uex[11].f[3]*SG180[1][3];
fex18[2]=-(uex[11].f[1]*SG180[2][1]) - uex[11].f[2]*SG180[2][2] - uex[11].f[3]*SG180[2][3];
fex18[3]=-(uex[11].f[1]*SG180[3][1]) - uex[11].f[2]*SG180[3][2] - uex[11].f[3]*SG180[3][3];
fex18[4]=-(uex[11].t[1]*SG180[1][1]) - uex[11].t[2]*SG180[1][2] - uex[11].t[3]*SG180[1][3];
fex18[5]=-(uex[11].t[1]*SG180[2][1]) - uex[11].t[2]*SG180[2][2] - uex[11].t[3]*SG180[2][3];
fex18[6]=-(uex[11].t[1]*SG180[3][1]) - uex[11].t[2]*SG180[3][2] - uex[11].t[3]*SG180[3][3];

fex19[1]=-(uex[12].f[1]*SG190[1][1]) - uex[12].f[2]*SG190[1][2] - uex[12].f[3]*SG190[1][3];
fex19[2]=-(uex[12].f[1]*SG190[2][1]) - uex[12].f[2]*SG190[2][2] - uex[12].f[3]*SG190[2][3];
fex19[3]=-(uex[12].f[1]*SG190[3][1]) - uex[12].f[2]*SG190[3][2] - uex[12].f[3]*SG190[3][3];
fex19[4]=-(uex[12].t[1]*SG190[1][1]) - uex[12].t[2]*SG190[1][2] - uex[12].t[3]*SG190[1][3];
fex19[5]=-(uex[12].t[1]*SG190[2][1]) - uex[12].t[2]*SG190[2][2] - uex[12].t[3]*SG190[2][3];
fex19[6]=-(uex[12].t[1]*SG190[3][1]) - uex[12].t[2]*SG190[3][2] - uex[12].t[3]*SG190[3][3];



}


void
hoap3_InvDynNEfunc7(void)
     {
/* total forces and external forces for each joint */
f24[1]=fnet24[1];
f24[2]=fnet24[2];
f24[3]=fnet24[3];
f24[4]=fnet24[4];
f24[5]=fnet24[5];
f24[6]=fnet24[6];

f19[1]=fnet19[1] + f24[1]*Si1924[1][1] + f24[2]*Si1924[1][2] + f24[3]*Si1924[1][3];
f19[2]=fnet19[2] + f24[1]*Si1924[2][1] + f24[2]*Si1924[2][2] + f24[3]*Si1924[2][3];
f19[3]=fnet19[3] + f24[1]*Si1924[3][1] + f24[2]*Si1924[3][2] + f24[3]*Si1924[3][3];
f19[4]=fnet19[4] + f24[4]*Si1924[1][1] + f24[5]*Si1924[1][2] + f24[6]*Si1924[1][3] + f24[1]*(-(eff[2].x[3]*Si1924[2][1]) + eff[2].x[2]*Si1924[3][1]) + f24[2]*(-(eff[2].x[3]*Si1924[2][2]) + eff[2].x[2]*Si1924[3][2]) + f24[3]*(-(eff[2].x[3]*Si1924[2][3]) + eff[2].x[2]*Si1924[3][3]);
f19[5]=fnet19[5] + f24[4]*Si1924[2][1] + f24[5]*Si1924[2][2] + f24[6]*Si1924[2][3] + f24[1]*(eff[2].x[3]*Si1924[1][1] - eff[2].x[1]*Si1924[3][1]) + f24[2]*(eff[2].x[3]*Si1924[1][2] - eff[2].x[1]*Si1924[3][2]) + f24[3]*(eff[2].x[3]*Si1924[1][3] - eff[2].x[1]*Si1924[3][3]);
f19[6]=fnet19[6] + f24[1]*(-(eff[2].x[2]*Si1924[1][1]) + eff[2].x[1]*Si1924[2][1]) + f24[2]*(-(eff[2].x[2]*Si1924[1][2]) + eff[2].x[1]*Si1924[2][2]) + f24[3]*(-(eff[2].x[2]*Si1924[1][3]) + eff[2].x[1]*Si1924[2][3]) + f24[4]*Si1924[3][1] + f24[5]*Si1924[3][2] + f24[6]*Si1924[3][3];

f18[1]=fnet18[1] + f19[1]*Si1819[1][1] + f19[2]*Si1819[1][2];
f18[2]=f19[3] + fnet18[2];
f18[3]=fnet18[3] + f19[1]*Si1819[3][1] + f19[2]*Si1819[3][2];
f18[4]=fnet18[4] + f19[4]*Si1819[1][1] + f19[5]*Si1819[1][2];
f18[5]=f19[6] + fnet18[5];
f18[6]=fnet18[6] + f19[4]*Si1819[3][1] + f19[5]*Si1819[3][2];

f17[1]=fnet17[1] + f18[1]*Si1718[1][1] + f18[2]*Si1718[1][2];
f17[2]=fnet17[2] + f18[1]*Si1718[2][1] + f18[2]*Si1718[2][2];
f17[3]=f18[3] + fnet17[3];
f17[4]=fnet17[4] + f18[4]*Si1718[1][1] + f18[5]*Si1718[1][2];
f17[5]=LEGLINK3*f18[3] + fnet17[5] + f18[4]*Si1718[2][1] + f18[5]*Si1718[2][2];
f17[6]=f18[6] + fnet17[6] - LEGLINK3*f18[1]*Si1718[2][1] - LEGLINK3*f18[2]*Si1718[2][2];

f16[1]=fnet16[1] + f17[1]*Si1617[1][1] + f17[2]*Si1617[1][2];
f16[2]=fnet16[2] + f17[1]*Si1617[2][1] + f17[2]*Si1617[2][2];
f16[3]=f17[3] + fnet16[3];
f16[4]=fnet16[4] + f17[4]*Si1617[1][1] + f17[5]*Si1617[1][2];
f16[5]=LEGLINK2*f17[3] + fnet16[5] + f17[4]*Si1617[2][1] + f17[5]*Si1617[2][2];
f16[6]=f17[6] + fnet16[6] - LEGLINK2*f17[1]*Si1617[2][1] - LEGLINK2*f17[2]*Si1617[2][2];

f15[1]=fnet15[1] + f16[1]*Si1516[1][1] + f16[2]*Si1516[1][2];
f15[2]=-f16[3] + fnet15[2];
f15[3]=fnet15[3] + f16[1]*Si1516[3][1] + f16[2]*Si1516[3][2];
f15[4]=fnet15[4] + f16[4]*Si1516[1][1] + f16[5]*Si1516[1][2];
f15[5]=-f16[6] + fnet15[5];
f15[6]=fnet15[6] + f16[4]*Si1516[3][1] + f16[5]*Si1516[3][2];

f14[1]=fnet14[1] + f15[1]*Si1415[1][1] + f15[2]*Si1415[1][2];
f14[2]=-f15[3] + fnet14[2];
f14[3]=fnet14[3] + f15[1]*Si1415[3][1] + f15[2]*Si1415[3][2];
f14[4]=fnet14[4] + f15[4]*Si1415[1][1] + f15[5]*Si1415[1][2];
f14[5]=-f15[6] + fnet14[5];
f14[6]=fnet14[6] + f15[4]*Si1415[3][1] + f15[5]*Si1415[3][2];

f13[1]=fnet13[1];
f13[2]=fnet13[2];
f13[3]=fnet13[3];
f13[4]=fnet13[4];
f13[5]=fnet13[5];
f13[6]=fnet13[6];

f8[1]=fnet8[1] + f13[1]*Si813[1][1] + f13[2]*Si813[1][2] + f13[3]*Si813[1][3];
f8[2]=fnet8[2] + f13[1]*Si813[2][1] + f13[2]*Si813[2][2] + f13[3]*Si813[2][3];
f8[3]=fnet8[3] + f13[1]*Si813[3][1] + f13[2]*Si813[3][2] + f13[3]*Si813[3][3];
f8[4]=fnet8[4] + f13[4]*Si813[1][1] + f13[5]*Si813[1][2] + f13[6]*Si813[1][3] + f13[1]*(-(eff[1].x[3]*Si813[2][1]) + eff[1].x[2]*Si813[3][1]) + f13[2]*(-(eff[1].x[3]*Si813[2][2]) + eff[1].x[2]*Si813[3][2]) + f13[3]*(-(eff[1].x[3]*Si813[2][3]) + eff[1].x[2]*Si813[3][3]);
f8[5]=fnet8[5] + f13[4]*Si813[2][1] + f13[5]*Si813[2][2] + f13[6]*Si813[2][3] + f13[1]*(eff[1].x[3]*Si813[1][1] - eff[1].x[1]*Si813[3][1]) + f13[2]*(eff[1].x[3]*Si813[1][2] - eff[1].x[1]*Si813[3][2]) + f13[3]*(eff[1].x[3]*Si813[1][3] - eff[1].x[1]*Si813[3][3]);
f8[6]=fnet8[6] + f13[1]*(-(eff[1].x[2]*Si813[1][1]) + eff[1].x[1]*Si813[2][1]) + f13[2]*(-(eff[1].x[2]*Si813[1][2]) + eff[1].x[1]*Si813[2][2]) + f13[3]*(-(eff[1].x[2]*Si813[1][3]) + eff[1].x[1]*Si813[2][3]) + f13[4]*Si813[3][1] + f13[5]*Si813[3][2] + f13[6]*Si813[3][3];

f7[1]=fnet7[1] + f8[1]*Si78[1][1] + f8[2]*Si78[1][2];
f7[2]=f8[3] + fnet7[2];
f7[3]=fnet7[3] + f8[1]*Si78[3][1] + f8[2]*Si78[3][2];
f7[4]=fnet7[4] + f8[4]*Si78[1][1] + f8[5]*Si78[1][2];
f7[5]=f8[6] + fnet7[5];
f7[6]=fnet7[6] + f8[4]*Si78[3][1] + f8[5]*Si78[3][2];

f6[1]=fnet6[1] + f7[1]*Si67[1][1] + f7[2]*Si67[1][2];
f6[2]=fnet6[2] + f7[1]*Si67[2][1] + f7[2]*Si67[2][2];
f6[3]=f7[3] + fnet6[3];
f6[4]=fnet6[4] + f7[4]*Si67[1][1] + f7[5]*Si67[1][2];
f6[5]=LEGLINK3*f7[3] + fnet6[5] + f7[4]*Si67[2][1] + f7[5]*Si67[2][2];
f6[6]=f7[6] + fnet6[6] - LEGLINK3*f7[1]*Si67[2][1] - LEGLINK3*f7[2]*Si67[2][2];

f5[1]=fnet5[1] + f6[1]*Si56[1][1] + f6[2]*Si56[1][2];
f5[2]=fnet5[2] + f6[1]*Si56[2][1] + f6[2]*Si56[2][2];
f5[3]=f6[3] + fnet5[3];
f5[4]=fnet5[4] + f6[4]*Si56[1][1] + f6[5]*Si56[1][2];
f5[5]=LEGLINK2*f6[3] + fnet5[5] + f6[4]*Si56[2][1] + f6[5]*Si56[2][2];
f5[6]=f6[6] + fnet5[6] - LEGLINK2*f6[1]*Si56[2][1] - LEGLINK2*f6[2]*Si56[2][2];

f4[1]=fnet4[1] + f5[1]*Si45[1][1] + f5[2]*Si45[1][2];
f4[2]=-f5[3] + fnet4[2];
f4[3]=fnet4[3] + f5[1]*Si45[3][1] + f5[2]*Si45[3][2];
f4[4]=fnet4[4] + f5[4]*Si45[1][1] + f5[5]*Si45[1][2];
f4[5]=-f5[6] + fnet4[5];
f4[6]=fnet4[6] + f5[4]*Si45[3][1] + f5[5]*Si45[3][2];

f3[1]=fnet3[1] + f4[1]*Si34[1][1] + f4[2]*Si34[1][2];
f3[2]=-f4[3] + fnet3[2];
f3[3]=fnet3[3] + f4[1]*Si34[3][1] + f4[2]*Si34[3][2];
f3[4]=fnet3[4] + f4[4]*Si34[1][1] + f4[5]*Si34[1][2];
f3[5]=-f4[6] + fnet3[5];
f3[6]=fnet3[6] + f4[4]*Si34[3][1] + f4[5]*Si34[3][2];

f2[1]=fnet2[1] + f14[1]*Si214[1][1] + f14[2]*Si214[1][2] + f3[1]*Si23[1][1] + f3[2]*Si23[1][2];
f2[2]=f14[3] + f3[3] + fnet2[2];
f2[3]=fnet2[3] + f14[1]*Si214[3][1] + f14[2]*Si214[3][2] + f3[1]*Si23[3][1] + f3[2]*Si23[3][2];
f2[4]=LEGLINK1*f14[3] - LEGLINK1*f3[3] + fnet2[4] + f14[4]*Si214[1][1] + f14[5]*Si214[1][2] - WAISTLINK1*f14[1]*Si214[3][1] - WAISTLINK1*f14[2]*Si214[3][2] + f3[4]*Si23[1][1] + f3[5]*Si23[1][2] - WAISTLINK1*f3[1]*Si23[3][1] - WAISTLINK1*f3[2]*Si23[3][2];
f2[5]=f14[6] + f3[6] + fnet2[5] + f14[1]*(-(LEGLINK1*Si214[1][1]) + WAISTLINK2*Si214[3][1]) + f14[2]*(-(LEGLINK1*Si214[1][2]) + WAISTLINK2*Si214[3][2]) + f3[1]*(LEGLINK1*Si23[1][1] + WAISTLINK2*Si23[3][1]) + f3[2]*(LEGLINK1*Si23[1][2] + WAISTLINK2*Si23[3][2]);
f2[6]=-(WAISTLINK2*f14[3]) - WAISTLINK2*f3[3] + fnet2[6] + WAISTLINK1*f14[1]*Si214[1][1] + WAISTLINK1*f14[2]*Si214[1][2] + f14[4]*Si214[3][1] + f14[5]*Si214[3][2] + WAISTLINK1*f3[1]*Si23[1][1] + WAISTLINK1*f3[2]*Si23[1][2] + f3[4]*Si23[3][1] + f3[5]*Si23[3][2];

f0[1]=fnet0[1] + f2[1]*Si02[1][1] + f2[2]*Si02[1][2];
f0[2]=-f2[3] + fnet0[2];
f0[3]=fnet0[3] + f2[1]*Si02[3][1] + f2[2]*Si02[3][2];
f0[4]=fnet0[4] + f2[4]*Si02[1][1] + f2[5]*Si02[1][2];
f0[5]=-f2[6] + fnet0[5] - BODYLINK2*f2[1]*Si02[3][1] - BODYLINK2*f2[2]*Si02[3][2];
f0[6]=-(BODYLINK2*f2[3]) + fnet0[6] + f2[4]*Si02[3][1] + f2[5]*Si02[3][2];


fext19[1]=fex19[1];
fext19[2]=fex19[2];
fext19[3]=fex19[3];
fext19[4]=fex19[4];
fext19[5]=fex19[5];
fext19[6]=fex19[6];

fext18[1]=fex18[1] + fext19[1]*Si1819[1][1] + fext19[2]*Si1819[1][2];
fext18[2]=fex18[2] + fext19[3];
fext18[3]=fex18[3] + fext19[1]*Si1819[3][1] + fext19[2]*Si1819[3][2];
fext18[4]=fex18[4] + fext19[4]*Si1819[1][1] + fext19[5]*Si1819[1][2];
fext18[5]=fex18[5] + fext19[6];
fext18[6]=fex18[6] + fext19[4]*Si1819[3][1] + fext19[5]*Si1819[3][2];

fext17[1]=fex17[1] + fext18[1]*Si1718[1][1] + fext18[2]*Si1718[1][2];
fext17[2]=fex17[2] + fext18[1]*Si1718[2][1] + fext18[2]*Si1718[2][2];
fext17[3]=fex17[3] + fext18[3];
fext17[4]=fex17[4] + fext18[4]*Si1718[1][1] + fext18[5]*Si1718[1][2];
fext17[5]=fex17[5] + LEGLINK3*fext18[3] + fext18[4]*Si1718[2][1] + fext18[5]*Si1718[2][2];
fext17[6]=fex17[6] + fext18[6] - LEGLINK3*fext18[1]*Si1718[2][1] - LEGLINK3*fext18[2]*Si1718[2][2];

fext16[1]=fext17[1]*Si1617[1][1] + fext17[2]*Si1617[1][2];
fext16[2]=fext17[1]*Si1617[2][1] + fext17[2]*Si1617[2][2];
fext16[3]=fext17[3];
fext16[4]=fext17[4]*Si1617[1][1] + fext17[5]*Si1617[1][2];
fext16[5]=LEGLINK2*fext17[3] + fext17[4]*Si1617[2][1] + fext17[5]*Si1617[2][2];
fext16[6]=fext17[6] - LEGLINK2*fext17[1]*Si1617[2][1] - LEGLINK2*fext17[2]*Si1617[2][2];

fext15[1]=fex15[1] + fext16[1]*Si1516[1][1] + fext16[2]*Si1516[1][2];
fext15[2]=fex15[2] - fext16[3];
fext15[3]=fex15[3] + fext16[1]*Si1516[3][1] + fext16[2]*Si1516[3][2];
fext15[4]=fex15[4] + fext16[4]*Si1516[1][1] + fext16[5]*Si1516[1][2];
fext15[5]=fex15[5] - fext16[6];
fext15[6]=fex15[6] + fext16[4]*Si1516[3][1] + fext16[5]*Si1516[3][2];

fext14[1]=fex14[1] + fext15[1]*Si1415[1][1] + fext15[2]*Si1415[1][2];
fext14[2]=fex14[2] - fext15[3];
fext14[3]=fex14[3] + fext15[1]*Si1415[3][1] + fext15[2]*Si1415[3][2];
fext14[4]=fex14[4] + fext15[4]*Si1415[1][1] + fext15[5]*Si1415[1][2];
fext14[5]=fex14[5] - fext15[6];
fext14[6]=fex14[6] + fext15[4]*Si1415[3][1] + fext15[5]*Si1415[3][2];

fext8[1]=fex8[1];
fext8[2]=fex8[2];
fext8[3]=fex8[3];
fext8[4]=fex8[4];
fext8[5]=fex8[5];
fext8[6]=fex8[6];

fext7[1]=fex7[1] + fext8[1]*Si78[1][1] + fext8[2]*Si78[1][2];
fext7[2]=fex7[2] + fext8[3];
fext7[3]=fex7[3] + fext8[1]*Si78[3][1] + fext8[2]*Si78[3][2];
fext7[4]=fex7[4] + fext8[4]*Si78[1][1] + fext8[5]*Si78[1][2];
fext7[5]=fex7[5] + fext8[6];
fext7[6]=fex7[6] + fext8[4]*Si78[3][1] + fext8[5]*Si78[3][2];

fext6[1]=fex6[1] + fext7[1]*Si67[1][1] + fext7[2]*Si67[1][2];
fext6[2]=fex6[2] + fext7[1]*Si67[2][1] + fext7[2]*Si67[2][2];
fext6[3]=fex6[3] + fext7[3];
fext6[4]=fex6[4] + fext7[4]*Si67[1][1] + fext7[5]*Si67[1][2];
fext6[5]=fex6[5] + LEGLINK3*fext7[3] + fext7[4]*Si67[2][1] + fext7[5]*Si67[2][2];
fext6[6]=fex6[6] + fext7[6] - LEGLINK3*fext7[1]*Si67[2][1] - LEGLINK3*fext7[2]*Si67[2][2];

fext5[1]=fex5[1] + fext6[1]*Si56[1][1] + fext6[2]*Si56[1][2];
fext5[2]=fex5[2] + fext6[1]*Si56[2][1] + fext6[2]*Si56[2][2];
fext5[3]=fex5[3] + fext6[3];
fext5[4]=fex5[4] + fext6[4]*Si56[1][1] + fext6[5]*Si56[1][2];
fext5[5]=fex5[5] + LEGLINK2*fext6[3] + fext6[4]*Si56[2][1] + fext6[5]*Si56[2][2];
fext5[6]=fex5[6] + fext6[6] - LEGLINK2*fext6[1]*Si56[2][1] - LEGLINK2*fext6[2]*Si56[2][2];

fext4[1]=fex4[1] + fext5[1]*Si45[1][1] + fext5[2]*Si45[1][2];
fext4[2]=fex4[2] - fext5[3];
fext4[3]=fex4[3] + fext5[1]*Si45[3][1] + fext5[2]*Si45[3][2];
fext4[4]=fex4[4] + fext5[4]*Si45[1][1] + fext5[5]*Si45[1][2];
fext4[5]=fex4[5] - fext5[6];
fext4[6]=fex4[6] + fext5[4]*Si45[3][1] + fext5[5]*Si45[3][2];

fext3[1]=fex3[1] + fext4[1]*Si34[1][1] + fext4[2]*Si34[1][2];
fext3[2]=fex3[2] - fext4[3];
fext3[3]=fex3[3] + fext4[1]*Si34[3][1] + fext4[2]*Si34[3][2];
fext3[4]=fex3[4] + fext4[4]*Si34[1][1] + fext4[5]*Si34[1][2];
fext3[5]=fex3[5] - fext4[6];
fext3[6]=fex3[6] + fext4[4]*Si34[3][1] + fext4[5]*Si34[3][2];

fext2[1]=fex2[1] + fext14[1]*Si214[1][1] + fext14[2]*Si214[1][2] + fext3[1]*Si23[1][1] + fext3[2]*Si23[1][2];
fext2[2]=fex2[2] + fext14[3] + fext3[3];
fext2[3]=fex2[3] + fext14[1]*Si214[3][1] + fext14[2]*Si214[3][2] + fext3[1]*Si23[3][1] + fext3[2]*Si23[3][2];
fext2[4]=fex2[4] + LEGLINK1*fext14[3] - LEGLINK1*fext3[3] + fext14[4]*Si214[1][1] + fext14[5]*Si214[1][2] - WAISTLINK1*fext14[1]*Si214[3][1] - WAISTLINK1*fext14[2]*Si214[3][2] + fext3[4]*Si23[1][1] + fext3[5]*Si23[1][2] - WAISTLINK1*fext3[1]*Si23[3][1] - WAISTLINK1*fext3[2]*Si23[3][2];
fext2[5]=fex2[5] + fext14[6] + fext3[6] + fext14[1]*(-(LEGLINK1*Si214[1][1]) + WAISTLINK2*Si214[3][1]) + fext14[2]*(-(LEGLINK1*Si214[1][2]) + WAISTLINK2*Si214[3][2]) + fext3[1]*(LEGLINK1*Si23[1][1] + WAISTLINK2*Si23[3][1]) + fext3[2]*(LEGLINK1*Si23[1][2] + WAISTLINK2*Si23[3][2]);
fext2[6]=fex2[6] - WAISTLINK2*fext14[3] - WAISTLINK2*fext3[3] + WAISTLINK1*fext14[1]*Si214[1][1] + WAISTLINK1*fext14[2]*Si214[1][2] + fext14[4]*Si214[3][1] + fext14[5]*Si214[3][2] + WAISTLINK1*fext3[1]*Si23[1][1] + WAISTLINK1*fext3[2]*Si23[1][2] + fext3[4]*Si23[3][1] + fext3[5]*Si23[3][2];

fext0[1]=fex0[1] + fext2[1]*Si02[1][1] + fext2[2]*Si02[1][2];
fext0[2]=fex0[2] - fext2[3];
fext0[3]=fex0[3] + fext2[1]*Si02[3][1] + fext2[2]*Si02[3][2];
fext0[4]=fex0[4] + fext2[4]*Si02[1][1] + fext2[5]*Si02[1][2];
fext0[5]=fex0[5] - fext2[6] - BODYLINK2*fext2[1]*Si02[3][1] - BODYLINK2*fext2[2]*Si02[3][2];
fext0[6]=fex0[6] - BODYLINK2*fext2[3] + fext2[4]*Si02[3][1] + fext2[5]*Si02[3][2];



}

